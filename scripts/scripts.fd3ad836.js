function ECB(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function ECBlocks(e,t,n){this.ecCodewordsPerBlock=e,this.ecBlocks=n?new Array(t,n):new Array(t),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}),this.getECBlocks=function(){return this.ecBlocks}}function Version(e,t,n,r,o,i){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,r,o,i);for(var a=0,s=n.ECCodewordsPerBlock,c=n.getECBlocks(),u=0;u<c.length;u++){var l=c[u];a+=l.Count*(l.DataCodewords+s)}this.totalCodewords=a,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new BitMatrix(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;n>r;r++)for(var o=this.alignmentPatternCenters[r]-2,i=0;n>i;i++)0==r&&(0==i||i==n-1)||r==n-1&&0==i||t.setRegion(this.alignmentPatternCenters[i]-2,o,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function buildVersions(){return new Array(new Version(1,new Array,new ECBlocks(7,new ECB(1,19)),new ECBlocks(10,new ECB(1,16)),new ECBlocks(13,new ECB(1,13)),new ECBlocks(17,new ECB(1,9))),new Version(2,new Array(6,18),new ECBlocks(10,new ECB(1,34)),new ECBlocks(16,new ECB(1,28)),new ECBlocks(22,new ECB(1,22)),new ECBlocks(28,new ECB(1,16))),new Version(3,new Array(6,22),new ECBlocks(15,new ECB(1,55)),new ECBlocks(26,new ECB(1,44)),new ECBlocks(18,new ECB(2,17)),new ECBlocks(22,new ECB(2,13))),new Version(4,new Array(6,26),new ECBlocks(20,new ECB(1,80)),new ECBlocks(18,new ECB(2,32)),new ECBlocks(26,new ECB(2,24)),new ECBlocks(16,new ECB(4,9))),new Version(5,new Array(6,30),new ECBlocks(26,new ECB(1,108)),new ECBlocks(24,new ECB(2,43)),new ECBlocks(18,new ECB(2,15),new ECB(2,16)),new ECBlocks(22,new ECB(2,11),new ECB(2,12))),new Version(6,new Array(6,34),new ECBlocks(18,new ECB(2,68)),new ECBlocks(16,new ECB(4,27)),new ECBlocks(24,new ECB(4,19)),new ECBlocks(28,new ECB(4,15))),new Version(7,new Array(6,22,38),new ECBlocks(20,new ECB(2,78)),new ECBlocks(18,new ECB(4,31)),new ECBlocks(18,new ECB(2,14),new ECB(4,15)),new ECBlocks(26,new ECB(4,13),new ECB(1,14))),new Version(8,new Array(6,24,42),new ECBlocks(24,new ECB(2,97)),new ECBlocks(22,new ECB(2,38),new ECB(2,39)),new ECBlocks(22,new ECB(4,18),new ECB(2,19)),new ECBlocks(26,new ECB(4,14),new ECB(2,15))),new Version(9,new Array(6,26,46),new ECBlocks(30,new ECB(2,116)),new ECBlocks(22,new ECB(3,36),new ECB(2,37)),new ECBlocks(20,new ECB(4,16),new ECB(4,17)),new ECBlocks(24,new ECB(4,12),new ECB(4,13))),new Version(10,new Array(6,28,50),new ECBlocks(18,new ECB(2,68),new ECB(2,69)),new ECBlocks(26,new ECB(4,43),new ECB(1,44)),new ECBlocks(24,new ECB(6,19),new ECB(2,20)),new ECBlocks(28,new ECB(6,15),new ECB(2,16))),new Version(11,new Array(6,30,54),new ECBlocks(20,new ECB(4,81)),new ECBlocks(30,new ECB(1,50),new ECB(4,51)),new ECBlocks(28,new ECB(4,22),new ECB(4,23)),new ECBlocks(24,new ECB(3,12),new ECB(8,13))),new Version(12,new Array(6,32,58),new ECBlocks(24,new ECB(2,92),new ECB(2,93)),new ECBlocks(22,new ECB(6,36),new ECB(2,37)),new ECBlocks(26,new ECB(4,20),new ECB(6,21)),new ECBlocks(28,new ECB(7,14),new ECB(4,15))),new Version(13,new Array(6,34,62),new ECBlocks(26,new ECB(4,107)),new ECBlocks(22,new ECB(8,37),new ECB(1,38)),new ECBlocks(24,new ECB(8,20),new ECB(4,21)),new ECBlocks(22,new ECB(12,11),new ECB(4,12))),new Version(14,new Array(6,26,46,66),new ECBlocks(30,new ECB(3,115),new ECB(1,116)),new ECBlocks(24,new ECB(4,40),new ECB(5,41)),new ECBlocks(20,new ECB(11,16),new ECB(5,17)),new ECBlocks(24,new ECB(11,12),new ECB(5,13))),new Version(15,new Array(6,26,48,70),new ECBlocks(22,new ECB(5,87),new ECB(1,88)),new ECBlocks(24,new ECB(5,41),new ECB(5,42)),new ECBlocks(30,new ECB(5,24),new ECB(7,25)),new ECBlocks(24,new ECB(11,12),new ECB(7,13))),new Version(16,new Array(6,26,50,74),new ECBlocks(24,new ECB(5,98),new ECB(1,99)),new ECBlocks(28,new ECB(7,45),new ECB(3,46)),new ECBlocks(24,new ECB(15,19),new ECB(2,20)),new ECBlocks(30,new ECB(3,15),new ECB(13,16))),new Version(17,new Array(6,30,54,78),new ECBlocks(28,new ECB(1,107),new ECB(5,108)),new ECBlocks(28,new ECB(10,46),new ECB(1,47)),new ECBlocks(28,new ECB(1,22),new ECB(15,23)),new ECBlocks(28,new ECB(2,14),new ECB(17,15))),new Version(18,new Array(6,30,56,82),new ECBlocks(30,new ECB(5,120),new ECB(1,121)),new ECBlocks(26,new ECB(9,43),new ECB(4,44)),new ECBlocks(28,new ECB(17,22),new ECB(1,23)),new ECBlocks(28,new ECB(2,14),new ECB(19,15))),new Version(19,new Array(6,30,58,86),new ECBlocks(28,new ECB(3,113),new ECB(4,114)),new ECBlocks(26,new ECB(3,44),new ECB(11,45)),new ECBlocks(26,new ECB(17,21),new ECB(4,22)),new ECBlocks(26,new ECB(9,13),new ECB(16,14))),new Version(20,new Array(6,34,62,90),new ECBlocks(28,new ECB(3,107),new ECB(5,108)),new ECBlocks(26,new ECB(3,41),new ECB(13,42)),new ECBlocks(30,new ECB(15,24),new ECB(5,25)),new ECBlocks(28,new ECB(15,15),new ECB(10,16))),new Version(21,new Array(6,28,50,72,94),new ECBlocks(28,new ECB(4,116),new ECB(4,117)),new ECBlocks(26,new ECB(17,42)),new ECBlocks(28,new ECB(17,22),new ECB(6,23)),new ECBlocks(30,new ECB(19,16),new ECB(6,17))),new Version(22,new Array(6,26,50,74,98),new ECBlocks(28,new ECB(2,111),new ECB(7,112)),new ECBlocks(28,new ECB(17,46)),new ECBlocks(30,new ECB(7,24),new ECB(16,25)),new ECBlocks(24,new ECB(34,13))),new Version(23,new Array(6,30,54,74,102),new ECBlocks(30,new ECB(4,121),new ECB(5,122)),new ECBlocks(28,new ECB(4,47),new ECB(14,48)),new ECBlocks(30,new ECB(11,24),new ECB(14,25)),new ECBlocks(30,new ECB(16,15),new ECB(14,16))),new Version(24,new Array(6,28,54,80,106),new ECBlocks(30,new ECB(6,117),new ECB(4,118)),new ECBlocks(28,new ECB(6,45),new ECB(14,46)),new ECBlocks(30,new ECB(11,24),new ECB(16,25)),new ECBlocks(30,new ECB(30,16),new ECB(2,17))),new Version(25,new Array(6,32,58,84,110),new ECBlocks(26,new ECB(8,106),new ECB(4,107)),new ECBlocks(28,new ECB(8,47),new ECB(13,48)),new ECBlocks(30,new ECB(7,24),new ECB(22,25)),new ECBlocks(30,new ECB(22,15),new ECB(13,16))),new Version(26,new Array(6,30,58,86,114),new ECBlocks(28,new ECB(10,114),new ECB(2,115)),new ECBlocks(28,new ECB(19,46),new ECB(4,47)),new ECBlocks(28,new ECB(28,22),new ECB(6,23)),new ECBlocks(30,new ECB(33,16),new ECB(4,17))),new Version(27,new Array(6,34,62,90,118),new ECBlocks(30,new ECB(8,122),new ECB(4,123)),new ECBlocks(28,new ECB(22,45),new ECB(3,46)),new ECBlocks(30,new ECB(8,23),new ECB(26,24)),new ECBlocks(30,new ECB(12,15),new ECB(28,16))),new Version(28,new Array(6,26,50,74,98,122),new ECBlocks(30,new ECB(3,117),new ECB(10,118)),new ECBlocks(28,new ECB(3,45),new ECB(23,46)),new ECBlocks(30,new ECB(4,24),new ECB(31,25)),new ECBlocks(30,new ECB(11,15),new ECB(31,16))),new Version(29,new Array(6,30,54,78,102,126),new ECBlocks(30,new ECB(7,116),new ECB(7,117)),new ECBlocks(28,new ECB(21,45),new ECB(7,46)),new ECBlocks(30,new ECB(1,23),new ECB(37,24)),new ECBlocks(30,new ECB(19,15),new ECB(26,16))),new Version(30,new Array(6,26,52,78,104,130),new ECBlocks(30,new ECB(5,115),new ECB(10,116)),new ECBlocks(28,new ECB(19,47),new ECB(10,48)),new ECBlocks(30,new ECB(15,24),new ECB(25,25)),new ECBlocks(30,new ECB(23,15),new ECB(25,16))),new Version(31,new Array(6,30,56,82,108,134),new ECBlocks(30,new ECB(13,115),new ECB(3,116)),new ECBlocks(28,new ECB(2,46),new ECB(29,47)),new ECBlocks(30,new ECB(42,24),new ECB(1,25)),new ECBlocks(30,new ECB(23,15),new ECB(28,16))),new Version(32,new Array(6,34,60,86,112,138),new ECBlocks(30,new ECB(17,115)),new ECBlocks(28,new ECB(10,46),new ECB(23,47)),new ECBlocks(30,new ECB(10,24),new ECB(35,25)),new ECBlocks(30,new ECB(19,15),new ECB(35,16))),new Version(33,new Array(6,30,58,86,114,142),new ECBlocks(30,new ECB(17,115),new ECB(1,116)),new ECBlocks(28,new ECB(14,46),new ECB(21,47)),new ECBlocks(30,new ECB(29,24),new ECB(19,25)),new ECBlocks(30,new ECB(11,15),new ECB(46,16))),new Version(34,new Array(6,34,62,90,118,146),new ECBlocks(30,new ECB(13,115),new ECB(6,116)),new ECBlocks(28,new ECB(14,46),new ECB(23,47)),new ECBlocks(30,new ECB(44,24),new ECB(7,25)),new ECBlocks(30,new ECB(59,16),new ECB(1,17))),new Version(35,new Array(6,30,54,78,102,126,150),new ECBlocks(30,new ECB(12,121),new ECB(7,122)),new ECBlocks(28,new ECB(12,47),new ECB(26,48)),new ECBlocks(30,new ECB(39,24),new ECB(14,25)),new ECBlocks(30,new ECB(22,15),new ECB(41,16))),new Version(36,new Array(6,24,50,76,102,128,154),new ECBlocks(30,new ECB(6,121),new ECB(14,122)),new ECBlocks(28,new ECB(6,47),new ECB(34,48)),new ECBlocks(30,new ECB(46,24),new ECB(10,25)),new ECBlocks(30,new ECB(2,15),new ECB(64,16))),new Version(37,new Array(6,28,54,80,106,132,158),new ECBlocks(30,new ECB(17,122),new ECB(4,123)),new ECBlocks(28,new ECB(29,46),new ECB(14,47)),new ECBlocks(30,new ECB(49,24),new ECB(10,25)),new ECBlocks(30,new ECB(24,15),new ECB(46,16))),new Version(38,new Array(6,32,58,84,110,136,162),new ECBlocks(30,new ECB(4,122),new ECB(18,123)),new ECBlocks(28,new ECB(13,46),new ECB(32,47)),new ECBlocks(30,new ECB(48,24),new ECB(14,25)),new ECBlocks(30,new ECB(42,15),new ECB(32,16))),new Version(39,new Array(6,26,54,82,110,138,166),new ECBlocks(30,new ECB(20,117),new ECB(4,118)),new ECBlocks(28,new ECB(40,47),new ECB(7,48)),new ECBlocks(30,new ECB(43,24),new ECB(22,25)),new ECBlocks(30,new ECB(10,15),new ECB(67,16))),new Version(40,new Array(6,30,58,86,114,142,170),new ECBlocks(30,new ECB(19,118),new ECB(6,119)),new ECBlocks(28,new ECB(18,47),new ECB(31,48)),new ECBlocks(30,new ECB(34,24),new ECB(34,25)),new ECBlocks(30,new ECB(20,15),new ECB(61,16))))}function PerspectiveTransform(e,t,n,r,o,i,a,s,c){this.a11=e,this.a12=r,this.a13=a,this.a21=t,this.a22=o,this.a23=s,this.a31=n,this.a32=i,this.a33=c,this.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,o=this.a13,i=this.a21,a=this.a22,s=this.a23,c=this.a31,u=this.a32,l=this.a33,d=0;t>d;d+=2){var p=e[d],g=e[d+1],f=o*p+s*g+l;e[d]=(n*p+i*g+c)/f,e[d+1]=(r*p+a*g+u)/f}},this.transformPoints2=function(e,t){for(var n=e.length,r=0;n>r;r++){var o=e[r],i=t[r],a=this.a13*o+this.a23*i+this.a33;e[r]=(this.a11*o+this.a21*i+this.a31)/a,t[r]=(this.a12*o+this.a22*i+this.a32)/a}},this.buildAdjoint=function(){return new PerspectiveTransform(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new PerspectiveTransform(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function DetectorResult(e,t){this.bits=e,this.points=t}function Detector(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var o=Math.abs(r-t)>Math.abs(n-e);if(o){var i=e;e=t,t=i,i=n,n=r,r=i}for(var a=Math.abs(n-e),s=Math.abs(r-t),c=-a>>1,u=r>t?1:-1,l=n>e?1:-1,d=0,p=e,g=t;p!=n;p+=l){var f=o?g:p,h=o?p:g;if(1==d?this.image[f+h*qrcode.width]&&d++:this.image[f+h*qrcode.width]||d++,3==d){var m=p-e,_=g-t;return Math.sqrt(m*m+_*_)}if((c+=s)>0){if(g==r)break;g+=u,c-=a}}var v=n-e,w=r-t;return Math.sqrt(v*v+w*w)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var o=this.sizeOfBlackWhiteBlackRun(e,t,n,r),i=1,a=e-(n-e);0>a?(i=e/(e-a),a=0):a>=qrcode.width&&(i=(qrcode.width-1-e)/(a-e),a=qrcode.width-1);var s=Math.floor(t-(r-t)*i);return i=1,0>s?(i=t/(t-s),s=0):s>=qrcode.height&&(i=(qrcode.height-1-t)/(s-t),s=qrcode.height-1),a=Math.floor(e+(a-e)*i),(o+=this.sizeOfBlackWhiteBlackRun(e,t,a,s))-1},this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)},this.computeDimension=function(e,t,n,r){var o=7+(Math.round(this.distance(e,t)/r)+Math.round(this.distance(e,n)/r)>>1);switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw"Error"}return o},this.findAlignmentInRegion=function(e,t,n,r){var o=Math.floor(r*e),i=Math.max(0,t-o),a=Math.min(qrcode.width-1,t+o);if(3*e>a-i)throw"Error";var s=Math.max(0,n-o),c=Math.min(qrcode.height-1,n+o);return new AlignmentPatternFinder(this.image,i,s,a-i,c-s,e,this.resultPointCallback).find()},this.createTransform=function(e,t,n,r,o){var i,a,s,c,u=o-3.5;return null!=r?(i=r.X,a=r.Y,s=c=u-3):(i=t.X-e.X+n.X,a=t.Y-e.Y+n.Y,s=c=u),PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,s,c,3.5,u,e.X,e.Y,t.X,t.Y,i,a,n.X,n.Y)},this.sampleGrid=function(e,t,n){return GridSampler.sampleGrid3(e,n,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,r=e.BottomLeft,o=this.calculateModuleSize(t,n,r);if(1>o)throw"Error";var i=this.computeDimension(t,n,r,o),a=Version.getProvisionalVersionForDimension(i),s=a.DimensionForVersion-7,c=null;if(a.AlignmentPatternCenters.length>0)for(var u=n.X-t.X+r.X,l=n.Y-t.Y+r.Y,d=1-3/s,p=Math.floor(t.X+d*(u-t.X)),g=Math.floor(t.Y+d*(l-t.Y)),f=4;16>=f;f<<=1){c=this.findAlignmentInRegion(o,p,g,f);break}var h=this.createTransform(t,n,r,c,i);return new DetectorResult(this.sampleGrid(this.image,h,i),null==c?new Array(r,t,n):new Array(r,t,n,c))},this.detect=function(){var e=(new FinderPatternFinder).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function FormatInformation(e){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}function ErrorCorrectionLevel(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}function BitMatrix(e,t){if(t||(t=e),1>e||1>t)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&URShift(this.bits[n],31&e))},this.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;e>t;t++)this.bits[t]=0},this.setRegion=function(e,t,n,r){if(0>t||0>e)throw"Left and top must be nonnegative";if(1>r||1>n)throw"Height and width must be at least 1";var o=e+n,i=t+r;if(i>this.height||o>this.width)throw"The region must fit inside the matrix";for(var a=t;i>a;a++)for(var s=a*this.rowSize,c=e;o>c;c++)this.bits[s+(c>>5)]|=1<<(31&c)}}function DataBlock(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}function BitMatrixParser(e){var t=e.Dimension;if(21>t||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;6>t;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;var o=r-8;for(t=r-1;t>=o;t--)e=this.copyBit(t,8,e);for(n=r-7;r>n;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(6>=t)return Version.getVersionForNumber(t);for(var n=0,r=e-11,o=5;o>=0;o--)for(var i=e-9;i>=r;i--)n=this.copyBit(i,o,n);if(this.parsedVersion=Version.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(i=5;i>=0;i--)for(o=e-9;o>=r;o--)n=this.copyBit(i,o,n);if(this.parsedVersion=Version.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=DataMask.forReference(e.DataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var o=t.buildFunctionPattern(),i=!0,a=new Array(t.TotalCodewords),s=0,c=0,u=0,l=r-1;l>0;l-=2){6==l&&l--;for(var d=0;r>d;d++)for(var p=i?r-1-d:d,g=0;2>g;g++)o.get_Renamed(l-g,p)||(u++,c<<=1,this.bitMatrix.get_Renamed(l-g,p)&&(c|=1),8==u&&(a[s++]=c,u=0,c=0));i^=!0}if(s!=t.TotalCodewords)throw"Error readCodewords";return a}}function DataMask000(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(e+t&1)}}function DataMask001(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(1&e)}}function DataMask010(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return t%3==0}}function DataMask011(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t)%3==0}}function DataMask100(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(URShift(e,1)+t/3&1)}}function DataMask101(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}}function DataMask110(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}}function DataMask111(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}function ReedSolomonDecoder(e){this.field=e,this.decode=function(e,t){for(var n=new GF256Poly(this.field,e),r=new Array(t),o=0;o<r.length;o++)r[o]=0;var i=!0;for(o=0;t>o;o++){var a=n.evaluateAt(this.field.exp(o));r[r.length-1-o]=a,0!=a&&(i=!1)}if(!i){var s=new GF256Poly(this.field,r),c=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),s,t),u=c[0],l=c[1],d=this.findErrorLocations(u),p=this.findErrorMagnitudes(l,d,!1);for(o=0;o<d.length;o++){var g=e.length-1-this.field.log(d[o]);if(0>g)throw"ReedSolomonException Bad error location";e[g]=GF256.addOrSubtract(e[g],p[o])}}},this.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var o=e,i=t,a=this.field.One,s=this.field.Zero,c=this.field.Zero,u=this.field.One;i.Degree>=Math.floor(n/2);){var l=o,d=a,p=c;if(a=s,c=u,(o=i).Zero)throw"r_{i-1} was zero";i=l;for(var g=this.field.Zero,f=o.getCoefficient(o.Degree),h=this.field.inverse(f);i.Degree>=o.Degree&&!i.Zero;){var m=i.Degree-o.Degree,_=this.field.multiply(i.getCoefficient(i.Degree),h);g=g.addOrSubtract(this.field.buildMonomial(m,_)),i=i.addOrSubtract(o.multiplyByMonomial(m,_))}s=g.multiply1(a).addOrSubtract(d),u=g.multiply1(c).addOrSubtract(p)}var v=u.getCoefficient(0);if(0==v)throw"ReedSolomonException sigmaTilde(0) was zero";var w=this.field.inverse(v),E=u.multiply2(w),C=i.multiply2(w);return new Array(E,C)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,o=1;256>o&&t>r;o++)0==e.evaluateAt(o)&&(n[r]=this.field.inverse(o),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n},this.findErrorMagnitudes=function(e,t,n){for(var r=t.length,o=new Array(r),i=0;r>i;i++){for(var a=this.field.inverse(t[i]),s=1,c=0;r>c;c++)i!=c&&(s=this.field.multiply(s,GF256.addOrSubtract(1,this.field.multiply(t[c],a))));o[i]=this.field.multiply(e.evaluateAt(a),this.field.inverse(s)),n&&(o[i]=this.field.multiply(o[i],a))}return o}}function GF256Poly(e,t){if(null==t||0==t.length)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&0==t[0]){for(var r=1;n>r&&0==t[r];)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=0;for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=t[r+i]}}else this.coefficients=t;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,r=0;t>r;r++)n=GF256.addOrSubtract(n,this.coefficients[r]);return n}var o=this.coefficients[0];for(r=1;t>r;r++)o=GF256.addOrSubtract(this.field.multiply(e,o),this.coefficients[r]);return o},this.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var o=n;n=r,r=o}for(var i=new Array(r.length),a=r.length-n.length,s=0;a>s;s++)i[s]=r[s];for(var c=a;c<r.length;c++)i[c]=GF256.addOrSubtract(n[c-a],r[c]);return new GF256Poly(e,i)},this.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,r=e.coefficients,o=r.length,i=new Array(n+o-1),a=0;n>a;a++)for(var s=t[a],c=0;o>c;c++)i[a+c]=GF256.addOrSubtract(i[a+c],this.field.multiply(s,r[c]));return new GF256Poly(this.field,i)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,n=new Array(t),r=0;t>r;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new GF256Poly(this.field,n)},this.multiplyByMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+e),o=0;o<r.length;o++)r[o]=0;for(o=0;n>o;o++)r[o]=this.field.multiply(this.coefficients[o],t);return new GF256Poly(this.field,r)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),o=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var i=n.Degree-e.Degree,a=this.field.multiply(n.getCoefficient(n.Degree),o),s=e.multiplyByMonomial(i,a),c=this.field.buildMonomial(i,a);t=t.addOrSubtract(c),n=n.addOrSubtract(s)}return new Array(t,n)}}function GF256(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;256>n;n++)this.expTable[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;255>n;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new GF256Poly(this,new Array(r));var o=new Array(1);o[0]=1,this.one=new GF256Poly(this,new Array(o)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new GF256Poly(this,n)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}function URShift(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}function FinderPattern(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}function FinderPatternInfo(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}function FinderPatternFinder(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(e){for(var t=0,n=0;5>n;n++){var r=e[n];if(0==r)return!1;t+=r}if(7>t)return!1;var o=Math.floor((t<<INTEGER_MATH_SHIFT)/7),i=Math.floor(o/2);return Math.abs(o-(e[0]<<INTEGER_MATH_SHIFT))<i&&Math.abs(o-(e[1]<<INTEGER_MATH_SHIFT))<i&&Math.abs(3*o-(e[2]<<INTEGER_MATH_SHIFT))<3*i&&Math.abs(o-(e[3]<<INTEGER_MATH_SHIFT))<i&&Math.abs(o-(e[4]<<INTEGER_MATH_SHIFT))<i},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,n,r){for(var o=this.image,i=qrcode.height,a=this.CrossCheckStateCount,s=e;s>=0&&o[t+s*qrcode.width];)a[2]++,s--;if(0>s)return NaN;for(;s>=0&&!o[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&o[t+s*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;i>s&&o[t+s*qrcode.width];)a[2]++,s++;if(s==i)return NaN;for(;i>s&&!o[t+s*qrcode.width]&&a[3]<n;)a[3]++,s++;if(s==i||a[3]>=n)return NaN;for(;i>s&&o[t+s*qrcode.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var c=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(c-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.crossCheckHorizontal=function(e,t,n,r){for(var o=this.image,i=qrcode.width,a=this.CrossCheckStateCount,s=e;s>=0&&o[s+t*qrcode.width];)a[2]++,s--;if(0>s)return NaN;for(;s>=0&&!o[s+t*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&o[s+t*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;i>s&&o[s+t*qrcode.width];)a[2]++,s++;if(s==i)return NaN;for(;i>s&&!o[s+t*qrcode.width]&&a[3]<n;)a[3]++,s++;if(s==i||a[3]>=n)return NaN;for(;i>s&&o[s+t*qrcode.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var c=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(c-r)>=r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],o=this.centerFromEnd(e,n),i=this.crossCheckVertical(t,Math.floor(o),e[2],r);if(!isNaN(i)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(i),e[2],r),!isNaN(o))){for(var a=r/7,s=!1,c=this.possibleCenters.length,u=0;c>u;u++){var l=this.possibleCenters[u];if(l.aboutEquals(a,i,o)){l.incrementCount(),s=!0;break}}if(!s){var d=new FinderPattern(o,i,a);this.possibleCenters.push(d),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(d)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(3>e)throw"Couldn't find enough finder patterns";if(e>3){for(var t=0,n=0,r=0;e>r;r++){var o=this.possibleCenters[r].EstimatedModuleSize;t+=o,n+=o*o}var i=t/e;this.possibleCenters.sort(function(e,t){var n=Math.abs(t.EstimatedModuleSize-i),r=Math.abs(e.EstimatedModuleSize-i);return r>n?-1:n==r?0:1});var a=Math.sqrt(n/e-i*i),s=Math.max(.2*i,a);for(r=0;r<this.possibleCenters.length&&this.possibleCenters.length>3;r++){var c=this.possibleCenters[r];Math.abs(c.EstimatedModuleSize-i)>s&&(this.possibleCenters.remove(r),r--)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(1>=e)return 0;for(var t=null,n=0;e>n;n++){var r=this.possibleCenters[n];if(r.Count>=CENTER_QUORUM){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;n>r;r++){var o=this.possibleCenters[r];o.Count>=CENTER_QUORUM&&(e++,t+=o.EstimatedModuleSize)}if(3>e)return!1;var i=t/n,a=0;for(r=0;n>r;r++)o=this.possibleCenters[r],a+=Math.abs(o.EstimatedModuleSize-i);return.05*t>=a},this.findFinderPattern=function(e){this.image=e;var t=qrcode.height,n=qrcode.width,r=Math.floor(3*t/(4*MAX_MODULES));MIN_SKIP>r&&(r=MIN_SKIP);for(var o=!1,i=new Array(5),a=r-1;t>a&&!o;a+=r){i[0]=0,i[1]=0,i[2]=0,i[3]=0,i[4]=0;for(var s=0,c=0;n>c;c++)if(e[c+a*qrcode.width])1==(1&s)&&s++,i[s]++;else if(0==(1&s))if(4==s)if(this.foundPatternCross(i)){if(this.handlePossibleCenter(i,a,c))if(r=2,this.hasSkipped)o=this.haveMultiplyConfirmedCenters();else{var u=this.findRowSkip();u>i[2]&&(a+=u-i[2]-r,c=n-1)}else{do{c++}while(n>c&&!e[c+a*qrcode.width]);c--}s=0,i[0]=0,i[1]=0,i[2]=0,i[3]=0,i[4]=0}else i[0]=i[2],i[1]=i[3],i[2]=i[4],i[3]=1,i[4]=0,s=3;else i[++s]++;else i[s]++;if(this.foundPatternCross(i))this.handlePossibleCenter(i,a,n)&&(r=i[0],this.hasSkipped&&(o=haveMultiplyConfirmedCenters()))}var l=this.selectBestPatterns();return qrcode.orderBestPatterns(l),new FinderPatternInfo(l)}}function AlignmentPattern(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}function AlignmentPatternFinder(e,t,n,r,o,i,a){this.image=e,this.possibleCenters=new Array,this.startX=t,this.startY=n,this.width=r,this.height=o,this.moduleSize=i,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=a,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;3>r;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,n,r){var o=this.image,i=qrcode.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var s=e;s>=0&&o[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&!o[t+s*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;i>s&&o[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s++;if(s==i||a[1]>n)return NaN;for(;i>s&&!o[t+s*qrcode.width]&&a[2]<=n;)a[2]++,s++;if(a[2]>n)return NaN;var c=a[0]+a[1]+a[2];return 5*Math.abs(c-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2],o=this.centerFromEnd(e,n),i=this.crossCheckVertical(t,Math.floor(o),2*e[1],r);if(!isNaN(i)){for(var a=(e[0]+e[1]+e[2])/3,s=this.possibleCenters.length,c=0;s>c;c++){if(this.possibleCenters[c].aboutEquals(a,i,o))return new AlignmentPattern(o,i,a)}var u=new AlignmentPattern(o,i,a);this.possibleCenters.push(u),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(u)}return null},this.find=function(){for(var t=this.startX,o=this.height,i=t+r,a=n+(o>>1),s=new Array(0,0,0),c=0;o>c;c++){var u=a+(0==(1&c)?c+1>>1:-(c+1>>1));s[0]=0,s[1]=0,s[2]=0;for(var l=t;i>l&&!e[l+qrcode.width*u];)l++;for(var d=0;i>l;){if(e[l+u*qrcode.width])if(1==d)s[d]++;else if(2==d){var p;if(this.foundPatternCross(s))if(null!=(p=this.handlePossibleCenter(s,u,l)))return p;s[0]=s[2],s[1]=1,s[2]=0,d=1}else s[++d]++;else 1==d&&d++,s[d]++;l++}if(this.foundPatternCross(s))if(null!=(p=this.handlePossibleCenter(s,u,i)))return p}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}function QRCodeDataBlockReader(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,9>=t?this.dataLengthMode=0:t>=10&&26>=t?this.dataLengthMode=1:t>=27&&40>=t&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;e>r;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){var o=0;for(r=0;r<this.bitPointer+1;r++)o+=1<<r;return t=(this.blocks[this.blockPointer]&o)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){o=0;var i=0;for(r=0;r<this.bitPointer+1;r++)o+=1<<r;var a=(this.blocks[this.blockPointer]&o)<<e-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(r=0;r<e-(this.bitPointer+1+8);r++)i+=1<<r;return i<<=8-(e-(this.bitPointer+1+8)),t=a+s+((this.blocks[this.blockPointer]&i)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(qrcode.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,r="",o=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var i=(n=this.getNextBits(11))%45;r+=o[Math.floor(n/45)],r+=o[i],t-=2}else 1==t&&(r+=o[n=this.getNextBits(6)],t-=1)}while(t>0);return r},this.getFigureString=function(e){var t=e,n=0,r="";do{t>=3?(100>(n=this.getNextBits(10))&&(r+="0"),10>n&&(r+="0"),t-=3):2==t?(10>(n=this.getNextBits(7))&&(r+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),r+=n}while(t>0);return r},this.get8bitByteArray=function(e){var t=e,n=0,r=new Array;do{n=this.getNextBits(8),r.push(n),t--}while(t>0);return r},this.getKanjiString=function(e){var t=e,n=0,r="";do{var o,i=((n=getNextBits(13))/192<<8)+n%192;o=40956>=i+33088?i+33088:i+49472,r+=String.fromCharCode(o),t--}while(t>0);return r},this.__defineGetter__("DataByte",function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(dataLength=this.getDataLength(t),dataLength<1)throw"Invalid data length: "+dataLength;switch(t){case 1:for(var n=this.getFigureString(dataLength),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);e.push(r);break;case 2:for(n=this.getRomanAndFigureString(dataLength),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);e.push(r);break;case 4:var i=this.get8bitByteArray(dataLength);e.push(i);break;case 8:n=this.getKanjiString(dataLength);e.push(n)}}return e})}!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),t=t||{};var n,r=i(e),a=r.source,l=r.id,d=r.path,p=u[l]&&d in u[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||p?(c("ignoring socket cache for %s",a),n=s(a,t)):(u[l]||(c("new io instance for %s",a),u[l]=s(a,t)),n=u[l]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(1),a=n(7),s=n(13),c=n(3)("socket.io-client");e.exports=t=r;var u=t.managers={};t.protocol=a.protocol,t.connect=r,t.Manager=n(13),t.Socket=n(39)},function(e,t,n){(function(t){"use strict";var r=n(2),o=n(3)("socket.io-client:url");e.exports=function(e,n){var i=e;n=n||t.location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),o("parse %s",e),i=r(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";var a=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+a+":"+i.port,i.href=i.protocol+"://"+a+(n&&n.port===i.port?"":":"+i.port),i}}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return-1!=o&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(i=++o)}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function i(){f&&p&&(f=!1,p.length?g=p.concat(g):h=-1,g.length&&a())}function a(){if(!f){var e=o(i);f=!0;for(var t=g.length;t;){for(p=g,g=[];++h<t;)p&&p[h].run();h=-1,t=g.length}p=null,f=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var u,l,d=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var p,g=[],f=!1,h=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new s(e,t)),1!==g.length||f||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){function r(e){function n(){if(n.enabled){var e=n,r=+new Date,i=r-(o||r);e.diff=i,e.prev=o,e.curr=r,o=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}var o;(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&("-"===(e=n[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(6),t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){return r(e,s,"day")||r(e,a,"hour")||r(e,i,"minute")||r(e,o,"second")||e+" ms"}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var o=1e3,i=60*o,a=60*i,s=24*a,c=365.25*s;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*a;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===r&&!1===isNaN(e))return t.long?n(e):function(e){return e>=s?Math.round(e/s)+"d":e>=a?Math.round(e/a)+"h":e>=i?Math.round(e/i)+"m":e>=o?Math.round(e/o)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function o(e){var n=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data&&(n+=JSON.stringify(e.data)),u("encoded %j as %s",e,n),n}function i(){this.reconstructor=null}function a(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return c();if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===e.charAt(n+1))for(r.nsp="";++n;){if(","===(a=e.charAt(n)))break;if(r.nsp+=a,n===e.length)break}else r.nsp="/";var i=e.charAt(n+1);if(""!==i&&Number(i)==i){for(r.id="";++n;){var a;if(null==(a=e.charAt(n))||Number(a)!=a){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}return e.charAt(++n)&&(r=function(e,t){try{e.data=JSON.parse(t)}catch(e){return c()}return e}(r,e.substr(n))),u("decoded %s as %j",e,r),r}function s(e){this.reconPack=e,this.buffers=[]}function c(){return{type:t.ERROR,data:"parser error"}}var u=n(3)("socket.io-parser"),l=n(8),d=n(9),p=n(11),g=n(12);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=i,r.prototype.encode=function(e,n){(e.type!==t.EVENT&&e.type!==t.ACK||!d(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),u("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){p.removeBlobs(e,function(e){var n=p.deconstructPacket(e),r=o(n.packet),i=n.buffers;i.unshift(r),t(i)})}(e,n):n([o(e)])},l(i.prototype),i.prototype.add=function(e){var n;if("string"==typeof e)n=a(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new s(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!g(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},i.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},s.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},s.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(t){var r=n(10),o=Object.prototype.toString,i="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),a="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var o=0,s=n.length;o<s;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(n)||"function"==typeof t.ArrayBuffer&&n instanceof ArrayBuffer||i&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}}).call(t,function(){return this}())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){var r=n(10),o=n(12),i=Object.prototype.toString,a="function"==typeof e.Blob||"[object BlobConstructor]"===i.call(e.Blob),s="function"==typeof e.File||"[object FileConstructor]"===i.call(e.File);t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=function e(t,n){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:n.length};return n.push(t),i}if(r(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],n);return a}if("object"==typeof t&&!(t instanceof Date)){for(var c in a={},t)a[c]=e(t[c],n);return a}return t}(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;(function e(c,u,l){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){n++;var d=new FileReader;d.onload=function(){l?l[u]=this.result:i=this.result,--n||t(i)},d.readAsArrayBuffer(c)}else if(r(c))for(var p=0;p<c.length;p++)e(c[p],p,c);else if("object"==typeof c&&!o(c))for(var g in c)e(c[g],g,c)})(i),n||t(i)}}).call(t,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new g({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||c;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(14),a=n(39),s=n(8),c=n(7),u=n(41),l=n(42),d=n(3)("socket.io-client:manager"),p=n(37),g=n(43),f=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=u(n,"open",function(){r.onopen(),e&&e()}),a=u(n,"error",function(t){if(d("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;d("connect attempt will timeout after %d",s);var c=setTimeout(function(){d("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(a),this},r.prototype.onopen=function(){d("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",l(this,"ondata"))),this.subs.push(u(e,"ping",l(this,"onping"))),this.subs.push(u(e,"pong",l(this,"onpong"))),this.subs.push(u(e,"error",l(this,"onerror"))),this.subs.push(u(e,"close",l(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",l(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){d("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~p(o.connecting,r)||o.connecting.push(r)}var r=this.nsps[e];if(!r){r=new a(this,e,t),this.nsps[e]=r;var o=this;r.on("connecting",n),r.on("connect",function(){r.id=o.generateId(e)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=p(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){d("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){d("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){d("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){d("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();d("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(d("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(d("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(d("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(15)},function(e,t,n){e.exports=n(16),e.exports.parser=n(23)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=u(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=u(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var o="object"==typeof t&&t;o.global===o&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var o=n(17),i=n(8),a=n(3)("engine.io-client:socket"),s=n(37),c=n(23),u=n(2),l=n(38),d=n(31);e.exports=r,r.priorWebsocketSuccess=!1,i(r.prototype),r.protocol=c.protocol,r.Socket=r,r.Transport=n(22),r.transports=n(17),r.parser=n(23),r.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=c.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new o[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;d=d||t}d||(a('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe"}]),l.once("packet",function(t){if(!d)if("pong"===t.type&&"probe"===t.data){if(a('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",l),!l)return;r.priorWebsocketSuccess="websocket"===l.name,a('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){d||"closed"!==p.readyState&&(a("changing transport and sending upgrade packet"),u(),p.setTransport(l),l.send([{type:"upgrade"}]),p.emit("upgrade",l),l=null,p.upgrading=!1,p.flush())})}else{a('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,p.emit("upgradeError",n)}}))}function n(){d||(d=!0,u(),l.close(),l=null)}function o(t){var r=new Error("probe error: "+t);r.transport=l.name,n(),a('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function i(){o("transport closed")}function s(){o("socket closed")}function c(e){l&&e.name!==l.name&&(a('"%s" works - aborting "%s"',e.name,l.name),n())}function u(){l.removeListener("open",t),l.removeListener("error",o),l.removeListener("close",i),p.removeListener("close",s),p.removeListener("upgrading",c)}a('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),d=!1,p=this;r.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",o),l.once("close",i),this.once("close",s),this.once("upgrading",c),l.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){a("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e){var r=n(18),o=n(20),i=n(34),a=n(35);t.polling=function(t){var n=!1,a=!1,s=!1!==t.jsonp;if(e.location){var c="https:"===location.protocol,u=location.port;u||(u=c?443:80),n=t.hostname!==location.hostname||u!==t.port,a=t.secure!==c}if(t.xdomain=n,t.xscheme=a,"open"in new r(t)&&!t.forceJSONP)return new o(t);if(!s)throw new Error("JSONP disabled");return new i(t)},t.websocket=a}).call(t,function(){return this}())},function(e,t,n){(function(t){var r=n(19);e.exports=function(e){var n=e.xdomain,o=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!o&&i)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){(function(t){function r(){}function o(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var s=n(18),c=n(21),u=n(8),l=n(32),d=n(3)("engine.io-client:polling-xhr");e.exports=o,e.exports.Request=i,l(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new i(e)},o.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},o.prototype.doPoll=function(){d("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new s(e),r=this;try{d("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState){var e;try{e=n.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(n.responseType="arraybuffer")}4===n.readyState&&(200===n.status||1223===n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},d("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),o.call(this,e)}var o=n(22),i=n(31),a=n(23),s=n(32),c=n(33),u=n(3)("engine.io-client:polling");e.exports=r;var l=null!=new(n(18))({xdomain:!1}).responseType;s(r,o),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){u("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||t()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;u("polling got data %s",e);a.decodePayload(e,this.socket.binaryType,function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var o=n(23),i=n(8);e.exports=r,i(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){function r(e,n){return n("b"+t.packets[e.type]+e.data.data)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=m[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return r(a.buffer)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(h)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,t.encodePacket(e,n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);return o[0]=m[e.type],r(new w([o.buffer,e.data]))}function a(e,t,n){for(var r=new Array(e.length),o=d(e.length,n),i=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},a=0;a<e.length;a++)i(a,e[a],o)}var s,c=n(24),u=n(9),l=n(25),d=n(26),p=n(27);e&&e.ArrayBuffer&&(s=n(29));var g="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=g||f;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},_=c(m),v={type:"error",data:"parser error"},w=n(30);t.encodePacket=function(t,n,a,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof a&&(s=a,a=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return o(t,n,s);if(w&&c instanceof e.Blob)return i(t,n,s);if(c&&c.base64)return r(t,s);var u=m[t.type];return void 0!==t.data&&(u+=a?p.encode(String(t.data),{strict:!1}):String(t.data)),s(""+u)},t.encodeBase64Packet=function(n,r){var o,i="b"+t.packets[n.type];if(w&&n.data instanceof e.Blob){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];r(i+e)},a.readAsDataURL(n.data)}try{o=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var s=new Uint8Array(n.data),c=new Array(s.length),u=0;u<s.length;u++)c[u]=s[u];o=String.fromCharCode.apply(null,c)}return i+=e.btoa(o),r(i)},t.decodePacket=function(e,n,r){if(void 0===e)return v;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=p.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return v;var o=e.charAt(0);return Number(o)==o&&_[o]?e.length>1?{type:_[o],data:e.substring(1)}:{type:_[o]}:v}o=new Uint8Array(e)[0];var i=l(e,1);return w&&"blob"===n&&(i=new w([i])),{type:_[o],data:i}},t.decodeBase64Packet=function(e,t){var n=_[e.charAt(0)];if(!s)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=s.decode(e.substr(1));return"blob"===t&&w&&(r=new w([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=u(e);return n&&o?w&&!h?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void a(e,function(e,r){t.encodePacket(e,!!o&&n,!1,function(e){r(null,function(e){return e.length+":"+e}(e))})},function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(v,0,1);for(var i,a,s="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(i=Number(s)))return r(v,0,1);if(s!=(a=e.substr(c+1,i)).length)return r(v,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),v.type===o.type&&v.data===o.data)return r(v,0,1);if(!1===r(o,c+i,u))return}c+=i,s=""}else s+=l}return""!==s?r(v,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void a(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),o=new Uint8Array(r),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)o[i++]=r[a]}),n(o.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){a(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,w){var s=new w([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new w(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var a=new Uint8Array(o),s=0===a[0],c="",u=1;255!==a[u];u++){if(c.length>310)return r(v,0,1);c+=a[u]}o=l(o,2+c.length),c=parseInt(c);var d=l(o,0,c);if(s)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var p=new Uint8Array(d);d="";for(u=0;u<p.length;u++)d+=String.fromCharCode(p[u])}i.push(d),o=l(o,c)}var g=i.length;i.forEach(function(e,o){r(t.decodePacket(e,n,!0),o,g)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}var i=!1;return r=r||n,o.count=e,0===e?t():o}},function(e,t,n){var r;(function(e,o){!function(i){function a(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return m(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return m(e);var n="";return 0==(4294965248&e)?n=m(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=m(e>>12&15|224),n+=c(e,6)):0==(4292870144&e)&&(n=m(e>>18&7|240),n+=c(e,12),n+=c(e,6)),n+m(63&e|128)}function l(){if(h>=f)throw Error("Invalid byte index");var e=255&g[h];if(h++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var t,n;if(h>f)throw Error("Invalid byte index");if(h==f)return!1;if(t=255&g[h],h++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|l())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|l()<<6|l())>=2048)return s(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&((n=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&n<=1114111))return n;throw Error("Invalid UTF-8 detected")}var p=("object"==typeof e&&e&&e.exports,"object"==typeof o&&o);p.global!==p&&p.window;var g,f,h,m=String.fromCharCode,_={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),o=r.length,i=-1,s="";++i<o;)s+=u(r[i],n);return s},decode:function(e,t){var n=!1!==(t=t||{}).strict;g=a(e),f=g.length,h=0;for(var r,o=[];!1!==(r=d(n));)o.push(r);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=m(t);return o}(o)}};void 0===(r=function(){return _}.call(t,n,t,e))||(e.exports=r)}()}).call(t,n(28)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],d[u++]=r<<2|o>>4,d[u++]=(15&o)<<4|i>>2,d[u++]=(3&i)<<6|63&a;return l}}()},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function r(e,t){t=t||{};var r=new i;n(e);for(var o=0;o<e.length;o++)r.append(e[o]);return t.type?r.getBlob(t.type):r.getBlob()}function o(e,t){return n(e),new Blob(e,t||{})}var i=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,a=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),s=a&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;e.exports=a?s?t.Blob:o:c?r:void 0}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do{t=i[e%a]+t,e=Math.floor(e/a)}while(e>0);return t}function r(){var e=n(+new Date);return e!==o?(c=0,o=e):e+"."+n(c++)}for(var o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,s={},c=0,u=0;u<a;u++)s[i[u]]=u;r.encode=n,r.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*a+s[e.charAt(u)];return t},e.exports=r},function(e,t,n){(function(t){function r(){}function o(e){i.call(this,e),this.query=this.query||{},s||(t.___eio||(t.___eio=[]),s=t.___eio),this.index=s.length;var n=this;s.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var i=n(21),a=n(32);e.exports=o;var s,c=/\n/g,u=/\\n/g;a(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,a=document.createElement("form"),s=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=l,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(u,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=d&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),i.call(this,e)}var o,i=n(22),a=n(23),s=n(31),c=n(32),u=n(33),l=n(3)("engine.io-client:websocket"),d=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{o=n(36)}catch(e){}var p=d;p||"undefined"!=typeof window||(p=o),e.exports=r,c(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new p(e,t):new p(e):new p(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,o=0,i=r;o<i;o++)!function(e){a.encodePacket(e,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),n.perMessageDeflate)("string"==typeof o?t.Buffer.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(i.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,i)}catch(e){l("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[o])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(o,"]").replace(i,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(7),a=n(8),s=n(40),c=n(41),u=n(42),l=n(3)("socket.io-client:socket"),d=n(31);e.exports=r;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},g=a.prototype.emit;a(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",u(this,"onopen")),c(e,"packet",u(this,"onpacket")),c(e,"close",u(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(p.hasOwnProperty(e))return g.apply(this,arguments),this;var t=s(arguments),n={type:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?d.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?g.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);l("sending ack %j",r),t.packet({type:i.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)g.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){"use strict";e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])}),function(){"use strict";var e,t,n;angular.lowercase=function(e){return e&&e.toLowerCase(),""},angular.module("WissenSystem",["ngAnimate","ngAria","ngCookies","ngResource","ngRoute","ngSanitize","ui.router","ui.bootstrap","pascalprecht.translate","angular-loading-bar","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","ui.grid.cellNav","ui.grid.autoResize","ngFileUpload","FBAngular","ngMaterial","textAngular","angular-svg-round-progress","qrScanner","ja.qr","ngclipboard","camera","toastr","ui.select","restangular","angular-web-notification"]).constant("App",(e=(t=location.hostname)+"/","undefined"!=typeof Storage?null===localStorage.getItem("dominio")?(console.log("No hay dominio almacenado"),localStorage.setItem("dominio",t)):localStorage.servidor_por_puerto?e=localStorage.servidor_por_puerto>0?location.protocol+"//"+localStorage.getItem("dominio")+":"+localStorage.servidor_por_puerto+"/":location.protocol+"//"+localStorage.getItem("dominio")+"/":(localStorage.servidor_por_puerto=0,e=location.protocol+"//"+localStorage.getItem("dominio")+"/"):alert("El navegador no soporta LocalStorage"),console.log("hostname: ",location.hostname),n="8787"===location.port||8787===location.port?location.origin+"/":localStorage.servidor_por_puerto&&parseInt(localStorage.servidor_por_puerto)>0?location.protocol+"//"+location.hostname+":"+localStorage.servidor_por_puerto+"/":e+"wissenLaravel/public/",console.log(n),{Server:n,views:"views/",images:n+"images/",perfilPath:n+"images/perfil/",imgSystemPath:n+"images/eventos/",dominio:e})).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",participante:"participante",tecnico:"tecnico",profesor:"profesor",guest:"guest",ejecutor:"ejecutor"}).constant("PERMISSIONS",{can_work_like_admin:"like_admin",can_work_like_teacher:"like_teacher",can_work_like_participante:"like_participante",can_work_like_asesor:"like_asesor",can_work_like_guest:"like_guest",can_work_like_ejecutor:"can_work_like_ejecutor",can_accept_images:"can_accept_images",can_edit_participantes:"can_edit_participantes",can_edit_usuarios:"can_edit_usuarios"})}.call(this),function(){"use strict";angular.module("WissenSystem").controller("ApplicationController",["$scope","USER_ROLES","AuthService","toastr","$state","$rootScope","Restangular","$filter","$timeout","MySocket",function(e,t,n,r,o,i,a,s,c,u){return e.isAuthorized=n.isAuthorized,e.hasRoleOrPerm=n.hasRoleOrPerm,e.USER_ROLES=t,e.isLoginPage=!1,e.navFull=!1,e.toggleNav=function(){return e.navFull=!e.navFull,e.navOffCanvas=!e.navOffCanvas,console.log("navOffCanvas: "+e.navOffCanvas),c(function(){return e.$broadcast("c3.resize")},260)},e.tema="theme-zero",e.cambiarTema=function(t){return e.tema=t},e.idiomas_del_sistema=function(){var t,n,r,o,i;for(e.idiomas_usados=s("idiomas_del_sistema")(e.idiomas),i=[],t=0,r=(o=e.idiomas_usados).length;t<r;t++)"ES"===(n=o[t]).abrev?i.push(n.actual=!0):i.push(void 0);return i},e.idiomas=[],a.all("idiomas").getList().then(function(t){return e.idiomas=t,e.idiomas_del_sistema()},function(e){var t;return 404!==e.status?console.log("No se trajeron los idiomas del sistema.",e):localStorage.recargado_automaticamente?(t=parseInt(localStorage.recargado_automaticamente))>2?confirm("No se ha podido establecer conexión. ¿Deseas recargar? (tal vez debas borrar datos de navegación)")?location.reload():void 0:(localStorage.recargado_automaticamente=1+t,location.reload()):(localStorage.recargado_automaticamente=1,location.reload())}),e.in_evento_actual={}}])}.call(this),function(){angular.module("WissenSystem").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider","App","PERMISSIONS","RestangularProvider","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig","uiSelectConfig","$provide",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g){return s.setBaseUrl(i.Server+"api/"),r.defaults.useXDomain=!0,delete r.defaults.headers.common["X-Requested-With"],r.defaults.headers.common.Accept="application/json",r.defaults.headers.common["Content-Type"]="application/json",p.theme="select2",p.resetSearchInput=!0,n.otherwise("/login"),t.state("main",{url:"/",views:{principal:{templateUrl:i.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{pageTitle:"En Construcción"}}).state("landing",{url:"/landing",views:{principal:{templateUrl:i.views+"main/landing.tpl.html",controller:"LandingCtrl"}},data:{pageTitle:"Liceo Adventista Libertad"}}).state("login",{url:"/login",views:{principal:{templateUrl:`${i.views}login/login.tpl.html`,controller:"LoginCtrl"}},data:{pageTitle:"Ingresar a Wissen"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:`${i.views}login/logout.tpl.html`,controller:"LogoutCtrl"}},data:{icon_fa:"fa fa-user"}}),u.bigLoader=!0,g.decorator("taOptions",["taRegisterTool","$delegate",function(e,t){return t.forceTextAngularSanitize=!1,t.toolbar=[["h1","h2","h3","p","pre"],["bold","italics","underline","ul","ol","undo","redo"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["insertImage","insertLink","insertVideo","html","charcount"]],e("superscript",{iconclass:"fa fa-superscript",action:function(){return this.$editor().wrapSelection("superscript",null)},activeState:function(){return this.$editor().queryCommandState("superscript")}}),e("subscript",{iconclass:"fa fa-subscript",action:function(){return this.$editor().wrapSelection("subscript",null)},activeState:function(){return this.$editor().queryCommandState("subscript")}}),e("insertSlash",{iconclass:"fa fa-slash",tooltiptext:"Insertar fracción",action:function(e,t){return this.$editor().wrapSelection("insertHTML","&frasl;",!0)}}),t.toolbar[2].push("superscript"),t.toolbar[2].push("subscript"),t.toolbar[2].push("insertSlash"),t}]),_.mixin({findByValues:function(e,t,n){var r;return 0!==(r=_.filter(e,function(e){return _.contains(n,e[t])})).length&&r[0]}}),this}]).filter("capitalize",function(){return function(e,t){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}})}.call(this),function(){"use strict";angular.module("WissenSystem").controller("MainCtrl",["$scope",function(e){console.log("A cambiar desde main")}]).controller("LandingCtrl",["$scope",function(e){}])}.call(this),function(){angular.module("WissenSystem").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$translate","$cookies","Restangular","Perfil","AuthService","AUTH_EVENTS","toastr",function(e,t,n,r,o,i,a,s,c,u,l){var d;return e.examen_actual=[],e.permiso_de_salir=!1,e.$state=n,e.$stateParams=r,e.lastState=null,e.lastStateParam=null,e.$on("event:auth-loginRequired",function(e){return console.log("Acceso no permitido, vamos a loguear",e),n.transitionTo("login")}),d=function(){return console.log(e.lastState),null===e.lastState||"login"===e.lastState||"/"===e.lastState||"main"===e.lastState?n.go("panel"):n.transitionTo(e.lastState,e.lastStateParam)},e.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),d()}),e.$on("$stateChangeStart",function(t,n,r,o,i){if((null===e.lastState||"logout"!==n.name&&"login"!==n.name&&"main"!==n.name)&&(e.lastState=n.name,e.lastStateParam=r),"panel.examen_respuesta"===o.name&&!1===e.permiso_de_salir&&!confirm("No debes salir del examen, ¿Seguro de continuar?"))return t.preventDefault()}),e.$on("$stateChangeSuccess",function(t,r,o,i,a){return e.pageTitle=n.current.name}),e.$on("$stateChangeError",function(t,r,o,i,a){return console.log(e.lastState,"-Evento fallido: ",t),l.warning("Lo sentimos, hubo un error o no puedes acceder a esta vista"),"panel"!==e.lastState?n.transitionTo("panel"):n.transitionTo("login")}),e.$on("$translatePartialLoaderStructureChanged",function(){return o.refresh(),console.log("Translate refrescado supuestamente.")}),e.$on(u.loginSuccess,function(){return d()}),e.$on(u.loginFailed,function(e){return l.error("Datos incorrecto.","No se pudo loguear"),console.log("Evento loginFailed: ",e)}),e.$on(u.notAuthenticated,function(e){return l.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",e),n.transitionTo("login")}),e.$on(u.notAuthorized,function(t){return l.warning("No está autorizado para entrar a esta vista","Restringido"),n.go("panel"),console.log("Evento notAuthorized: ",t,e.lastState)})}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(e,t,n,r,o){return o.translations("EN",{LOGIN_MSG:"Sign In to the panel"}).translations("ES",{LOGIN_MSG:"Ingresa al panel"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("LoginCtrl",["$scope","$state","$mdDialog","AUTH_EVENTS","AuthService","$stateParams","Restangular","$cookies","Perfil","App","cfpLoadingBar","toastr","MySocket","SocketData","SocketClientes","$rootScope","$http",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h,m){e.logoPath="images/MyVc-1.gif",e.imagesPath=u.images,e.modificando_servidor=!1,e.editando_nombre_punto=!1,e.dominio=localStorage.getItem("dominio"),e.MySocket=p,e.SocketData=g,e.SocketClientes=f,e.usuarios_all=[],e.selectedUser={},e.bring_registered_boolean=function(){return e.registered_boolean=!!localStorage.getItem("registered_boolean")&&localStorage.getItem("registered_boolean"),e.registered_boolean="true"===e.registered_boolean,e.registered_boolean},e.in_evento_actual.qr="",e.in_evento_actual.nombre||a.one("welcome").customGET().then(function(t){return e.in_evento_actual=t,e.in_evento_actual.ip=localStorage.getItem("nombre_punto")?localStorage.getItem("nombre_punto"):e.in_evento_actual.ip,p.emit("guardar:mi_qr:resourceId",{qr:t.qr})},function(e){return d.warning("No se trae el evento principal")}),e.credentials={username:"",password:""},l.complete(),p.on("enter",function(e){var n;if(e.usuario)return n=e.usuario.rowid?e.usuario.rowid:e.usuario.id,a.one("qr/validar-usuario").customPUT({user_id:n,token_auth:e.from_token}).then(function(e){if(e.token)return f.usuarios_all=[],s.put("xtoken",e.token),m.defaults.headers.common.Authorization="Bearer "+s.get("xtoken"),t.is("panel")?location.reload(!0):t.go("panel")},function(e){return d.warning("No se pudo ingresar"),console.log("No se validó el token para este usuario ",e)})}),e.login=function(){return o.login_credentials(e.credentials).then(function(e){},function(e){return console.log("Promise de login_credentials rechazada",e)})},e.registrar=function(){return localStorage.setItem("registered_boolean",!0),location.reload(!0)},e.desregistrar=function(){return localStorage.setItem("registered_boolean",!1),location.reload(!0)},e.entrar_como_invitado=function(){return e.credentials.username="sc",e.credentials.password="123",o.login_credentials(e.credentials).then(function(e){},function(e){return console.log("Promise de login_credentials rechazada",e)})},e.mostrar_modificar_servidor=function(){return e.modificando_servidor=!e.modificando_servidor},e.guardar_servidor=function(){var t;return localStorage.setItem("dominio",e.dominio),(t=e.dominio.split(":"))[1]&&localStorage.setItem("servidor_por_puerto",parseInt(t[1])),location.reload()},e.borrar_servidor=function(){return localStorage.removeItem("dominio")},e.editarNombrePunto=function(t){var r;return(r={}).target=document.getElementById("nombre_punto"),n.show({controller:"PasswordNombrePuntoCtrl",templateUrl:u.views+"login/passwordNombrePunto.tpl.html",parent:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0,targetEvent:r}).then(function(t){return console.log(t),""!==t&&null!==t&&t===e.in_evento_actual.password?e.editando_nombre_punto=!0:d.warning("Contraseña incorrecta")},function(){return e.status="You didn't name your dog."})},e.seleccionarUsu=function(t){var n,r,o,i,a,s;if(t.seleccionado=!t.seleccionado,s=t.rowid?t.rowid:t.id,t.seleccionado){for(e.selectedUser=t,i=[],n=0,r=(o=e.usuarios_all).length;n<r;n++)((a=o[n]).rowid?a.rowid:a.id)!==s?i.push(a.seleccionado=!1):i.push(void 0);return i}},e.seleccionarCkUsu=function(t){var n,r,o,i,a,s;if(s=t.rowid?t.rowid:t.id,t.seleccionado){for(e.selectedUser=t,i=[],n=0,r=(o=e.usuarios_all).length;n<r;n++)((a=o[n]).rowid?a.rowid:a.id)!==s?i.push(a.seleccionado=!1):i.push(void 0);return i}},e.ingresar_seleccionado=function(){var n;return e.selectedUser.id||e.selectedUser.rowid?(n=e.selectedUser.rowid?e.selectedUser.rowid:e.selectedUser.id,a.one("qr/validar-usuario").customPUT({user_id:n,token_auth:g.token_auth}).then(function(n){if(n.token)return e.usuarios_all=[],s.put("xtoken",n.token),m.defaults.headers.common.Authorization="Bearer "+s.get("xtoken"),t.go("panel")},function(e){return d.warning("No se pudo ingresar"),console.log("No se pudo ingresar ",e)})):d.warning("Selecciona el usuario correspondiente")},e.guardarNombrePunto=function(){return localStorage.setItem("nombre_punto",e.in_evento_actual.ip),e.editando_nombre_punto=!1},h.$on("nombre_punto_cambiado",function(t,n){if(n.resourceId===c.getResourceId())return localStorage.setItem("nombre_punto",n.nombre),e.in_evento_actual.ip=n.nombre}),h.$on("reconocido:mi_nombre_punto",function(t,n){return localStorage.setItem("nombre_punto",n.nombre_punto),e.in_evento_actual.ip=n.nombre_punto})}]).controller("PasswordNombrePuntoCtrl",["$scope","$mdDialog","toastr",function(e,t,n){e.validar=function(e){return t.hide(e)},e.cancelar=function(){return t.cancel()}}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(e,t,n,r,o){e.state("panel",{url:"/panel",views:{principal:{templateUrl:`${t.views}panel/panel.tpl.html`,controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}]},data:{pageTitle:"WissenSystem - Bienvenido"}}),o.preferredLanguage("ES"),o.translations("EN",{INICIO_MENU:"Home",USERS_MENU:"Users",EVENTS_MENU:"Events",ENTIDADES_MENU:"Entities",CATEGS_MENU:"Categories",PREGUNTAS_MENU:"Questions",EVALUACIONES_MENU:"Tests",IDIOMA_MENU:"Language",INFORMES_MENU:"Reports",CONTROL_MENU:"Monitoring",SCANNER_MENU:"QR Scanner",SALIR:"Sign out",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Great ultimate",INSCRITO_EN:"You are signed in:",NO_ESTAS_INSCRITO:"You are`t signed in any category.",EXAM_HECHOS:"Done Exams",IMAGEN_TL:"Image"}).translations("ES",{INICIO_MENU:"Inicio",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorías",PREGUNTAS_MENU:"Preguntas",EVALUACIONES_MENU:"Evaluaciones",USERS_MENU:"Usuarios",IDIOMA_MENU:"Idioma",INFORMES_MENU:"Informes",CONTROL_MENU:"Control",SCANNER_MENU:"Escaner QR",SALIR:"Salir",ELIMINATORIAS:"Eliminatorias",GRAN_FINAL:"Gran final",INSCRITO_EN:"Estás inscrito en:",NO_ESTAS_INSCRITO:"No estás inscrito en ninguna categoría.",EXAM_HECHOS:"Exámenes hechos",IMAGEN_TL:"Imagen"}).translations("PT",{INICIO_MENU:"Iniciação",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorias",PREGUNTAS_MENU:"Interrogatório",EVALUACIONES_MENU:"Evaluations",USERS_MENU:"Usuários",IDIOMA_MENU:"Língua",INFORMES_MENU:"Informação",CONTROL_MENU:"Controle",SCANNER_MENU:"QR Scanner",SALIR:"Deixar",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Grande final",INSCRITO_EN:"Você está matriculado:",NO_ESTAS_INSCRITO:"Você não está registrado em qualquer categoria.",EXAM_HECHOS:"Testes feitos",IMAGEN_TL:"Image"}).translations("FR",{INICIO_MENU:"Initiation",EVENTS_MENU:"Événements",ENTIDADES_MENU:"Entités",CATEGS_MENU:"Catégories",PREGUNTAS_MENU:"Questionnement",EVALUACIONES_MENU:"Evaluations",USERS_MENU:"Utilisateurs",IDIOMA_MENU:"Langue",INFORMES_MENU:"Rapports",CONTROL_MENU:"Contrôle",SCANNER_MENU:"QR Scanner",SALIR:"Laisser",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Grande finale",INSCRITO_EN:"Vous êtes inscrit à:",NO_ESTAS_INSCRITO:"Vous n'êtes pas inscrit dans aucune catégorie.",EXAM_HECHOS:"Tests effectués",IMAGEN_TL:"Image"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("PanelCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","AuthService","Perfil","App","resolved_user","toastr","$translate","$filter","$uibModal","MySocket","Fullscreen","SocketClientes","SocketData",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h,m,_){var v;e.SocketData=_,e.USER=u,e.imagesPath=c.images,v=(new Date).toJSON().slice(0,10),e.dataExport={fecha_ini:new Date(v+" 00:00:0000"),fecha_fin:new Date(v+" 23:59:0000")},a.verificar_acceso(),e.file={},e.data={},e.floatingSidebar=!1,e.toggleFloatingSidebar=function(){return e.floatingSidebar=!e.floatingSidebar,e.cargarExamenesExport()},e.cargarExamenesExport=function(){return n.one("exportar-importar/ver-cambios").customPUT({fecha_ini:e.dataExport.fecha_ini,fecha_fin:e.dataExport.fecha_fin}).then(function(t){return e.export_participantes=t},function(e){return l.warning("No se trajeron datos para exportar ")})},e.exportarArchivo=function(){var t,n,r,o,i;return i="Examenes_exportados-Wissen.txt",e.export_participantes=p("filter")(e.export_participantes,{exportar:1}),r=JSON.stringify(e.export_participantes,void 0,"\t"),n=new Blob([r],{type:"text/plain"}),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(n,i):(o=document.createEvent("MouseEvents"),(t=document.createElement("a")).download=i,t.href=window.URL.createObjectURL(n),t.dataset.downloadurl=["text/json",t.download,t.href].join(":"),o.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(o))},e.datos_json="",e.array_usuarios_import=0,e.cargar_datos_json=function(t){return e.array_usuarios_import=JSON.parse(t),n.one("exportar-importar/revisar-datos").customPUT({array_usuarios:e.array_usuarios_import}).then(function(t){return e.array_usuarios=t},function(e){return l.warning("No se trajeron datos para exportar ")})},e.importarDatos=function(){var t,r,o,i,a,s,c,u;if(confirm("¿Seguro que desea importar datos?")){for(r=0,i=(s=e.array_usuarios_import).length;r<i;r++)for(u=s[r],o=0,a=(c=e.array_usuarios).length;o<a;o++)t=c[o],u.id===t.id&&(e.array_usuarios_import=p("filter")(e.array_usuarios_import,{id:"!"+u.id}));return n.one("exportar-importar/importar-datos").customPUT({array_usuarios:e.array_usuarios_import}).then(function(e){return l.success("Importados con éxito: "+e.importados)},function(e){return l.warning("No se pudieron importar datos ")})}},i.$on("$stateChangeSuccess",function(t,n,r,o,i){return e.cambiarTema("theme-zero")}),i.$on("categ_selected_change",function(t,n){return e.USER.categsel=n}),i.reload=function(){return r.go(r.current,$stateParams,{reload:!0})},e.setFullScreen=function(){return h.toggleAll()},e.openMenu=function(e,t){return t,e(t)},e.cambiarIdioma=function(t){return n.one("idiomas/cambiar-idioma").customPUT({idioma_id:t.id}).then(function(n){var r,o,i,a;for(d.use(t.abrev),e.USER.idioma_main_id=t.id,e.idiomas_del_sistema(),r=0,i=(a=e.idiomas_usados).length;r<i;r++)(o=a[r]).actual=o.abrev===t.abrev;return l.success("Idioma cambiado por "+t.abrev)},function(e){return console.log("No se pudo cambiar el idioma.",e)})},e.set_system_event=function(t){return n.one("eventos/set-evento-actual").customPUT({id:t.id}).then(function(n){return console.log("Evento cambiado: ",n),angular.forEach(e.USER.eventos,function(e,t){return e.actual=!1}),t.actual=!0,l.success("Evento actual cambiado por "+t.alias)},function(e){return console.log("Error conectando!",e),l.warning("No se pudo cambiar el evento actual.")})},e.evento_actual={},e.el_evento_actual=function(){if(e.USER){if(!a.isAuthorized("can_work_like_admin")&&!a.isAuthorized("like_asesor"))return e.evento_actual=e.USER.evento_actual;try{return e.evento_actual=p("filter")(e.USER.eventos,{id:e.USER.evento_selected_id})[0]}catch(t){return e.evento_actual={}}finally{i.$broadcast("cambia_evento_actual")}}},e.el_evento_actual(),e.set_user_event=function(t){return n.one("eventos/set-user-event").customPUT({evento_id:t.id}).then(function(n){return console.log("Evento cambiado: ",n),e.USER.evento_selected_id=t.id,e.el_evento_actual(),l.success("Evento actual cambiado por "+t.alias),i.$broadcast("cambio_evento_user")},function(e){return console.log("Error conectando!",e),l.warning("No se pudo cambiar el evento actual.")})},e.logout=function(){return f.desloguear(),a.logout(),e.in_evento_actual={},n.one("login/logout").customPUT().then(function(e){return console.log("Desconectado con éxito: ",e),location.reload(!0)},function(e){return console.log("Error desconectando!",e),location.reload(!0)})},e.traerEventos=function(){return n.all("eventos").getList().then(function(t){return e.USER.eventos=t,e.el_evento_actual()},function(e){return console.log("No se trajeron los eventos.")})},i.$on("logueado:yo:agregado_a_arrays",function(t,n){return e.USER.categsel=n.categsel}),i.$on("me_desloguearon",function(t,n){return e.logout()}),f.on("enter",function(e){if(e.usuario)return n.one("qr/validar-usuario").customPUT({user_id:e.usuario.id,token_auth:e.from_token}).then(function(e){if(e.token)return m.usuarios_all=[],o.put("xtoken",e.token),t.defaults.headers.common.Authorization="Bearer "+o.get("xtoken"),location.reload(!0)},function(e){return l.warning("No se pudo ingresar"),console.log("No se pudo ingresar ",e)})})}])}.call(this),function(){angular.module("WissenSystem").directive("chatContainerDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}panel/chatContainerDir.tpl.html`,scope:!1,controller:"ChatContainerCtrl"}}]).controller("ChatContainerCtrl",["$scope","App","MySocket","SocketClientes","$rootScope",function(e,t,n,r,o){return e.imagesPath=t.images,e.SocketClientes=r,e.enviarMensaje=function(){if(""!==e.newMensaje)return n.send_email(e.newMensaje),e.newMensaje=""},o.$on("llegaCorrespondencia",function(){return e.$apply()})}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("panel.eventos",{url:"^/eventos",views:{contenido_panel:{templateUrl:`${e.views}eventos/eventos.tpl.html`,controller:"EventosCtrl"},data:{pageTitle:"Eventos"}}}).state("panel.eventos_user",{url:"/eventos_user",templateUrl:"views/eventos/eventos_user.tpl.html",controller:"EventosUserCtrl"}),n.translations("EN",{EVENTS_TITLE:"Events",CREAR_EVENTO:"Create event"}).translations("ES",{EVENTS_TITLE:"Eventos"})}])}.call(this),function(){angular.module("WissenSystem").controller("EventosCtrl",["$scope","Restangular","$uibModal","$filter","App","toastr",function(e,t,n,r,o,i){return e.newEvent={with_pay:!1,es_idioma_unico:!0},e.currentEvent={idiomas_extras:[]},e.creando=!1,e.editando=!1,e.guardando_nuevo=!1,e.guardando_edit=!1,e.guardar_evento=function(){return e.guardando_nuevo=!0,t.one("eventos/store").customPOST(e.newEvent).then(function(t){return t.idiomas_extras=e.newEvent.idiomas_extras,e.USER.eventos.push(t),e.guardando_nuevo=!1,e.creando=!1,i.success("Evento guardado con éxito.","Creado"),e.newEvent={with_pay:!1}},function(t){return console.log("No se pudo guardar el evento",t),i.warning("No se pudo crear evento.","Problema"),e.guardando_nuevo=!1}),e.el_evento_actual()},e.setActual=(n=>t.one("eventos/set-actual").customPUT(n).then(function(t){var r,o,a;for(i.success("Ahora el Evento es actual."),r=0,o=(a=e.USER.eventos).length;r<o;r++)a[r].actual=!1;return n.actual=!0},function(e){return i.warning("No se pudo establecer como actual. Actualice","Problema")})),e.update_evento=function(){return e.guardando_edit=!0,console.log(e.currentEvent.gran_final),t.one("eventos/update").customPUT(e.currentEvent).then(function(t){return console.log("Evento editado",t),e.guardando_edit=!1,i.success("Evento actualizado con éxito.")},function(t){return console.log("El Evento no se pudo editar",t),i.warning("No se pudo editar evento.","Problema"),e.guardando_edit=!1}),e.el_evento_actual()},e.crear_evento=function(){return e.editando=!1,e.creando=!0},e.cancelar_newevento=function(){return e.creando=!1},e.cancelar_currentEvento=function(){return e.editando=!1},e.editarEvento=function(t){return e.editando=!0,e.currentEvent=t,console.log("currentEvent",t)},e.quitandoIdiomas=function(n,r){var o;return console.log(n),o={evento_id:e.currentEvent.id,idioma_id:n.id},t.one("idiomas/destroy").customDELETE("",o).then(function(e){return i.success("Idioma quitado con éxito.","Eliminado")},function(e){return i.warning("No se pudo eliminar idioma.","Problema"),console.log("Error eliminando idioma: ",e)}),e.el_evento_actual()},e.idiomasSelect=function(n,r){var o;return console.log(n,e.currentEvent.idiomas_extras),o={evento_id:e.currentEvent.id,idioma_id:n.id},t.one("idiomas/store").customPOST(o).then(function(e){return i.success("Idioma agregado con éxito.","Añadido")},function(e){return i.warning("No se pudo agregar idioma.","Problema"),console.log("Error agregando idioma: ",e)}),e.el_evento_actual()},e.eliminarEvento=function(t){return n.open({templateUrl:o.views+"eventos/removeEvento.tpl.html",controller:"RemoveEventoCtrl",resolve:{elemento:function(){return t}}}).result.then(function(t){return e.USER.eventos=r("filter")(e.USER.eventos,{id:"!"+t.id}),console.log("Resultado del modal: ",t)}),e.el_evento_actual()},e.traerEventos()}]).controller("RemoveEventoCtrl",["$scope","$uibModalInstance","elemento","Restangular","toastr",function(e,t,n,r,o){return e.elemento=n,e.ok=function(){return r.all("eventos/destroy").customDELETE(n.id).then(function(e){return o.success("Evento eliminado con éxito.","Eliminado"),t.close(n)},function(e){return o.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("cancel")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("EventosUserCtrl",["$scope","Restangular",function(e,t){return console.log("EventosUserCtrl")}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("panel.entidades",{url:"^/entidades",views:{contenido_panel:{templateUrl:`${e.views}entidades/entidades.tpl.html`,controller:"EntidadesCtrl"}},data:{pageTitle:"Entidades"}}),n.translations("EN",{ENTIDADES_TITLE:"Entities"}).translations("ES",{ENTIDADES_TITLE:"Entidades"})}])}.call(this),function(){angular.module("WissenSystem").controller("EntidadesCtrl",["$scope","Restangular","uiGridConstants","App","$filter","$uibModal","toastr",function(e,t,n,r,o,i,a){var s,c;e.imgSystemPath=r.imgSystemPath,e.perfilPath=r.perfilPath,e.creando=!1,e.editando=!1,s='<a tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',c='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',c=e.hasRoleOrPerm(["Admin"])?c:"",e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{name:"edit",displayName:"Edit",width:70,enableSorting:!1,enableFiltering:!1,cellTemplate:s+c,enableCellEdit:!1,enableColumnMenu:!1},{field:"logo_nombre",displayName:"Logo",cellTemplate:'<img width="35px" ng-src="{{grid.appScope.perfilPath + grid.getCellValue(row, col)}}">',width:40},{field:"nombre",filter:{condition:n.filter.CONTAINS},enableHiding:!1},{field:"alias",width:70,filter:{condition:n.filter.CONTAINS},displayName:"Alias"},{field:"lider_nombre",displayName:"Lider",filter:{condition:n.filter.CONTAINS}}],multiSelect:!1,onRegisterApi:function(n){return e.gridApi=n,n.edit.on.afterCellEdit(e,function(n,r,o,i){return o!==i&&t.one("entidades/update").customPUT(n).then(function(e){return a.success("Entidad actualizada con éxito","Actualizado")},function(e){return a.error("Cambio no guardado","Error")}),e.$apply()})}},t.all("entidades").getList().then(function(t){return e.gridOptions.data=t}),t.all("imagenes").getList().then(function(t){return e.imagenes=t}),e.editar=function(t){return e.creando=!1,e.editando=!0,e.currentEntidad=t,e.currentEntidad.logo={id:t.logo_id,nombre:t.logo_nombre,publica:t.publica}},e.eliminar=function(t){return i.open({templateUrl:r.views+"eventos/removeEvento.tpl.html",controller:"RemoveEntidadCtrl",resolve:{elemento:function(){return t}}}).result.then(function(t){return e.gridOptions.data=o("filter")(e.gridOptions.data,{id:"!"+t.id}),console.log("Resultado del modal: ",t)})},e.crearNuevo=function(){return e.creando=!0,e.editando=!1},e.cancelarNuevo=function(){return e.creando=!1,e.guardando=!1},e.cancelarEdit=function(){return e.editando=!1},e.guardando=!1,e.guardar_nuevo=function(){return e.guardando=!0,t.one("entidades/store").customPOST(e.newEntidad).then(function(t){return e.gridOptions.data.push(t),e.guardando=!1,e.creando=!1,a.success("Entidad guardada con éxito.","Creado"),e.newEntidad={nombre:"",lider_nombre:""}},function(t){return console.log("No se pudo guardar el entidad",t),a.warning("No se pudo crear entidad.","Problema"),e.guardando=!1})},e.guardando_cambios=!1,e.guardar_cambios=function(){return e.guardando_cambios=!0,e.currentEntidad.logo_id=e.currentEntidad.logo.id,t.one("entidades/update").customPUT(e.currentEntidad).then(function(t){return e.guardando_cambios=!1,e.editando=!1,a.success("Entidad guardada con éxito.","Guardada"),e.newEntidad={nombre:"",lider_nombre:""}},function(t){return console.log("No se pudo guardar entidad",t),a.warning("No se pudo crear entidad.","Problema"),e.guardando_cambios=!1})}}]).controller("RemoveEntidadCtrl",["$scope","$uibModalInstance","elemento","Restangular","toastr",function(e,t,n,r,o){return e.elemento=n,e.ok=function(){return r.all("entidades/destroy").customDELETE(n.id).then(function(e){return o.success("Entidad eliminada con éxito.","Eliminado"),t.close(n)},function(e){return o.warning("No se pudo eliminar elemento.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("cancel")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("panel.evaluaciones",{url:"^/evaluaciones",views:{contenido_panel:{templateUrl:`${e.views}evaluaciones/evaluaciones.tpl.html`,controller:"EvaluacionesCtrl"}},data:{pageTitle:"Evaluaciones"}}),n.translations("EN",{ENTIDADES_TITLE:"Tests"}).translations("ES",{ENTIDADES_TITLE:"Evaluaciones"})}])}.call(this),function(){angular.module("WissenSystem").controller("EvaluacionesCtrl",["$scope","Restangular","App","toastr",function(e,t,n,r){e.comprobar_evento_actual=function(){return e.evento_actual?e.evento_actual.idioma_principal_id?e.idioma={selected:e.evento_actual.idioma_principal_id}:void 0:r.warning("Pimero debes crear o seleccionar un evento actual")},e.comprobar_evento_actual(),e.$on("cambio_evento_user",function(){return e.comprobar_evento_actual()}),e.$on("cambia_evento_actual",function(){return e.comprobar_evento_actual()}),e.imgSystemPath=n.imgSystemPath,e.perfilPath=n.perfilPath,e.creando=!1,e.editando=!1,e.newEvaluacion={},e.currentEvalua={},e.categorias_king=[],t.all("categorias/categorias-usuario").getList().then(function(t){return e.categorias_king=t}),e.crearNuevo=function(){return e.creando=!0},e.cancelarNuevo=function(){return e.creando=!1},e.cancelarEdit=function(){return e.editando=!1},e.guardando=!1,e.guardarNuevo=function(){return e.guardando=!0,t.one("evaluaciones/store").customPOST(e.newEvaluacion).then(function(t){return e.evaluaciones.push(t),console.log(e.evaluaciones),e.guardando=!1,e.creando=!1,r.success("Evaluación guardada con éxito"),console.log("Evaluación guardada con éxito",t)},function(t){return r.warning("Evaluación guardada con éxito"),e.guardando=!1,console.log("No se pudo guardar la evaluación",t)})}}])}.call(this),function(){angular.module("WissenSystem").directive("gridEvaluaciones",["App",function(e){return{restrict:"E",templateUrl:`${e.views}evaluaciones/gridEvaluacionesDir.tpl.html`,scope:{currenteval:"=",evaluaciones:"=",categoriasking:"=",idioma:"="},link:function(e,t,n){},controller:"GridEvaluacionesCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("GridEvaluacionesCtrl",["$scope","Restangular","uiGridConstants","$uibModal","$filter","App","toastr",function(e,t,n,r,o,i,a){var s,c,u,l;s='<a tooltip="Editar" tooltip-placement="left" class="btn btn-xs btn-info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',c='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-xs btn-danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',l='<span ng-bind="row.entity.categoria_id | nombreCategoria:grid.appScope.categoriasking:grid.appScope.idioma"></span>',u='<md-checkbox ng-true-value="1" ng-false-value="0" ng-model="row.entity.actual" ng-change="grid.appScope.setActual(row.entity)" aria-label="Actual" ng-disable="row.entity.actualizando" style="margin-top: 0px;">Actual</md-checkbox>',e.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:60,enableCellEdit:!1,enableColumnMenu:!1},{name:"edit",displayName:"Edit",width:80,enableSorting:!1,enableFiltering:!1,cellTemplate:s+c,enableCellEdit:!1,enableColumnMenu:!1},{field:"descripcion",displayName:"Descripción",filter:{condition:n.filter.CONTAINS},enableHiding:!1},{field:"categoria_id",displayName:"Categoría",filter:{condition:n.filter.CONTAINS},cellTemplate:l,enableCellEdit:!1},{field:"actual",displayName:"Actual",width:90,filter:{condition:n.filter.CONTAINS},cellTemplate:u,enableCellEdit:!1}],multiSelect:!1,onRegisterApi:function(n){return e.gridApi=n,n.edit.on.afterCellEdit(e,function(n,r,o,i){return console.log("Fila editada, ",n," Column:",r," newValue:"+o+" oldValue:"+i),o!==i&&t.one("evaluaciones/update").customPUT(n).then(function(e){return a.success("Evaluaciones actualizada con éxito","Actualizado")},function(e){return a.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",e)}),e.$apply()})}},t.all("evaluaciones").getList().then(function(t){return e.evaluaciones=t,e.gridOptions.data=e.evaluaciones}),e.setActual=function(n){return n.actualizando=!0,console.log(n),t.one("evaluaciones/set-actual").customPUT(n).then(function(t){var r,i,s,c,u;for(a.success("Actualizado con éxito","Actualizado"),n.actualizando=!1,u=[],s=0,c=(r=o("filter")(e.evaluaciones,{categoria_id:n.categoria_id})).length;s<c;s++)(i=r[s]).id!==n.id?u.push(i.actual=0):u.push(void 0);return u},function(e){return a.warning("No se cambió como actual o no"),console.log("No estableció como actual o no",e),n.actualizando=!1})},e.editar=function(t){return e.$parent.creando=!1,e.$parent.editando=!0,e.$parent.currentEvaluacion=t},e.eliminar=function(t){return r.open({templateUrl:i.views+"evaluaciones/removeEvaluacion.tpl.html",controller:"RemoveEvaluacionCtrl",resolve:{elemento:function(){return t},categoriasking:function(){return e.categoriasking}}}).result.then(function(t){return e.evaluaciones=o("filter")(e.evaluaciones,{id:"!"+t.id}),console.log("Resultado del modal: ",t)})}}]).controller("RemoveEvaluacionCtrl",["$scope","$uibModalInstance","elemento","categoriasking","Restangular","toastr",function(e,t,n,r,o,i){return e.elemento=n,e.categoriasking=r,console.log("elemento",n,r),e.ok=function(){return o.all("evaluaciones/destroy").customDELETE(n.id).then(function(e){return i.success("Evaluacion eliminada con éxito.","Eliminado"),t.close(n)},function(e){return i.warning("No se pudo eliminar evaluación.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").config(["$stateProvider","App","$translateProvider",function(e,t,n){return e.state("panel.preguntas",{url:"^/preguntas",views:{contenido_panel:{templateUrl:`${t.views}preguntas/preguntas.tpl.html`,controller:"PreguntasCtrl"}},data:{pageTitle:"Preguntas"}}),n.translations("EN",{BUSCAR_PLACEHOLDER:"Find",TIP_BTN_NUEVA_PREGUNTA:"Create a new question",BTN_NUEVA_PREGUNTA:"New question"}).translations("ES",{BUSCAR_PLACEHOLDER:"Buscar",TIP_BTN_NUEVA_PREGUNTA:"Crear una nueva pregunta",BTN_NUEVA_PREGUNTA:"Nueva pregunta"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("PreguntasCtrl",["$scope","App","$http","Restangular","$state","$cookies","$rootScope","toastr","preguntasServ","$filter","$timeout","$uibModal","SocketData",function(e,t,n,r,o,i,a,s,c,u,l,d,p){return e.pg_preguntas=[],e.evalu_seleccionada={id:-1},e.SocketData=p,e.creando=!1,e.editando=!1,e.editandoContenido=!1,e.inicializado=!1,e.preguntaEdit={},e.contenidoEdit={},e.showDetail=!1,e.showSelectables=!1,e.showOptions=!1,e.showCorrects=!1,e.categoria=0,e.evaluacion_id=0,e.preguntas_evaluacion=[],e.categorias=[],e.comprobar_evento_actual=function(){return e.evento_actual?e.evento_actual.idioma_principal_id?e.idiomaPreg={selected:e.evento_actual.idioma_principal_id}:void 0:s.warning("Pimero debes crear o seleccionar un evento actual")},e.comprobar_evento_actual(),e.$on("cambio_evento_user",function(){return e.comprobar_evento_actual()}),e.$on("cambia_evento_actual",function(){return e.comprobar_evento_actual()}),e.traerDatos=function(){return r.all("categorias/categorias-usuario").getList().then(function(t){if(e.categorias=t,e.categorias.length>0)return null===localStorage.getItem("selected_categpreg")?(localStorage.setItem("selected_categpreg",t[0].id),e.categoria=t[0].id):e.categoria=localStorage.getItem("selected_categpreg"),e.traerEvaluaciones(),e.traerPreguntas()},function(e){return console.log("No se trajeron las categorías ",e)})},e.traerDatos(),e.traerEvaluaciones=function(t){return r.all("evaluaciones").getList({categoria_id:e.categoria}).then(function(n){var r,o,i,a,s;if(e.evaluaciones=n,t){for(s=[],o=0,i=(a=e.evaluaciones).length;o<i;o++)(r=a[o]).id===e.evalu_seleccionada.id?(e.evalu_seleccionada=r,s.push(e.selectEvaluacion(r))):s.push(void 0);return s}},function(e){return console.log("No se trajeron las evaluaciones ",e)})},e.traerPreguntas=function(){return r.all("preguntas").getList({categoria_id:e.categoria,idioma_id:e.idiomaPreg.selected}).then(function(t){return e.pg_preguntas=t,e.pg_preguntas=u("pregsByCatsAndEvaluacion")(e.pg_preguntas,e.categoria,e.preguntas_evaluacion,e.evaluacion_id),e.inicializado=!0},function(t){return console.log("Pailas la promesa de las preguntas ",t),e.inicializado=!0})},e.filtrarPreguntas=function(){return e.pg_preguntas=u("pregsByCatsAndEvaluacion")(e.pg_preguntas,e.categoria,e.preguntas_evaluacion,e.evaluacion_id)},e.cambiarRutaImagenes=function(){return d.open({templateUrl:t.views+"preguntas/cambiarRutaImagenes.tpl.html",controller:"CambiarRutaImagenes"}).result.then(function(e){return console.log("Rutas Cambiadas")})},e.traerPreguntasYEvaluaciones=function(){return localStorage.setItem("selected_categpreg",e.categoria),e.traerPreguntas(),e.traerEvaluaciones()},e.traerPreguntasDeEvaluacion=function(){var t;return"sin_asignar"===e.evaluacion_id?r.all("pregunta_evaluacion/solo-sin-asignar").getList({categoria_id:e.categoria}).then(function(t){return e.pg_preguntas=t},function(t){return console.log("No se trajo las preguntas sin asignar ",t),e.inicializado=!0}):(e.traerPreguntas(),(t=u("filter")(e.evaluaciones,{id:e.evaluacion_id})).length>0&&(e.preguntas_evaluacion=t[0].preguntas_evaluacion),console.log("$scope.evaluacion",e.evaluacion_id,e.preguntas_evaluacion))},e.selectEvaluacion=function(t,n){var r,o,i,a;for(e.evalu_seleccionada=t,o=0,i=(a=e.evaluaciones).length;o<i;o++)a[o].selected=!1;if(t.selected=!0,(r=u("filter")(e.evaluaciones,{id:t.id},!0)).length>0)return e.preguntas_evaluacion2=r[0].preguntas_evaluacion},e.asignarPreguntasRandom=function(){return d.open({templateUrl:t.views+"preguntas/asignarPreguntasRandom.tpl.html",controller:"AsignarPreguntasRandom",resolve:{evaluacion:function(){return e.evalu_seleccionada}}}).result.then(function(t){return e.traerEvaluaciones(e.evalu_seleccionada),console.log("Asignado")})},e.eliminarPreguntas=function(){var n,r,o,i,a;for(a=[],n=0,r=(i=e.pg_preguntas).length;n<r;n++)(o=i[n]).seleccionada&&a.push(o);return d.open({templateUrl:t.views+"preguntas/removePreguntas.tpl.html",controller:"RemovePreguntasCtrl",resolve:{preguntas:function(){return a}}}).result.then(function(t){var n,r,o,i,s,c,l;for(n=r=0,i=(c=e.pg_preguntas).length;r<i;n=++r)for(c[n],o=0,s=a.length;o<s;o++)l=a[o],e.pg_preguntas=u("filter")(e.pg_preguntas,{pg_id:"!"+l.pg_id});return e.filtrarPreguntas()})},e.asignarPreguntasAEvaluacion=function(){var n,r,o,i,a;for(a=[],n=0,r=(i=e.pg_preguntas).length;n<r;n++)(o=i[n]).seleccionada&&a.push(o);return d.open({templateUrl:t.views+"preguntas/asignarPreguntas.tpl.html",controller:"AsignarPreguntasAEvaluacionCtrl",resolve:{preguntas:function(){return a},evaluaciones:function(){return e.evaluaciones}}}).result.then(function(t){return e.traerEvaluaciones(),console.log("Resultado del modal: ",t)})},e.$on("finalizaEdicionPreg",function(e){}),e.$on("preguntaQuitada",function(t,n){return e.preguntas_evaluacion2=u("filter")(e.preguntas_evaluacion2,{id:"!"+n}),console.log("Recibido quitada",n)}),e.$on("grupoEliminado",function(t,n){return e.pg_preguntas=u("filter")(e.pg_preguntas,function(e,t){return!!e.tipo_pregunta||e.id!==n.id})})}]).controller("AsignarPreguntasRandom",["$scope","$uibModalInstance","Restangular","toastr","evaluacion",function(e,t,n,r,o){return e.examenes=[],e.pregNoAsignadas=!1,e.cantPregRandom=3,e.cambiando=!1,n.all("pregunta_evaluacion/examenes-de-evaluacion").getList({evaluacion_id:o.id}).then(function(t){return e.examenes=t},function(e){return r.warning("No se trajeron las preguntas con imágenes.","Problema")}),e.ok=function(){var i;return e.cambiando=!0,i={cantPregRandom:e.cantPregRandom,evaluacion_id:o.id,categoria_id:o.categoria_id,pregNoAsignadas:e.pregNoAsignadas},n.one("pregunta_evaluacion/asignar-aleatoriamente").customPUT(i).then(function(e){return r.success("Preguntas asignadas."),t.close(i)},function(t){return r.warning("No se pudo asignar preguntas.","Problema"),console.log("No se pudo asignar preguntas: ",t),e.cambiando=!1})},e.cancel=function(){return t.dismiss("cancel")}}]).controller("CambiarRutaImagenes",["$scope","$uibModalInstance","Restangular","toastr",function(e,t,n,r){return e.ruta_anterior="http://192.168.0.10",e.ruta_nueva="http://"+localStorage.getItem("dominio"),n.all("preguntas/con-imagenes").getList().then(function(t){return e.preguntas=t},function(e){return r.warning("No se trajeron las preguntas con imágenes.","Problema")}),e.ok=function(){var o;return e.cambiando=!0,o={ruta_anterior:e.ruta_anterior,ruta_nueva:e.ruta_nueva},n.one("perfiles/cambiar-ruta-imagenes").customPUT(o).then(function(e){return r.success("Rutas cambiadas."),t.close(o)},function(t){return r.warning("No se pudo cambiar rutas.","Problema"),console.log("Error cambiando rutas: ",t),e.cambiando=!1})},e.cancel=function(){return t.dismiss("cancel")}}]).filter("pregsByCatsAndEvaluacion",["$filter",function(e){return function(t,n,r,o){var i,a,s,c,u,l;for(i=[],angular.forEach(t,function(e){return i.push(e)}),l=[],s=0,c=i.length;s<c;s++)u=i[s],parseFloat(u.categoria_id)===parseFloat(n)&&(o&&0!==parseFloat(o)?(a=!1,(a=u.tipo_pregunta?e("filter")(r,{pregunta_id:u.pg_id},!0):e("filter")(r,{grupo_pregs_id:u.pg_id},!0))&&a.length>0&&(u.pregunta_eval_id=a[0].id,u.orden=a[0].orden,l.push(u))):l.push(u));return l}}]).controller("RemovePreguntasCtrl",["$scope","$uibModalInstance","preguntas","Restangular","toastr",function(e,t,n,r,o){return e.preguntas=n,e.ok=function(){return r.all("preguntas/destroy-varias").customPUT({preguntas:n}).then(function(e){return o.success("Preguntas eliminadas con éxito.","Eliminadas")},function(e){return o.warning("No se pudo eliminar preguntas.","Problema"),console.log("Error eliminando preguntas: ",e)}),t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}]).controller("AsignarPreguntasAEvaluacionCtrl",["$scope","$uibModalInstance","preguntas","evaluaciones","Restangular","toastr","$filter",function(e,t,n,r,o,i,a){return e.preguntas=n,e.evaluaciones=r,e.asignando=!1,e.selected=!1,e.selected=r[r.length-1].id,e.ok=function(){var s;return e.asignando=!0,s={preguntas:n,evaluacion_id:e.selected},o.all("pregunta_evaluacion/asignar-preguntas").customPUT(s).then(function(n){var o,s,c,u,l;for(i.success("Preguntas asignadas con éxito."),e.asignando=!1,o=a("filter")(r,{id:e.selected})[0],s=0,c=(l=e.preguntas).length;s<c;s++)u=l[s],o.preguntas_evaluacion.push(u);return t.close(n)},function(t){return i.warning("No se pudo asignar las preguntas.","Problema"),console.log("Error asignando preguntas: ",t),e.asignando=!1})},e.cancel=function(){return t.dismiss("cancel")}}]).controller("CambiarCategoriaAPreguntasCtrl",["$scope","$uibModalInstance","pregunta","categorias","idiomaPreg","Restangular","toastr","$filter",function(e,t,n,r,o,i,a,s){return e.categorias=r,e.pregunta=n,e.idiomaPreg=o,e.cambiando=!1,e.categoria=!1,e.categoria=r[r.length-1].id,e.ok=function(){var r;return e.cambiando=!0,r={pregunta_id:n.pg_id,categoria_id:e.categoria},i.all("preguntas/cambiar-categoria").customPUT(r).then(function(n){return a.success("Pregunta cambiada de categoría."),e.cambiando=!1,t.close(r.categoria_id)},function(t){return a.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",t),e.cambiando=!1})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPreguntaCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","$filter",function(e,t,n,r,o,i,a,s){e.idiomaPreg=[e.$parent.preguntaEdit.idioma_id],e.editorOptions={inlineMode:!0,placeholder:""},e.mostrarConfiguracion=!0,e.mostrarConfig=function(){return e.mostrarConfiguracion=!e.mostrarConfiguracion},e.cerrarEdicion=function(){return e.$parent.editando=!1},e.finalizarEdicion=function(){return n.one("preguntas/update").customPUT(e.preguntaEdit).then(function(t){var n,r,o,i;for(e.$parent.editando=!1,r=n=0,o=(i=e.pg_preguntas).length;n<o;r=++n)i[r].pg_id===t.pg_id&&e.pg_preguntas.splice(r,1,t);return e.filtrarPreguntas(),a.success("Cambios guardados con éxito")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")})},e.aplicarCambios=function(){return n.one("preguntas/update").customPUT(e.preguntaEdit).then(function(t){var n,r,o,i;for(r=n=0,o=(i=e.pg_preguntas).length;n<o;r=++n)i[r].pg_id===t.pg_id&&e.pg_preguntas.splice(r,1,t);return e.filtrarPreguntas(),a.success("Cambios guardados con éxito")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")})},e.cambiaTipoPregunta=function(){return console.log("Cambia el tipo: ",e.preguntaEdit.tipo_pregunta),e.$broadcast("cambiaTipoPregunta")},n.all("preguntas/traducidas").getList({pregunta_id:e.preguntaEdit.pg_id}).then(function(t){var n,r;for(n=0,r=t.length;n<r;n++)t[n],(t.pg_traduc_id=e.preguntaEdit.pg_traduc_id)&&(t.opciones=e.preguntaEdit.opciones,t.enunciado=e.preguntaEdit.enunciado);return e.preguntaEdit.preguntas_traducidas=t},function(e){return console.log("No se trajeron las traducciones de la pregunta",e),a.warning("No se trajeron las traducciones de la pregunta","Problema")})}])}.call(this),function(){angular.module("WissenSystem").controller("PreguntaEnPantallaCtrl",["$scope","$http","Restangular","$state","MySocket","$rootScope","AuthService","Perfil","App","SocketData","$filter",function(e,t,n,r,o,i,a,s,c,u,l){e.MySocket=o,e.SocketData=u,e.indexChar=function(e){return String.fromCharCode(65+e)},e.opcion_seleccionada=-1,e.selec_opc_in_question=function(t,n,r){return angular.forEach(t.opciones,function(e){return e.elegida=!1}),n.elegida=!0,e.opcion_seleccionada=r,o.selec_opc_in_question(r)},e.sc_reveal_answer=function(){if(!(e.opcion_seleccionada<0))return o.sc_reveal_answer();alert("Primero debes elegir opción.")},o.on("selec_opc_in_question",function(t){var n,r,o,i,a,s;for(e.opcion_seleccionada=t.opcion,s=[],r=n=0,o=(a=u.config.pregunta.opciones).length;n<o;r=++n)(i=a[r]).revelada_acertada=!1,i.revelada_no_acertada=!1,t.opcion===r?s.push(i.elegida=!0):s.push(i.elegida=!1);return s}),o.on("sc_reveal_answer",function(t){var n,o,a,s,c,l,d;for(d=[],a=o=0,s=(l=u.config.pregunta.opciones).length;o<s;a=++o)(c=l[a]).is_correct?a===e.opcion_seleccionada?(c.revelada_acertada=!0,c.revelada_no_acertada=!1,!i.silenciar_todo&&r.is("panel.control")?(n=new Audio("/sounds/Revelada_correcta.wav"),d.push(n.play())):d.push(void 0)):(c.revelada_acertada=!1,c.revelada_no_acertada=!0,!i.silenciar_todo&&r.is("panel.control")?(n=new Audio("/sounds/Revalada_incorrecta.wav"),d.push(n.play())):d.push(void 0)):d.push(void 0);return d})}])}.call(this),function(){angular.module("WissenSystem").directive("editPregunta",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/editPreguntaDir.tpl.html`,scope:!1,controller:"EditPreguntaCtrl"}}]).directive("preguntaEnPantalla",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/preguntaEnPantallaDir.tpl.html`,controller:"PreguntaEnPantallaCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("editPregTraducDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/editPregTraducDir.tpl.html`,scope:!0,controller:"EditPregTraducDirCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPregTraducDirCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","$filter","$uibModal","App",function(e,t,n,r,o,i,a,s,c,u){var l;return l="Agregar nueva opción",e.pregunta_traduc||(e.pregunta_traduc=e.preguntaEdit),e.inicializar=function(){var t,n,r,o;for(t=0,n=(o=e.pregunta_traduc.opciones).length;t<n;t++)if(o[t].nueva)return;return r={id:-1,definicion:l,nueva:!0,is_correct:!1},e.pregunta_traduc.opciones.push(r)},e.inicializar(),e.sortableOptions={"ui-floating":!0,update:function(t,r){var o,i,a,s,c,u,l,d;for(d=[],s=a=0,c=(l=e.pregunta_traduc.opciones).length;a<c;s=++a)-1!==(u=l[s]).id&&((i={})[""+u.id]=s,d.push(i));return o={pregunta_traduc_id:e.pregunta_traduc.id,sortHash:d},n.one("opciones/update-orden").customPUT(o).then(function(e){return console.log("Orden guardado")},function(e){return console.log("No se pudo guardar el orden",e)})}},e.addButtonNewOpcion=function(e,t){if(t.creando=!0,t.nueva)return t.definicion="Opción "+e.opciones.length,t.preg_traduc_id=e.pg_traduc_id,t.orden=e.opciones.length-1,1===e.opciones.length&&(t.is_correct=!0),n.one("opciones/store").customPOST(t).then(function(n){var r;return console.log("Opción guardada"),t.id=n.id,t.nueva=!1,t.creando=!1,r={id:-1,definicion:l,nueva:!0,is_correct:!1},e.opciones.push(r)},function(e){return console.log("No se pudo guardar la opción",e),t.definicion=l,t.creando=!1,a.warning("No se pudo crear nueva opción")})},e.setAsCorrect=function(t,n){if("Test"===e.preguntaEdit.tipo_pregunta&&(angular.forEach(t.opciones,function(e){return e.is_correct=0}),n.is_correct=1),"Multiple"===e.preguntaEdit.tipo_pregunta)return n.is_correct=1},e.deleteOption=function(e,t,r){return n.one("opciones/destroy",t.id).customDELETE().then(function(n){return console.log("Opción eliminada",n),e.opciones=s("filter")(e.opciones,{id:"!"+t.id})},function(e){return console.log("No se pudo eliminar la opción",e),a.warning("No se pudo eliminar la opción")})},e.$on("cambiaTipoPregunta",function(){var t,n,r,o,i,a,s;if("Test"===e.preguntaEdit.tipo_pregunta){for(s=[],n=0,r=(a=e.preguntaEdit.preguntas_traducidas).length;n<r;n++)i=a[n],t=0,s.push(function(){var e,n,r,a;for(a=[],e=0,n=(r=i.opciones).length;e<n;e++)(o=r[e]).is_correct?t>0?a.push(o.is_correct=0):a.push(t+=1):a.push(void 0);return a}());return s}}),e.misImagenes=function(){return c.open({templateUrl:u.views+"preguntas/misImagenes.tpl.html",controller:"MisImagenes",size:"lg",resolve:{resolved_user:function(){return e.USER}}}).result.then(function(e){return console.log("Fin mis imágenes")})}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","$location","$anchorScroll","$uibModal","$filter","MySocket",function(e,t,n,r,o,i,a,s,c,u,l){return e.enviar_pregunta_pantalla=function(t){var n,r,o,i,a,s;for(r={},o=0,i=(s=e.$parent.categorias).length;o<i;o++)(n=s[o]).id===parseInt(e.$parent.categoria)&&(r=n,(r=u("catsByIdioma")(n.categorias_traducidas,e.$parent.idiomaPreg.selected)).length>0&&(r=r[0]));return a={descrip_categ:r.descripcion,enunciado:t.enunciado,id:t.pg_id,idioma:r.idioma,idioma_id:t.idioma_id,nombre_categ:r.nombre,cantidad_pregs:-1,opciones:t.opciones,pregunta_id:t.pg_id,tipo_pregunta:t.tipo_pregunta},e.pregunta_mostrada=a,l.sc_show_question(-1,a)},e.opcion_seleccionada=-1,e.selec_opc_in_question=function(t){return e.opcion_seleccionada=t,l.selec_opc_in_question(t)},e.sc_reveal_answer=function(){var t,n,r,o,i,a,s;if(!(e.opcion_seleccionada<0)){for(l.sc_reveal_answer(),s=[],r=n=0,o=(a=e.pregunta_mostrada.opciones).length;n<o;r=++n)i=a[r],r===e.opcion_seleccionada?i.is_correct?(t=new Audio("/sounds/Revelada_correcta.wav"),s.push(t.play())):(t=new Audio("/sounds/Revalada_incorrecta.wav"),s.push(t.play())):s.push(void 0);return s}alert("Primero debes elegir opción.")},e.elegirOpcion=function(e,t){return angular.forEach(e.opciones,function(e){return e.elegida=!1}),t.elegida=!0},e.toggleMostrarAyuda=function(e){return e.mostrar_ayuda=!e.mostrar_ayuda},e.asignarAEvaluacion=function(n){return c.open({templateUrl:t.views+"preguntas/asignarPregunta.tpl.html",controller:"AsignarPreguntaCtrl",resolve:{pregunta:function(){return n},evaluaciones:function(){return e.evaluaciones}}}).result.then(function(e){return console.log("Resultado del modal: ",e)})},e.cambiarCategoria=function(n){return c.open({templateUrl:t.views+"preguntas/cambiarCategoria.tpl.html",controller:"CambiarCategoriaCtrl",resolve:{pregunta:function(){return n},categorias:function(){return e.$parent.categorias},idiomaPreg:function(){return e.$parent.idiomaPreg}}}).result.then(function(e){return n.categoria_id=e,console.log("Resultado del modal: ",e)})},e.indexChar=function(e){return String.fromCharCode(65+e)},e.editarPregunta=function(t){return e.$parent.$parent.preguntaEdit=t,e.$parent.$parent.editando=!0,a.hash("content"),s()},e.eliminarPregunta=function(n){return c.open({templateUrl:t.views+"preguntas/removePregunta.tpl.html",controller:"RemovePreguntaCtrl",resolve:{pregunta:function(){return n}}}).result.then(function(t){var n,r,o,i,a,s;for(n=[],o=r=0,i=(s=e.$parent.$parent.pg_preguntas).length;r<i;o=++r)(a=s[o]).pg_id!==t.pg_id&&n.push(a);return e.$parent.$parent.pg_preguntas=n,e.$parent.$parent.filtrarPreguntas()})},e.previewPregunta=function(e){return e.showDetail=!e.showDetail}}]).controller("RemovePreguntaCtrl",["$scope","$uibModalInstance","pregunta","Restangular","toastr",function(e,t,n,r,o){return e.pregunta=n,e.ok=function(){return r.all("preguntas/destroy/"+n.pg_id).remove().then(function(e){return o.success("Pregunta eliminada con éxito.","Eliminada")},function(e){return o.warning("No se pudo eliminar la pregunta.","Problema"),console.log("Error eliminando pregunta: ",e)}),t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}]).controller("AsignarPreguntaCtrl",["$scope","$uibModalInstance","pregunta","evaluaciones","Restangular","toastr","$filter",function(e,t,n,r,o,i,a){return e.pregunta=n,e.evaluaciones=r,e.asignando=!1,e.selected=!1,e.selected=r[r.length-1].id,e.ok=function(){var s;return e.asignando=!0,s={pregunta_id:n.pg_id,evaluacion_id:e.selected},o.all("pregunta_evaluacion/asignar-pregunta").customPUT(s).then(function(n){return i.success("Pregunta asignada con éxito."),e.asignando=!1,a("filter")(r,{id:e.selected})[0].preguntas_evaluacion.push(n),t.close(n)},function(t){return i.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",t),e.asignando=!1})},e.cancel=function(){return t.dismiss("cancel")}}]).controller("CambiarCategoriaCtrl",["$scope","$uibModalInstance","pregunta","categorias","idiomaPreg","Restangular","toastr","$filter",function(e,t,n,r,o,i,a,s){return e.categorias=r,e.pregunta=n,e.idiomaPreg=o,e.cambiando=!1,e.categoria=!1,e.categoria=r[r.length-1].id,e.ok=function(){var r;return e.cambiando=!0,r={pregunta_id:n.pg_id,categoria_id:e.categoria},i.all("preguntas/cambiar-categoria").customPUT(r).then(function(n){return a.success("Pregunta cambiada de categoría."),e.cambiando=!1,t.close(r.categoria_id)},function(t){return a.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",t),e.cambiando=!1})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaEvalCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","$mdToast","$uibModal","$filter","toastr",function(e,t,n,r,o,i,a,s,c,u){return e.indexChar=function(e){return String.fromCharCode(65+e)},e.actualizarOrdenPregEval=function(t){return n.all("pregunta_evaluacion/actualizar-orden-pregunta").customPUT({pg_id:t.pg_id,orden:t.orden_nuevo,pregunta_eval_id:t.pregunta_eval_id}).then(function(e){return u.success("Ordenado con éxito.")},function(t){return u.warning("No se pudo ordenar.","Problema"),console.log("Error ordenando pregunta: ",t),e.quitando=!1})},e.quitarPregunta=function(t){var r;return console.log("Aqui quito la preg",t.pregunta_eval_id,e.preguntasevaluacion2),e.quitando=!0,r={pregunta_id:t.id,evaluacion_id:e.selected,pregunta_eval_id:t.pregunta_eval_id},n.all("pregunta_evaluacion/quitar-pregunta").customPUT(r).then(function(n){return u.success("Pregunta quitada con éxito."),e.quitando=!1,e.$emit("preguntaQuitada",t.pregunta_eval_id)},function(t){return u.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",t),e.quitando=!1})}}])}.call(this),function(){angular.module("WissenSystem").directive("viewPregunta",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/viewPreguntaDir.tpl.html`,scope:!1,controller:"ViewPreguntaCtrl"}}]).directive("viewPreguntaEval",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/viewPreguntaEvalDir.tpl.html`,scope:{preguntaking:"="},controller:"ViewPreguntaEvalCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("AddPreguntaCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","$location","$anchorScroll","$mdToast","toastr",function(e,t,n,r,o,i,a,s,c,u){return e.creando=!1,e.addNewPregunta=function(){return e.creando=!0,n.one("preguntas/store").customPOST({categoria_id:e.categoria,idioma_id:e.idiomaPreg.selected}).then(function(t){return t.editando=!0,e.creando=!1,e.pg_preguntas.push(t),console.log("Pregunta añadida: ",e.pg_preguntas),e.preguntaEdit=t,e.editando=!0,a.hash("content"),s()},function(t){return console.log("Rechazada la nueva ",t),e.creando=!1,u.warning("No se creó pregunta","Problema")})},e.addNewPreguntaGrupo=function(){return e.creando=!0,n.one("grupo_preguntas/store").customPOST({categoria_id:e.categoria}).then(function(t){return t.editando=!0,e.creando=!1,e.pg_preguntas.push(t),console.log("Pregunta añadida: ",e.pg_preguntas)},function(t){return console.log("Rechazada la nueva ",t),e.creando=!1,u.warning("No se creó el grupo pregunta","Problema")})}}])}.call(this),function(){angular.module("WissenSystem").directive("addPregunta",["App",function(e){return{restrict:"E",templateUrl:`${e.views}preguntas/addPreguntaDir.tpl.html`,scope:!1,controller:"AddPreguntaCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("viewGrupo",["App",function(e){return{restrict:"E",templateUrl:`${e.views}grupopreg/viewGrupoDir.tpl.html`,scope:!1,controller:"ViewGrupoCtrl"}}]).directive("viewGrupoEval",["App",function(e){return{restrict:"E",templateUrl:`${e.views}grupopreg/viewGrupoEvalDir.tpl.html`,scope:{idiomapreg:"=",grupoking:"=",indice:"=",eventoactual:"=",idiomaactualselec:"=",evaluaciones:"=",preguntasevaluacion2:"="},link:function(e,t,n){},controller:"ViewGrupoEvalCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","$location","$anchorScroll","toastr","$uibModal","$filter",function(e,t,n,r,o,i,a,s,c,u,l){return e.creandoGrupoPreg=!1,e.addNewPregunta=function(t){return e.creandoGrupoPreg=!0,n.one("preguntas_agrupadas/store").customPOST({contenido_id:t.pg_traduc_id}).then(function(n){return n.editando=!0,e.creandoGrupoPreg=!1,t.pregs_agrupadas.push(n)},function(t){return console.log("Rechazada la nueva ",t),e.creandoGrupoPreg=!1,c.warning("No se creó pregunta","Problema")})},e.asignarAEvaluacion=function(n){return u.open({templateUrl:t.views+"grupopreg/asignarGrupo.tpl.html",controller:"AsignarGrupoCtrl",resolve:{pregunta:function(){return n},evaluaciones:function(){return e.evaluaciones}}}).result.then(function(e){return console.log("Resultado del modal: ",e)})},e.toggleMostrarAyuda=function(e){return e.mostrar_ayuda=!e.mostrar_ayuda},e.indexChar=function(e){return String.fromCharCode(65+e)},e.editarGrupo=function(t){return e.$parent.$parent.contenidoEdit=t,e.$parent.$parent.editandoContenido=!0,a.hash("content"),s()},e.eliminarContenido=function(n){return u.open({templateUrl:t.views+"grupopreg/removeGrupo.tpl.html",controller:"RemoveGrupoCtrl",resolve:{grupoking:function(){return n}}}).result.then(function(t){return e.$emit("grupoEliminado",t),console.log("Resultado del modal: ",t)})},e.editarPreguntaAgrup=function(e){return e.editando=!0},e.eliminarPreguntaAgrup=function(n,r){return u.open({templateUrl:t.views+"grupopreg/removePreguntaAgrup.tpl.html",controller:"RemovePreguntaAgrupCtrl",resolve:{preg_agrup:function(){return n}}}).result.then(function(t){return e.$emit("pregAgrupEliminada",t),console.log("Resultado del modal: ",n.id,l("filter")(r.pregs_agrupadas,{id:"!"+n.id},!0)),r.pregs_agrupadas=l("filter")(r.pregs_agrupadas,{id:"!"+n.id},!0)})},e.previewPreguntaAgrup=function(e){return e.showDetail=!e.showDetail}}]).controller("RemoveGrupoCtrl",["$scope","$uibModalInstance","grupoking","Restangular","toastr",function(e,t,n,r,o){return e.grupoking=n,e.ok=function(){return r.all("grupo_preguntas/destroy/"+n.pg_id).remove().then(function(e){return o.success("Pregunta eliminada con éxito.","Eliminada")},function(e){return o.warning("No se pudo eliminar la grupoking.","Problema"),console.log("Error eliminando grupoking: ",e)}),t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}]).controller("RemovePreguntaAgrupCtrl",["$scope","$uibModalInstance","preg_agrup","Restangular","toastr",function(e,t,n,r,o){return e.preg_agrup=n,e.ok=function(){return r.all("preguntas_agrupadas/destroy/"+n.id).remove().then(function(e){return o.success("Pregunta eliminada con éxito.","Eliminada")},function(e){return o.warning("No se pudo eliminar la preg_agrup.","Problema"),console.log("Error eliminando preg_agrup: ",e)}),t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}]).controller("AsignarGrupoCtrl",["$scope","$uibModalInstance","pregunta","evaluaciones","Restangular","toastr","$filter",function(e,t,n,r,o,i,a){return e.pregunta=n,e.evaluaciones=r,e.asignando=!1,e.selected=!1,e.ok=function(){var s;return e.asignando=!0,s={grupo_pregs_id:n.id,evaluacion_id:e.selected},o.all("pregunta_evaluacion/asignar-grupo").customPUT(s).then(function(n){return i.success("Grupo asignado con éxito."),e.asignando=!1,a("filter")(r,{id:e.selected})[0].preguntas_evaluacion.push(n),t.close(n)},function(t){return i.warning("No se pudo asignar el grupo.","Problema"),console.log("Error asignando el grupo: ",t),e.asignando=!1})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoEvalCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","toastr","$uibModal","$filter",function(e,t,n,r,o,i,a,s,c){return e.quitando=!1,e.quitarPregunta=function(t){var r,o;return e.quitando=!0,console.log(t,c("filter")(e.$parent.evaluaciones,{grupo_pregs_id:t.id})),o=c("filter")(e.$parent.evaluaciones,{grupo_pregs_id:t.id})[0],r={pregunta_id:t.id,evaluacion_id:o.evaluacion_id,pregunta_eval_id:t.pregunta_eval_id},n.all("pregunta_evaluacion/quitar-pregunta").customPUT(r).then(function(n){return a.success("Pregunta quitada con éxito."),e.quitando=!1,e.$emit("preguntaQuitada",t.pregunta_eval_id)},function(t){return a.warning("No se pudo quitar la pregunta grupo.","Problema"),console.log("Error quitando pregunta: ",t),e.quitando=!1})}}])}.call(this),function(){angular.module("WissenSystem").directive("editContenido",["App",function(e){return{restrict:"E",templateUrl:`${e.views}grupopreg/editContenidoDir.tpl.html`,scope:!1,controller:"EditContenidoCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditContenidoCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr",function(e,t,n,r,o,i,a){e.idiomaPreg=[e.contenidoEdit.idioma_id],e.editorOptions={inlineMode:!0,placeholder:""},e.cerrarEdicion=function(){return e.$parent.editandoContenido=!1,e.contenidoEdit={}},e.finalizarEdicion=function(){return n.one("contenido_traduc/update").customPUT(e.contenidoEdit).then(function(t){return e.$parent.editandoContenido=!1,e.contenidoEdit={},a.success("Cambios guardados con éxito")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")})},e.aplicarCambios=function(){return n.one("contenido_traduc/update").customPUT(e.contenidoEdit).then(function(e){return a.success("Cambios guardados")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")})},n.all("grupo_preguntas/traducidos").getList({grupo_id:e.contenidoEdit.pg_id}).then(function(t){var n,r;for(n=0,r=t.length;n<r;n++)t[n],(t.pg_traduc_id=e.contenidoEdit.pg_traduc_id)&&(t.enunciado=e.contenidoEdit.enunciado);return e.contenidoEdit.contenidos_traducidos=t},function(e){return console.log("No se trajeron las traducciones de la pregunta",e),a.warning("No se trajeron las traducciones de la pregunta","Problema")})}])}.call(this),function(){angular.module("WissenSystem").directive("editPreguntaAgrupada",["App",function(e){return{restrict:"E",templateUrl:`${e.views}grupopreg/editPreguntaAgrupDir.tpl.html`,scope:{pregagrup:"="},link:function(e,t,n){},controller:"EditPreguntaAgrupCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPreguntaAgrupCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","$filter",function(e,t,n,r,o,i,a,s){var c;e.editorOptions={inlineMode:!0,placeholder:""},c="Agregar nueva opción",e.inicializar=function(){var t,n,r,o;for(t=0,n=(o=e.pregagrup.opciones).length;t<n;t++)if(o[t].nueva)return;return r={id:-1,definicion:c,nueva:!0,is_correct:!1},e.pregagrup.opciones.push(r)},e.inicializar(),e.sortableOptions={"ui-floating":!0,update:function(t,r){var o,i,a,s,c,u,l,d;for(d=[],s=a=0,c=(l=e.pregagrup.opciones).length;a<c;s=++a)-1!==(u=l[s]).id&&((i={})[""+u.id]=s,d.push(i));return o={pregunta_agrupada_id:e.pregagrup.id,sortHash:d},n.one("opciones_agrupadas/update-orden").customPUT(o).then(function(e){return console.log("Orden guardado")},function(e){return console.log("No se pudo guardar el orden",e)})}},e.addButtonNewOpcion=function(e,t){if(t.creando=!0,t.nueva)return t.definicion="Opción "+e.opciones.length,t.preg_agrupada_id=e.id,t.orden=e.opciones.length-1,1===e.opciones.length&&(t.is_correct=!0),n.one("opciones_agrupadas/store").customPOST(t).then(function(n){var r;return console.log("Opción guardada"),t.id=n.id,t.nueva=!1,t.creando=!1,r={id:-1,definicion:c,nueva:!0,is_correct:!1},e.opciones.push(r)},function(e){return console.log("No se pudo guardar la opción",e),t.definicion=c,t.creando=!1,a.warning("No se pudo crear nueva opción")})},e.setAsCorrect=function(t,n){if("Test"===e.pregagrup.tipo_pregunta&&(angular.forEach(t.opciones,function(e){return e.is_correct=0}),n.is_correct=1),"Multiple"===e.pregagrup.tipo_pregunta)return n.is_correct=1},e.deleteOption=function(e,t,r){return n.one("opciones_agrupadas/destroy",t.id).customDELETE().then(function(n){return console.log("Opción eliminada",n),e.opciones=s("filter")(e.opciones,{id:"!"+t.id})},function(e){return console.log("No se pudo eliminar la opción",e),a.warning("No se pudo eliminar la opción")})},e.cerrarEdicion=function(){return e.pregagrup.editando=!1},e.mostrarConfiguracion=!0,e.mostrarConfig=function(){return e.mostrarConfiguracion=!e.mostrarConfiguracion},e.finalizarEdicion=function(){return e.$emit("finalizaEdicionPregAgrup"),n.one("preguntas_agrupadas/update").customPUT(e.pregagrup).then(function(t){return console.log("Cambios guardados",t),e.pregagrup.editando=!1,a.success("Cambios guardados con éxito")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},e.aplicarCambios=function(){return n.one("preguntas_agrupadas/update").customPUT(e.pregagrup).then(function(e){return console.log("Cambios guardados",e),a.success("Cambios guardados con éxito")},function(e){return console.log("No se pudo guardar los cambios",e),a.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},e.cambiaTipoPregunta=function(){var t,n,r,o,i,a;if(console.log("Cambia el tipo: ",e.pregagrup.tipo_pregunta),"Test"===e.pregagrup.tipo_pregunta){for(t=0,a=[],n=0,r=(i=e.pregagrup.opciones).length;n<r;n++)(o=i[n]).is_correct?t>0?a.push(o.is_correct=0):a.push(t+=1):a.push(void 0);return a}}}])}.call(this),function(){angular.module("WissenSystem").directive("iniciarDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}examen_respuesta/iniciarDir.tpl.html`,scope:!1,link:function(e,t,n){},controller:"IniciarCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("IniciarCtrl",["$scope","Restangular","toastr","$filter","AuthService","$state","$uibModal","App","SocketData","MySocket","Perfil","$rootScope","$interval",function(e,t,n,r,o,i,a,s,c,u,l,d,p){var g;return e.$state=i,e.categorias_king=[],e.examenes_puntajes=[],e.hasRoleOrPerm=o.hasRoleOrPerm,p.cancel(d.promiseInterval),e.traer_categorias_evento=function(){return t.all("categorias/categorias-evento").getList().then(function(t){return e.categorias_king=t},function(e){return n.warning("No se trajeron las categorias del evento","Problema"),console.log("No se trajo categorias ",e)}),t.all("informes/mis-examenes").getList().then(function(t){return e.examenes_puntajes=t},function(e){return n.warning("No se trajeron los resultados","Problema"),console.log("No se trajo resultados ",e)})},o.hasRoleOrPerm(["admin","profesor","tecnico"])?e.$parent.traerEventos():e.traer_categorias_evento(),e.iniciarExamen=function(t){return e.evento_actual.gran_final?(c.cambiar_mi_categsel(t.categoria_id,t.nombre,t.abrev),u.change_my_categ_selected(t.categoria_id,t.nombre,t.abrev)):a.open({templateUrl:s.views+"examen_respuesta/seguroIniciarCtrl.tpl.html",controller:"SeguroIniciarCtrl",resolve:{inscripcion:function(){return t},entidades:function(){return e.$parent.entidades}}}).result.then(function(e){return console.log("Resultado del modal: ",e)})},e.categoriaSelect=function(){return c.cliente(l.getResourceId())},e.iniciarProyeccion=function(){return i.go("proyectando")},g=d.$on("empezar_examen",function(r){var o,a,s,u,p,g;for(u={categoria_id:(o=c.cliente(l.getResourceId())).categsel_id},a=0,p=(g=e.USER.inscripciones).length;a<p;a++)(s=g[a]).categoria_id===o.categsel_id&&(u.inscripcion_id=s.id||s.rowid);return t.all("examenes_respuesta/iniciar").customPOST(u).then(function(e){return d.examen_actual=e,i.transitionTo("panel.examen_respuesta")},function(e){return n.warning("No se pudo iniciar el examen.","Problema"),console.log("Error creando el examen: ",e)})}),e.$on("$destroy",function(){return g()}),d.$on("categ_selected_change",function(){return e.$apply()})}])}.call(this),function(){angular.module("WissenSystem").controller("SeguroIniciarCtrl",["$scope","$uibModalInstance","inscripcion","Restangular","toastr","$filter","$state","$rootScope",function(e,t,n,r,o,i,a,s){return e.inscripcion=n,e.ok=function(){return e.asignando=!0,r.all("examenes_respuesta/iniciar").customPOST(n).then(function(e){return s.examen_actual=e,a.transitionTo("panel.examen_respuesta"),t.close(e)},function(e){return o.warning("No se pudo iniciar el examen.","Problema"),console.log("Error creando el examen: ",e)})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(e,t,n,r,o){e.state("panel.examen_respuesta",{url:"^/examen/:examen_respuesta_id",params:{examen_respuesta_id:{value:null}},views:{contenido_panel:{templateUrl:`${t.views}examen_respuesta/examenRespuesta.tpl.html`,controller:"ExamenRespuestaCtrl"}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}]},data:{pageTitle:"Examen"}}),o.translations("EN",{INICIO_MENU:"Home"}).translations("ES",{INICIO_MENU:"Inicio"})}])}.call(this),function(){angular.module("WissenSystem").controller("ExamenRespuestaCtrl",["$scope","Restangular","toastr","$filter","AuthService","$state","$uibModal","App","$rootScope","resolved_user","$interval","$timeout","MySocket","SocketData",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g){var f;return e.USER=u,e.imagesPath=s.images,e.pregunta_actual=0,e.pregunta_actual_porc=0,e.total_preguntas=0,e.waiting_question=!1,e.opcion_eligida="",e.cambiarTema("theme-one"),o.verificar_acceso(),l(function(){return p.emit("hasta_que_pregunta_esta_free")},5e3),e.incializar=function(){var o,a,s;return c.examen_actual?c.examen_actual.id||(console.log("Examen no válido",c.examen_actual),c.permiso_de_salir=!0,i.transitionTo("panel")):(console.log("No hay examen actual"),i.transitionTo("panel")),p.emit("set_my_examen_id",{examen_actual_id:c.examen_actual.examen_id}),e.categoria_traducida=r("categoriasTraducidas")([c.examen_actual.categoria],e.USER.idioma_main_id),e.categoria_traducida.length>0&&(e.categoria_traducida=e.categoria_traducida[0]),e.examen_actual=c.examen_actual,e.$on("respuesta_elegida",function(t,n,o){return o&&("incorrect"===o?e.opcion_eligida="Incorrecta":"correct"===o&&(e.opcion_eligida="Correcta")),e.USER.evento_actual.gran_final&&(g.config.info_evento.free_till_question&&g.config.info_evento.free_till_question>e.pregunta_actual?(e.waiting_question=!1,e.$broadcast("next_question")):e.waiting_question=!0),d(function(){return e.pregunta_actual=r("noPregActual")(e.examen_actual.preguntas),e.pregunta_actual_porc=e.pregunta_actual/e.total_preguntas*100,e.check_por_terminado()},500)}),e.$on("tiempo_preg_terminado",function(o){var i,a,s,u;return e.opcion_eligida="Incorrecta",e.waiting_question=!0,p.sc_answered("incorrect",c.tiempo),1===(a=r("preguntaActual")(e.examen_actual.preguntas)).length&&((s=r("porIdioma")(a[0].preguntas_traducidas,e.USER.idioma_main_id)).length>0?(s[0].opciones.length>0?s[0].opciones[0].respondida=!0:(n.warning("No hay opciones para esta pregunta"),console.log("No hay opciones para esta pregunta",s[0])),i={examen_actual_id:e.examen_actual.examen_id,pregunta_top_id:a[0].id,pregunta_sub_id:s[0].id,idioma_id:s[0].idioma_id,tipo_pregunta:a[0].tipo_pregunta,tiempo:c.tiempo},u="examenes_respuesta/responder-pregunta",t.all(u).customPUT(i).then(function(e){return console.log("Guardado el time out")},function(e){return n.warning("No se pudo guardar respuesta.","Problema"),console.log("No se pudo guardar respuesta: ",e)})):(n.warning("No hay traducción para esta pregunta"),console.log("No hay traducción para esta pregunta",a[0]))),e.pregunta_actual=r("noPregActual")(e.examen_actual.preguntas),e.pregunta_actual_porc=e.pregunta_actual/e.total_preguntas*100,e.check_por_terminado()}),e.$on("tiempo_exam_terminado",function(e){return c.permiso_de_salir=!0,i.go("panel")}),a=c.$on("next_question",function(t){if(!1!==e.waiting_question)return e.siguiente_pregunta()}),o=c.$on("goto_question_no",function(t,n){var o;if(!1!==e.waiting_question)return e.pregunta_actual=n,e.pregunta_actual_porc=e.pregunta_actual/e.total_preguntas*100,o=r("preguntaActual")(e.examen_actual.preguntas,n)[0],r("filter")(e.examen_actual.preguntas,{pregunta_id:o.pregunta_id})[0],e.waiting_question=!1,e.$broadcast("goto_question_no",n)}),s=c.$on("set_free_till_question",function(t,n){if(e.$apply(),g.config.info_evento.free_till_question&&g.config.info_evento.free_till_question>=e.pregunta_actual&&!1!==e.waiting_question)return e.siguiente_pregunta()}),e.$on("$destroy",function(){var e;window.onbeforeunload=void 0,a(),o(),s(),angular.isDefined(e)&&l.cancel(e)}),e.USER.evento_actual||(e.USER.evento_actual=e.evento_actual),e.tiempo_max=e.USER.evento_actual.gran_final?c.examen_actual.duracion_preg:60*c.examen_actual.duracion_exam,console.log(e.tiempo_max,"$scope.tiempo_max"),e.pregunta_actual=r("noPregActual")(e.examen_actual.preguntas),e.total_preguntas=r("cantPregsEvaluacion")(e.examen_actual.preguntas),e.pregunta_actual_porc=e.pregunta_actual/e.total_preguntas*100},e.siguiente_pregunta=function(){var t;return e.pregunta_actual=r("noPregActual")(e.examen_actual.preguntas),e.pregunta_actual_porc=e.pregunta_actual/e.total_preguntas*100,t=r("preguntaActual")(e.examen_actual.preguntas,e.pregunta_actual)[0],r("filter")(e.examen_actual.preguntas,{pregunta_id:t.pregunta_id})[0],e.waiting_question=!1,e.$broadcast("next_question")},i.params.examen_respuesta_id?(f={exa_resp_id:i.params.examen_respuesta_id},t.all("examenes_respuesta/continuar").customPUT(f).then(function(t){if(c.examen_actual=t,!e.check_por_terminado())return n.success("Continuamos el examen."),e.incializar()},function(e){return n.warning("No se pudo continuar el examen.","Problema"),console.log("Error continuando el examen: ",e)})):e.incializar(),e.check_por_terminado=function(){var o;return!(1!==(o=r("preguntaActual")(e.examen_actual.preguntas)).length||!o[0].terminado)&&(t.all("examenes_respuesta/set-terminado").customPUT({exa_id:e.examen_actual.examen_id}).then(function(e){return n.success("Examen terminado"),c.permiso_de_salir=!0,i.go("panel")},function(e){return n.warning("No se estableció como terminado.")}),!0)},e.finalizar_examen=function(){return console.log("Finalizar examen")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaExamenCtrl",["$scope","Restangular","toastr","$filter","$rootScope","$state","$uibModal","App","MySocket",function(e,t,n,r,o,i,a,s,c){return e.USER=e.$parent.USER,e.idioma=e.USER.idioma_main_id,e.examen_actual=o.examen_actual,e.elegirOpcion=function(t,r,i){if(angular.forEach(t.opciones,function(e){return e.elegida=!1}),r.elegida=!0,e.examen_actual.one_by_one)return r.letra=e.indexChar(i),a.open({templateUrl:s.views+"examen_respuesta/seguroRespuesta.tpl.html",controller:"SeguroRespuestaPregKingCtrl",resolve:{preguntatop:function(){return e.preguntaking},pregunta_traduc:function(){return t},opcion:function(){return r},examen_actual:function(){return e.examen_actual},agrupada:function(){return!1}}}).result.then(function(t){var a;return r.respondida=!0,r.is_correct?(a="correct",n.info("Respuesta CORRECTA")):(a="incorrect",n.info("Respuesta INCORRECTA",{iconClass:"toast-pink"})),e.$emit("respuesta_elegida",i,a),c.sc_answered(a,o.tiempo)})},e.toggleMostrarAyuda=function(e){return e.mostrar_ayuda=!e.mostrar_ayuda},e.indexChar=function(e){return String.fromCharCode(65+e)}}]).directive("viewPreguntaExamen",["App",function(e){return{restrict:"E",templateUrl:`${e.views}examen_respuesta/viewPreguntaExamenDir.tpl.html`,scope:{preguntaking:"=",indice:"=",idiomapreg:"="},link:function(e,t,n){},controller:"ViewPreguntaExamenCtrl"}}]).controller("SeguroRespuestaPregKingCtrl",["$scope","$uibModalInstance","opcion","Restangular","toastr","$filter","examen_actual","preguntatop","pregunta_traduc","agrupada","$rootScope",function(e,t,n,r,o,i,a,s,c,u,l){return e.opcion=n,e.examen_actual=a,e.ok=function(){var i,d;return e.guardando=!0,l.pause_tiempo=!0,null!=e.start_to_save||(e.start_to_save=Date.now()),i={examen_actual_id:a.examen_id,pregunta_top_id:s.id,pregunta_sub_id:c.id,idioma_id:c.idioma_id,tipo_pregunta:s.tipo_pregunta,opcion_id:n.id,tiempo:Date.now()-l.dt_start_preg},d=u?"examenes_respuesta/responder-pregunta-agrupada":"examenes_respuesta/responder-pregunta",r.all(d).customPUT(i).then(function(n){var r;return l.pause_tiempo=!1,l.tiempo_preg=0,e.guardando=!1,r=Date.now()-e.start_to_save,l.dt_start_exam=l.dt_start_exam+r,l.dt_start_preg=Date.now(),t.close(n)},function(t){return l.pause_tiempo=!0,e.guardando=!1,o.warning("No se pudo guardar respuesta.","Problema")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoExamenCtrl",["$scope","Restangular","toastr","$filter","$rootScope","$state","$uibModal","App",function(e,t,n,r,o,i,a,s){return e.USER=e.$parent.USER,e.idioma=e.USER.idioma_main_id,e.examen_actual=o.examen_actual,e.elegirOpcion=function(t,r,o){if(angular.forEach(t.opciones,function(e){return e.elegida=!1}),r.elegida=!0,e.examen_actual.one_by_one)return r.letra=e.indexChar(o),a.open({templateUrl:s.views+"examen_respuesta/seguroRespuesta.tpl.html",controller:"SeguroRespuestaPregKingCtrl",resolve:{preguntatop:function(){return e.grupoking},pregunta_traduc:function(){return t},opcion:function(){return r},examen_actual:function(){return e.examen_actual},agrupada:function(){return!0}}}).result.then(function(t){return r.respondida=!0,e.$emit("respuesta_elegida",o),n.success("Respuestuesta guardada")})},e.indexChar=function(e){return String.fromCharCode(65+e)},e.toggleMostrarAyuda=function(e){return e.mostrar_ayuda=!e.mostrar_ayuda}}]).directive("viewGrupoExamen",["App",function(e){return{restrict:"E",templateUrl:`${e.views}examen_respuesta/viewGrupoExamenDir.tpl.html`,scope:{grupoking:"=",indice:"=",idiomapreg:"="},link:function(e,t,n){},controller:"ViewGrupoExamenCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("timerDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}examen_respuesta/timerDir.tpl.html`,scope:{tiempomax:"="},controller:"TimerCtrl"}}]).controller("TimerCtrl",["$scope","Restangular","toastr","$filter","$state","$rootScope","$interval","Perfil",function(e,t,n,r,o,i,a,s){return i.tiempo=-1,i.tiempo_preg=0,e.tiempo=i.tiempo,i.dt_start_exam=0,i.dt_start_preg=0,e.start=function(){return a.cancel(i.promiseInterval),i.dt_start_exam=Date.now(),i.dt_start_preg=i.dt_start_exam,i.promiseInterval=a(function(){var t,n,r,o,a;if(e.$parent.waiting_question)return e.stop();if(!i.pause_tiempo)if(t=Date.now()-i.dt_start_exam,n=Date.now()-i.dt_start_preg,i.tiempo=t,i.tiempo_preg=n,e.tiempo_seg=Math.floor(t/1e3),a=(o=new Date(t)).getSeconds(),r=o.getMinutes(),a=a<10?"0"+a:a,r=r<10?"0"+r:r,e.tiempo_formateado=r+":"+a,e.$parent.USER.evento_actual.gran_final){if(1e3*i.examen_actual.duracion_preg<=i.tiempo)return e.stop(),e.$emit("tiempo_preg_terminado")}else if(60*i.examen_actual.duracion_exam*1e3<i.tiempo)return e.stop(),e.$emit("tiempo_exam_terminado")},100)},e.start(),e.stop=function(){return a.cancel(i.promiseInterval)},e.$on("next_question",function(t){if(i.tiempo=0,e.$parent.USER.evento_actual.gran_final)return e.start()}),e.$on("goto_question_no",function(t){if(i.tiempo=0,e.$parent.USER.evento_actual.gran_final)return e.start()})}])}.call(this),function(){angular.module("WissenSystem").config(["$stateProvider","App","PERMISSIONS",function(e,t,n){return e.state("panel.usuarios",{url:"^/usuarios",views:{contenido_panel:{templateUrl:`${t.views}usuarios/usuarios.tpl.html`,controller:"UsuariosCtrl"}},data:{pageTitle:"Usuarios",needed_permissions:[n.can_edit_usuarios,n.can_work_like_asesor,n.can_work_like_ejecutor]}})}])}.call(this),function(){angular.module("WissenSystem").controller("UsuariosCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","uiGridConstants","$uibModal","$filter","$location","$anchorScroll","$mdSidenav","MySocket","SocketData","App","AuthService",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h,m){var _;m.verificar_acceso(),e.imagesPath=h.images,e.perfilPath=h.images+"perfil/",e.usuarios=[],e.currentUsers=[],e.currentUser={inscripciones:[]},_=localStorage.getItem("nivelSelected")?parseInt(localStorage.getItem("nivelSelected")):"",localStorage.getItem("entidadSelected")&&parseInt(localStorage.getItem("entidadSelected")),e.newUsu={sexo:"M",nivel_id:_,inscripciones:[],imgUsuario:null},e.editando=!1,e.creando=!1,n.one("imagenes/usuarios").customGET().then(function(t){return e.imagenes=t.imagenes},function(e){return a.error("No se trajeron las imágenes.")}),e.eliminarUsuario=function(){return c.open({templateUrl:h.views+"usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return e.currentUser},entidades:function(){return e.$parent.entidades}}}).result.then(function(t){return e.$broadcast("usuarioEliminadoEnParentEditar",t)})},e.misImagenes=function(){return c.open({templateUrl:h.views+"preguntas/misImagenes.tpl.html",controller:"MisImagenes",size:"lg",resolve:{resolved_user:function(){return e.USER}}}).result.then(function(t){return e.imagenes.push(t),e.newUsu.imagen_id=t.id,e.newUsu.imagen_nombre=t.imagen_nombre,e.newUsu.imgUsuario=t,e.currentUser.imagen_id=t.id,e.currentUser.imagen_nombre=t.imagen_nombre,e.currentUser.imgUsuario=t})},e.comprobar_evento_actual=function(){return e.evento_actual?e.evento_actual.idioma_principal_id?e.idiomaPreg={selected:e.evento_actual.idioma_principal_id}:void 0:a.warning("Primero debes crear o seleccionar un evento actual")},e.comprobar_evento_actual(),e.$on("cambio_evento_user",function(){return e.comprobar_evento_actual(),e.traer_niveles(),e.traer_entidades(),e.traer_categorias()}),e.$on("cambia_evento_actual",function(){return e.comprobar_evento_actual()}),e.niveles_king=[],e.traer_niveles=function(){return n.all("niveles/niveles-usuario").getList().then(function(t){return e.niveles_king=t},function(e){return a.warning("No se trajeron las niveles","Problema")})},e.traer_niveles(),e.entidades=[],e.traer_entidades=function(){return n.all("entidades").getList().then(function(t){return e.entidades=t},function(e){return a.warning("No se trajeron las entidades","Problema")})},e.traer_entidades(),e.categorias_king1=[],e.categorias_king2=[],e.traer_categorias=function(){return n.all("categorias/categorias-usuario").getList().then(function(t){return e.categorias_king1=t,angular.copy(e.categorias_king1,e.categorias_king2)},function(e){return a.warning("No se trajeron las categorias","Problema"),console.log("No se trajo categorias ",e)})},e.traer_categorias(),e.avatar={masculino:{abrev:"M",def:"Masculino",img:e.imagesPath+"perfil/system/avatars/male1.png"},femenino:{abrev:"F",def:"Femenino",img:e.imagesPath+"perfil/system/avatars/female1.png"}},e.empezarCrear=function(){return e.creando=!e.creando},e.guardando=!1,e.guardarNuevo=function(){return e.guardando=!0,n.one("usuarios/store").customPOST(e.newUsu).then(function(t){return a.success("Usuario guardado con éxito."),e.usuarios.unshift(t),e.guardando=!1,e.newUsu.nombres="",e.newUsu.apellidos="",e.newUsu.username="",e.newUsu.inscripciones=[],e.newUsu.imgUsuario=null},function(t){return a.warning("No se creó el usuario, posible login repetido","Problema"),e.guardando=!1})},e.guardarNuevoYLogin=function(){return e.guardando=!0,n.one("usuarios/store").customPOST(e.newUsu).then(function(t){return a.success("Usuario guardado con éxito."),e.usuarios.unshift(t),e.guardando=!1,e.newUsu.nombres="",e.newUsu.apellidos="",e.newUsu.username="",e.newUsu.inscripciones=[],e.newUsu.imgUsuario=null,f.clt_selected=usuario,p("sidenavSelectPC").toggle(),l.hash("sidenavSelectPC"),d()},function(t){return a.warning("No se creó el usuario, posible login repetido","Problema"),console.log("No se creó usuario ",t),e.guardando=!1})},e.cambiaNivelNewUsu=function(){return localStorage.setItem("nivelSelected",e.newUsu.nivel_id)},e.guardando_edicion=!1,e.guardarEdicion=function(){return e.guardando_edicion=!0,n.one("usuarios/update").customPUT(e.currentUser).then(function(t){return a.success("Cambios guardados."),e.guardando_edicion=!1},function(t){return a.warning("No se guardó cambios del usuario","Problema"),console.log("No se guardó cambios del usuario ",t),e.guardando_edicion=!1})},e.checkeandoCategorias=function(e,t){return t.indexOf(e)>-1},e.toggle=function(e,t){var n;return(n=t.indexOf(e))>-1?t.splice(n,1):t.push(e)},e.checkeandoCategoriasEdit=function(e,t){return t.indexOf(e)>-1},e.toggleEdit=function(e,t){var n;return(n=t.indexOf(e))>-1?t.splice(n,1):t.push(e)},e.cancelarNuevo=function(){return e.creando=!1},e.cancelarEdicion=function(){return e.editando=!1},e.cambiaInscripcion=function(e,t){var r,o;return r=t[0],e.cambiando=!0,o={usuario_id:r.id,categoria_id:e.categoria_id},e.selected?n.one("inscripciones/inscribir").customPUT(o).then(function(t){var n;return e.cambiando=!1,0===(n=u("filter")(r.inscripciones,{categoria_id:o.categoria_id})).length?r.inscripciones.push(t[0]):(n[0].id=t[0].id,n[0].deleted_at=t[0].deleted_at)},function(t){return a.warning("No se inscribó el usuario","Problema"),e.cambiando=!1,e.selected=!1}):n.one("inscripciones/desinscribir").customPUT(o).then(function(t){return e.cambiando=!1,console.log("Inscripción eliminada",t,r.inscripciones,o.categoria_id),r.inscripciones=u("filter")(r.inscripciones,{categoria_id:"!"+o.categoria_id})},function(t){return a.warning("No se quitó inscripción","Problema"),e.cambiando=!1,e.selected=!0})}}])}.call(this),function(){angular.module("WissenSystem").directive("gridUsuarios",["App",function(e){return{restrict:"E",templateUrl:`${e.views}usuarios/gridUsuariosDir.tpl.html`,scope:{usuarios:"=",categoriasking:"=",currentusers:"=",nivelesking:"=",idioma:"="},link:function(e,t,n){},controller:"GridUsuariosCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("GridUsuariosCtrl",["$scope","$http","Restangular","$state","$cookies","$interval","toastr","uiGridConstants","$uibModal","$filter","$location","$anchorScroll","$mdSidenav","App","MySocket","SocketData",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h){var m,_,v,w,E;e.currentusers=[],e.currentuser={},e.seleccionar_fila=function(t){var n;return e.gridApi.selection.clearSelectedRows(),e.gridApi.selection.selectRow(t),e.currentuser=t,n=[],angular.copy(e.categoriasking,n),e.categorias_inscripcion=u("categsInscritas")(e.currentusers,n,e.idioma)},e.seleccionar_entidad=function(t){return c.open({templateUrl:g.views+"usuarios/cambiarEntidadUsuario.tpl.html",controller:"SelectEntidadCtrl",resolve:{usuario:function(){return t},entidades:function(){return e.$parent.entidades}}}).result.then(function(e){return t.entidad_id=e})},e.showSidenavSelectPC=function(e){return h.clt_selected=e,p("sidenavSelectPC").toggle(),l.hash("sidenavSelectPC"),d()},e.editando=!1,e.editar=function(t){var n,r,o,i,a;for(e.gridApi.selection.clearSelectedRows(),e.gridApi.selection.selectRow(t),e.$parent.currentUser=t,e.$parent.currentUser.imgUsuario={id:e.$parent.currentUser.imagen_id,nombre:e.$parent.currentUser.imagen_nombre},o=0,i=(a=e.$parent.entidades).length;o<i;o++)(r=a[o]).id===e.$parent.currentUser.entidad_id&&(e.$parent.currentUser.entidad=r);return e.$parent.currentUser.nivel_id=parseInt(e.$parent.currentUser.nivel_id),e.currentusers=[t],e.$parent.editando=!0,n=[],angular.copy(e.categoriasking,n),e.$parent.categorias_inscripcion=u("categsInscritas")(e.currentusers,n,e.idioma)},e.eliminar=function(t){return e.gridApi.selection.clearSelectedRows(),e.gridApi.selection.selectRow(t),c.open({templateUrl:g.views+"usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return t},entidades:function(){return e.$parent.entidades}}}).result.then(function(t){var n;return n=t.id?t.id:t.rowid,e.usuarios=u("filter")(e.usuarios,{id:"!"+n}),e.gridOptions.data=e.usuarios})},e.$on("usuarioEliminadoEnParentEditar",function(t,n){var r;return r=n.id?n.id:n.rowid,e.usuarios=u("filter")(e.usuarios,{id:"!"+r}),e.gridOptions.data=e.usuarios}),e.verRoles=function(e){return c.open({templateUrl:g.views+"usuarios/verRoles.tpl.html",controller:"VerRolesCtrl",resolve:{usuario:function(){return e},roles:function(){return n.all("roles").getList().then(function(e){return e},function(e){return a.warning("No pudo traer los roles","Problema"),console.log("No pudo traer los roles ",e)})}}}).result.then(function(e){})},_='<a class="btn btn-xs shiny btn-info" ng-click="grid.appScope.seleccionar_entidad(row.entity)" ng-bind="row.entity.entidad_id | nombreEntidad:grid.appScope.$parent.entidades:true"> <md-tooltip md-direction="left">{{row.entity.entidad_id | nombreEntidad:grid.appScope.$parent.entidades:false}}</md-tooltip> </a>',v='<a class="btn btn-xs btn-info" ng-click="grid.appScope.verRoles(row.entity)"><span ng-repeat="rol in row.entity.roles">{{rol.display_name}}-</span>  <md-tooltip md-direction="left">Modificar roles</md-tooltip> </a>',m='<div class="btn-group">'+'<a class="btn btn-default btn-xs " ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i> <md-tooltip md-direction="left">Editar</md-tooltip> </a>'+($(window).width()>800?'<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-xs btn-danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a> ':"")+'<a class="btn btn-xs btn-info" ng-click="grid.appScope.seleccionar_fila(row.entity)"><i class="fa fa-check "></i></a>'+'<a class="btn btn-xs btn-info" ng-click="grid.appScope.showSidenavSelectPC(row.entity)"><i class="fa fa-desktop "></i> <md-tooltip md-direction="right">Abrir en equipo</md-tooltip> </a>'+"</div>",E=[],$(window).width()>800&&(w=e.$parent.USER.rowid?"rowid":"id",E.push({field:w,displayName:"Id",width:50,enableCellEdit:!1})),$(window).width()>800?E.push({name:"edicion",displayName:"Edición",width:130,enableSorting:!1,enableFiltering:!1,cellTemplate:m,enableCellEdit:!1,enableColumnMenu:!1}):E.push({name:"edicion",displayName:"Edición",width:100,enableSorting:!1,enableFiltering:!1,cellTemplate:m,enableCellEdit:!1,enableColumnMenu:!1}),E.push({field:"nombres",filter:{condition:s.filter.CONTAINS},minWidth:100,enableHiding:!1,filter:{condition:function(e,t){var n;return n=window.removeAccents(e).toLowerCase(),-1!==window.removeAccents(t).toLowerCase().indexOf(n)}}}),E.push({field:"apellidos",filter:{condition:s.filter.CONTAINS},minWidth:90,filter:{condition:function(e,t){var n;return n=window.removeAccents(e).toLowerCase(),-1!==window.removeAccents(t).toLowerCase().indexOf(n)}}}),$(window).width()>800&&E.push({field:"sexo",displayName:"Sex",width:50}),E.push({field:"username",filter:{condition:s.filter.CONTAINS},displayName:"Usuario",minWidth:70}),E.push({field:"entidad_id",displayName:"Entidad",cellTemplate:_,enableCellEdit:!1,minWidth:80,sortingAlgorithm:function(e,t,n,r){return e===t?0:1},filter:{condition:function(t,n){var r,o,i,a;return r=e.$parent.entidades,a=window.removeAccents(t).toLowerCase(),o=u("nombreEntidad")(n,r,!0),o=window.removeAccents(o).toLowerCase(),i=u("nombreEntidad")(n,r),i=window.removeAccents(i).toLowerCase(),-1!==o.indexOf(a)||-1!==i.indexOf(a)}}}),e.$parent.hasRoleOrPerm(["Admin","Ejecutor"])&&$(window).width()>800&&E.push({field:"roles",displayName:"Roles",cellTemplate:v,enableCellEdit:!1,minWidth:70}),$(window).width()<=800?e.gridOptions={multiSelect:!1,enebleGridColumnMenu:!1,enableRowHeaderSelection:!1}:e.gridOptions={selectedItems:e.currentusers,multiSelect:!0,enableSelectAll:!0},e.gridOptions.showGridFooter=!0,e.gridOptions.enableSorting=!0,e.gridOptions.enableFiltering=!0,e.gridOptions.enableRowSelection=!0,e.gridOptions.columnDefs=E,e.gridOptions.onRegisterApi=function(t){return e.gridApi=t,t.selection.on.rowSelectionChanged(e,function(n){return e.currentusers=t.selection.getSelectedRows()}),t.selection.on.rowSelectionChangedBatch(e,function(n){return e.currentusers=t.selection.getSelectedRows()}),t.edit.on.afterCellEdit(e,function(t,r,o,i){if(o!==i){if("sexo"===r.field&&"M"!==o&&"F"!==o)return a.warning("Debe usar M o F"),t.sexo=i,void e.$apply();n.one("usuarios/update").customPUT(t).then(function(e){return a.success("Usuario actualizado con éxito","Actualizado")},function(e){return a.error("Cambio no guardado","Error")})}return e.$apply()})},n.all("usuarios").getList().then(function(t){return e.usuarios=t,e.gridOptions.data=e.usuarios}),e.cambiaInscripcion=function(e,t){var r,o,i,s,c;for(e.cambiando=!0,o={usuarios:[],categoria_id:e.categoria_id},i=0,s=t.length;i<s;i++)r=t[i],c=r.id?r.id:r.rowid,o.usuarios.push({user_id:r.id});return e.selected?n.one("inscripciones/inscribir-varios").customPUT(o).then(function(n){var o,i,a,s,l,d,p;for(s=0,d=t.length;s<d;s++)for(r=t[s],l=0,p=n.length;l<p;l++)a=n[l],c=r.id?r.id:r.rowid,a.user_id===c&&(0===(o=u("filter")(r.inscripciones,{categoria_id:a.categoria_id})).length?r.inscripciones.push(a):(i=a.id?a.id:a.rowid,o[0].id=i,o[0].rowid=i,o[0].deleted_at=a.deleted_at));return e.cambiando=!1},function(t){return a.warning("No se inscribó el usuario","Problema"),console.log("No se inscribó el usuario ",t),e.cambiando=!1,e.selected=!1}):n.one("inscripciones/desinscribir-varios").customPUT(o).then(function(n){var r,o,i,a;for(e.cambiando=!1,i=[],r=0,o=t.length;r<o;r++)a=t[r],i.push(a.inscripciones=u("filter")(a.inscripciones,{categoria_id:"!"+e.categoria_id}));return i},function(t){return a.warning("No se quitó inscripción","Problema"),console.log("No se quitó inscripción ",t),e.cambiando=!1,e.selected=!0})}}]).controller("RemoveUsuarioCtrl",["$scope","$uibModalInstance","usuario","entidades","Restangular","toastr",function(e,t,n,r,o,i){return e.usuario=n,e.entidades=r,e.ok=function(){var e;return e=n.id?n.id:n.rowid,o.all("usuarios/destroy").customDELETE(e).then(function(e){return i.success("Usuario eliminado con éxito.","Eliminado"),t.close(n)},function(e){return i.warning("No se pudo eliminar al usuario.","Problema"),console.log("Error eliminando usuario: ",e),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}]).controller("SelectEntidadCtrl",["$scope","$uibModalInstance","usuario","entidades","Restangular","toastr","$filter",function(e,t,n,r,o,i,a){return e.usuario=n,e.entidades=r,e.entidades_extras=a("filter")(r,{id:"!"+n.entidad_id}),e.seleccionar=function(e){var r;return r={user_id:n.id?n.id:n.rowid,entidad_id:e.id},o.all("usuarios/cambiar-entidad").customPUT(r).then(function(n){var r;return i.success("Entidad cambiada con éxito.",e.alias),r=e.id?e.id:e.rowid,t.close(r)},function(e){return i.warning("No se pudo cambiar entidad.","Problema"),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}]).controller("VerRolesCtrl",["$scope","$uibModalInstance","usuario","roles","Restangular","toastr",function(e,t,n,r,o,i){var a;return e.usuario=n,e.roles=r,a=n.id?n.id:n.rowid,e.datos={selecteds:[]},e.datos.selecteds=n.roles,e.seleccionando=function(e,t){var n;return n={user_id:a,role_id:e.id},o.one("roles/add-role-to-user").customPUT(n).then(function(e){return i.success("Rol agregado con éxito.")},function(e){return i.warning("No se pudo agregar el rol al usuario.","Problema"),console.log("No se pudo agregar el rol al usuario.: ",e)})},e.quitando=function(e,t){return o.one("roles/remove-role-to-user").customPUT({role_id:e.id,user_id:a}).then(function(e){return i.success("Rol quitado con éxito.")},function(e){return i.warning("No se pudo quitar el rol al usuario.","Problema"),console.log("No se pudo quitar el rol al usuario.: ",e)})},e.ok=function(){return n.roles=e.datos.selecteds,t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("sidenavSelectPcDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}usuarios/sidenavSelectPCDir.tpl.html`,scope:!1,controller:"SidenavSelectPCCtrl"}}]).controller("SidenavSelectPCCtrl",["$scope","$rootScope","Restangular","toastr","MySocket","SocketData","SocketClientes","$mdSidenav",function(e,t,n,r,o,i,a,s){return e.selectedUser={},e.SocketData=i,o.get_clts(),t.$on("take:clientes",function(){return $timeout(function(){return e.$apply()},1e3)}),e.ingresar_seleccionado=function(t){return o.let_him_enter(i.clt_selected.id,t.resourceId),e.cerrar_sidenav()},e.all_clientes=function(){return a.clientes},e.cerrar_sidenav=function(){return s("sidenavSelectPC").close()}}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("panel.control",{url:"^/control",views:{contenido_panel:{templateUrl:`${e.views}control/control.tpl.html`,controller:"ControlCtrl"},data:{pageTitle:"Control"}}}).state("panel.crearservidor",{url:"^/crearservidor",views:{contenido_panel:{templateUrl:`${e.views}control/crear_servidor.tpl.html`,controller:"CrearServidorCtrl"},data:{pageTitle:"Creando Chat Server"}}}),n.translations("EN",{CLIENTES_CONECTADOS_TL:"Conected clients","CONEXIÓN_TL":"Connection",ABRIR_SERVIDOR_TL:"Open server",CERRAR_SERVIDOR_TL:"Close server",CONECTAR_TL:"Connect",QR_SCANNER_TL:"QR Scanner",DESELECCIONAR_TL:"Diselect",DESELECCIONAR_TODO_TL:"Diselect all",SELECCIONAR_TODO_TL:"Select all",EMPEZAR_EXAMEN_TL:"Start test",SIGUIENTE_PREGUNTA_TL:"Next question",ACTUALIZAR_TL:"Refresh",REGISTRADOS_CONECTADOS_TL:"Conected Registereds",CERRAR_SESION_TL:"Logout",EDITAR_TL:"Edit",DISPONIBLES_TL:"Availables",SIN_REGISTRAR_TL:"Unregistereds",NOMBRE_DE_PUNTO_TL:"Point name",SELECCIONAR_UN_USUARIO_TL:"Diselect an user",GUARDAR_NOMBRE_PUNTO_TL:"Save point name",MENSAJE_TL:"Message",ENVIA_UN_MENSAJE_TL:"Send a message",ENVIA_TL:"Send",COMANDOS_TL:"Commands",PREG_TL:"Current question",MOSTRAR_PREGUNTA_TL:"Show question",MOSTRAR_PUNTAJE_TL:"Show score",MOSTRAR_LOGO_ENTIDADES_TL:"Show entities ad",MOSTRAR_PARTICIPANTES_TL:"Show players",MOSTRAR_BARRAS_TL:"Show bar chart",CONFIGURAR_FONDO_TL:"Config background image",ESTABLECER_FONDO_TL:"Set background image",MOSTRAR_SOLO_FONDO_TL:"Show background only",CAMBIAR_TELEPROMPTER_TL:"Change teleprompter",EMPEZAR_EXAMEN_TL:"Start test",ENVIAR_CLIENTES_SELECCIONADOS_A_UNA_PREGUNTA_TL:"Send seleccted clients to a question",LIBERAR_HASTA_PREGUNTA_TL:"Free till question",IR_TL:"Go",TABLA_DE_RESULTADOS_TL:"Result table",CHAT_PUBLICO_TL:"Public chat"}).translations("ES",{CLIENTES_CONECTADOS_TL:"Clientes conectados","CONEXIÓN_TL":"Conexión",ABRIR_SERVIDOR_TL:"Abrir servidor",CERRAR_SERVIDOR_TL:"Cerrar servidor",CONECTAR_TL:"Conectar",QR_SCANNER_TL:"Escaner QR",DESELECCIONAR_TL:"Deseleccionar",DESELECCIONAR_TODO_TL:"Deseleccionar todo",SELECCIONAR_TODO_TL:"Seleccionar todo",EMPEZAR_EXAMEN_TL:"Empezar examen",SIGUIENTE_PREGUNTA_TL:"Siguiente pregunta",ACTUALIZAR_TL:"Actualizar",REGISTRADOS_CONECTADOS_TL:"Registrados conectados",CERRAR_SESION_TL:"Cerrar sesion",EDITAR_TL:"Editar",DISPONIBLES_TL:"Disponibles",SIN_REGISTRAR_TL:"Sin registrar",NOMBRE_DE_PUNTO_TL:"Nombre de punto",SELECCIONAR_UN_USUARIO_TL:"Seleccionar un usuario",GUARDAR_NOMBRE_PUNTO_TL:"Guardar nombre punto",MENSAJE_TL:"Mensaje",ENVIA_UN_MENSAJE_TL:"Envía un mensaje",ENVIA_TL:"Envía",COMANDOS_TL:"Comandos",PREG_TL:"Pregunta actual",MOSTRAR_PREGUNTA_TL:"Mostrar pregunta",MOSTRAR_PUNTAJE_TL:"Mostrar puntaje",MOSTRAR_LOGO_ENTIDADES_TL:"Mostrar logo entidades",MOSTRAR_PARTICIPANTES_TL:"Mostrar participantes",MOSTRAR_BARRAS_TL:"Mostrar barras",CONFIGURAR_FONDO_TL:"Configurar fondo",ESTABLECER_FONDO_TL:"Establecer fondo",MOSTRAR_SOLO_FONDO_TL:"Mostrar solo fondo",CAMBIAR_TELEPROMPTER_TL:"Cambiar teleprompter",EMPEZAR_EXAMEN_TL:"Empezar examen",ENVIAR_CLIENTES_SELECCIONADOS_A_UNA_PREGUNTA_TL:"Enviar clientes seleccionados a una pregunta",LIBERAR_HASTA_PREGUNTA_TL:"Liberar hasta pregunta",IR_TL:"Ir",TABLA_DE_RESULTADOS_TL:"Tabla de resultados",CHAT_PUBLICO_TL:"Chat público"})}])}.call(this),function(){angular.module("WissenSystem").controller("ControlCtrl",["$scope","Restangular","toastr","$state","$window","MySocket","SocketData","SocketClientes","$rootScope","$mdSidenav","$filter","$uibModal","App","$timeout",function(e,t,n,r,o,i,a,s,c,u,l,d,p,g){return e.SocketData=a,e.SocketClientes=s,e.cltdisponible_selected={},e.categorias_king=[],e.categorias_traducidas=[],e.cmdCategSelected={},e.cmdPreguntasTraduc=[],e.cmdPreguntaSelected={},e.cmdNoPregSelected=0,e.cmdNoPregunta=1,e.cmdShowLogoEntidadPartici=!1,e.show_result_table=!0,e.fondo={},c.silenciar_todo=!!localStorage.getItem("silenciar_todo")&&localStorage.getItem("silenciar_todo"),c.silenciar_todo="true"===c.silenciar_todo,e.silenciar_todo=c.silenciar_todo,c.silenciar_respuestas=!!localStorage.getItem("silenciar_respuestas")&&localStorage.getItem("silenciar_respuestas"),c.silenciar_respuestas="true"===c.silenciar_respuestas,e.silenciar_respuestas=c.silenciar_respuestas,i.on("take:usuarios",function(e){return console.log("Llegaron los usuarios")}),e.registrados_logueados=function(){return s.registrados_logueados},e.registrados_no_logged=function(){return s.registrados_no_logged},e.sin_registrar=function(){return s.sin_registrar},e.all_clientes=function(){return s.clientes},e.configurar_imagenes=function(){return t.one("imagenes/usuarios").customGET().then(function(t){return e.imagenes=t.imagenes},function(e){return n.error("No se trajeron las imágenes.")}),e.misImagenes=function(){return d.open({templateUrl:p.views+"preguntas/misImagenes.tpl.html",controller:"MisImagenes",size:"lg",resolve:{resolved_user:function(){return e.USER}}}).result.then(function(t){return e.imagenes.push(t)})}},e.establecer_fondo=function(){return i.establecer_fondo(e.fondo.imagen_seleccionada.nombre)},e.mostrar_solo_fondo=function(){return i.mostrar_solo_fondo(e.fondo.imagen_seleccionada.nombre)},e.cambiar_teleprompter=function(){return i.cambiar_teleprompter(e.msg_teleprompter)},e.mostrar_result_table=function(){return e.show_result_table=!0},t.all("evaluaciones/categorias-con-preguntas").getList().then(function(t){if(e.categorias_king=t,s.categorias_king=t,e.categorias_traducidas=l("categoriasTraducidas")(e.categorias_king,e.USER.idioma_main_id),1===e.categorias_king.length)return e.cmdClickCategSelected(e.categorias_king[0])},function(e){return n.warning("No se trajeron las categorias del evento","Problema")}),e.CerrarServidor=function(){return t.one("chat/cerrar-servidor").customPUT().then(function(e){return n.success("Cerrado",e)},function(e){return n.warning("No se cerró servidor"),console.log("No se cerró servidor ",e)})},e.openMenu=function(e,t){return e(t)},e.openMenuCateg=function(e,t){return e(t)},e.showSidenavEditUsu=function(t){return e.clt_to_edit=t.user_data,u("sidenavEditusu").toggle().then(function(){return console.log("toggle is done")})},e.showSidenavSelectUsu=function(t){return e.cltdisponible_selected=t,i.get_usuarios(),e.clt_to_edit=t.user_data,u("sidenavSelectusu").toggle().then(function(){})},e.Conectar=function(){return i.conectar()},e.qrScanear=function(){var e;return e=r.href("qrscanner"),o.open(e,"_blank"),!0},e.crearservidor=function(){var e;return e=r.href("panel.crearservidor"),o.open(e,"_blank"),!0},e.enviarMensajeTo=function(){var t,n,r,o,a,c,u,l,d,p,g;if(g=!1,""!==e.newMensaje){for(n=0,a=(l=s.registrados_logueados).length;n<a;n++)(t=l[n]).seleccionado&&(i.send_email_to(e.newMensaje,t),g=!0);for(r=0,c=(d=s.registrados_no_logged).length;r<c;r++)(t=d[r]).seleccionado&&(i.send_email_to(e.newMensaje,t),g=!0);for(o=0,u=(p=s.sin_registrar).length;o<u;o++)(t=p[o]).seleccionado&&(i.send_email_to(e.newMensaje,t),g=!0);if(g)return e.newMensaje=""}},e.deseleccionarTodo=function(){var e,t,n,r,o;for(o=[],t=0,n=(r=s.clientes).length;t<n;t++)(e=r[t]).seleccionado?o.push(e.seleccionado=!1):o.push(void 0);return o},e.seleccionarTodo=function(){var e,t,n,r,o;for(o=[],t=0,n=(r=s.clientes).length;t<n;t++)(e=r[t]).seleccionado?o.push(void 0):o.push(e.seleccionado=!0);return o},e.actualizarClts=function(){return i.get_clts()},e.guardarNombrePunto=function(e){var t;return t=l("clearhtml")(e.nombre_punto),i.guardar_nombre_punto(e.resourceId,t)},e.cargar_resultados=function(){var r,o,a,c,u;for(i.get_clts(),o=[],r=0,a=(u=s.clientes).length;r<a;r++)(c=u[r]).examen_actual_id&&o.push(c.examen_actual_id);return t.one("puestos/examenes-ejecutandose").customPUT({ids:o}).then(function(t){return e.examenes_cargados=t},function(e){return n.warning("No se trajeron los exámenes","Problema"),console.log("No se trajeron los exámenes ",e)})},e.sc_mostrar_resultados_actuales=function(){return i.sc_mostrar_resultados_actuales(e.examenes_cargados)},e.clickedClt=function(t,n){return e.deseleccionar?n.seleccionado=!1:n.seleccionado=!n.seleccionado},e.sobreClt=function(t,n){if(1===t.buttons)return e.deseleccionar?n.seleccionado=!1:n.seleccionado=!0},e.cerrar_sesion_a=function(e){if(confirm("¿Cerrar sesión a "+e.user_data.nombres+"?"))return i.cerrar_sesion_a(e.resourceId)},e.registrar_a=function(e){return n.info("Ahora es un equipo oficial",e.nombre_punto),i.registrar_a(e.resourceId)},e.desregistrar_a=function(e){return n.info("Deja de ser oficial",e.nombre_punto),i.desregistrar_a(e.resourceId)},e.categoriaSelect=function(t){var n;return t&&(n=l("categSelectedDeUsuario")(t.user_data.inscripciones,e.categorias_king,e.USER.idioma_main_id,t.categsel)).length>0?n[0]:{}},e.cambiarCategSel=function(e,t){var n,r,o,a,s;for(n=!1,r=0,a=(s=e.user_data.inscripciones).length;r<a;r++)o=s[r],t.categoria_id===o.categoria_id&&(n=!0);if(n)return i.change_a_categ_selected(e.resourceId,t.categoria_id)},e.empezarExamen=function(t){var r;return i.empezar_examen(),n.info("Examen empezado"),a.config.info_evento.preg_actual=1,(r=e.cmdPreguntasTraduc[0])?i.sc_show_question(a.config.info_evento.preg_actual,r):n.warning("No hay categoría seleccionada")},e.empezarExamenCliente=function(e){return i.empezar_examen_cliente(e.resourceId)},e.empezarExamenCltsSeleccionados=function(){var e,t,n,r,o;for(o=[],t=0,n=(r=s.clientes).length;t<n;t++)(e=r[t]).seleccionado?o.push(i.empezar_examen_cliente(e.resourceId)):o.push(void 0);return o},e.showParticipantes=function(){return i.sc_show_participantes()},e.showBarras=function(){return i.sc_show_barras()},e.showQuestion=function(){return i.sc_show_question(e.cmdNoPregSelected,e.cmdPreguntaSelected)},e.showPuntajeParticip=function(){return i.sc_show_puntaje_particip(e.cmdCategSelected)},e.cmdClickCategSelected=function(t){var n,r,o,i,a,s,c,u,l,d;for(r=0,i=(u=e.categorias_king).length;r<i;r++)u[r].seleccionada=!1;for(t.seleccionada=!0,e.cmdCategSelected=t,e.cmdPreguntasTraduc=[],d=[],o=0,a=(l=t.evaluaciones).length;o<a;o++)(n=l[o]).actual?d.push(function(){var r,o,i,a;for(a=[],r=0,o=(i=n.preguntas_evaluacion).length;r<o;r++)s=i[r],a.push(function(){var r,o,i,a;for(a=[],r=0,o=(i=s.preguntas_traducidas).length;r<o;r++)(c=i[r]).idioma_id===e.USER.idioma_main_id?(c.tipo_pregunta=s.tipo_pregunta,c.nombre_categ=t.nombre,c.descrip_categ=n.descripcion,c.cantidad_pregs=n.preguntas_evaluacion.length,a.push(e.cmdPreguntasTraduc.push(c))):a.push(void 0);return a}());return a}()):d.push(void 0);return d},e.cmdClickPreguntaSelected=function(t,n){var r,o,i;for(r=0,o=(i=e.cmdPreguntasTraduc).length;r<o;r++)i[r].seleccionada=!1;return t.seleccionada=!0,e.cmdNoPregSelected=n+1,e.cmdPreguntaSelected=t},e.toggleShowLogoEntidadParticipantes=function(){return i.sc_show_logo_entidad_partici(!e.cmdShowLogoEntidadPartici)},e.$watch("silenciar_respuestas",function(e,t){return c.silenciar_respuestas=e,localStorage.silenciar_respuestas=e}),e.$watch("silenciar_todo",function(e,t){return c.silenciar_todo=e,localStorage.silenciar_todo=e}),e.nextQuestion=function(){var t;return i.sc_next_question(),a.config.info_evento.preg_actual=a.config.info_evento.preg_actual+1,(t=e.cmdPreguntasTraduc[a.config.info_evento.preg_actual-1])?i.sc_show_question(a.config.info_evento.preg_actual,t):n.warning("No hay categoría seleccionada")},e.nextQuestionCliente=function(e){return i.sc_next_question_cliente(e)},e.nextQuestionCltsSeleccionados=function(){var e,t,n,r,o;for(o=[],t=0,n=(r=s.clientes).length;t<n;t++)(e=r[t]).seleccionado?o.push(i.sc_next_question_cliente(e)):o.push(void 0);return o},e.gotoNoQuestionClt=function(){var t,r,o,a,c;for(t=0,o=0,a=(c=s.clientes).length;o<a;o++)(r=c[o]).seleccionado&&(t+=1,i.sc_goto_question_no_clt(r,e.cmdNoPregunta));if(0===t)return n.warning("Primero debes seleccionar al menos un participante")},e.liberar_hasta_pregunta=function(){return i.liberar_hasta_pregunta(a.config.info_evento.free_till_question)},c.$on("take:clientes",function(){return g(function(){return e.$apply()},1e3)}),i.get_clts()}])}.call(this),function(){angular.module("WissenSystem").controller("CrearServidorCtrl",["$scope","Restangular","toastr","$timeout",function(e,t,n,r){return e.mytimeout={},e.counter=5,e.onTimeout=function(){return e.counter=e.counter-1,e.counter<1?e.stop():e.mytimeout=r(e.onTimeout,1e3)},e.mytimeout=r(e.onTimeout,1e3),e.stop=function(){return r.cancel(e.mytimeout),e.diagnostico="Ya puedes cerrar esta pestaña"},e.mostrarMensaje=function(){return n.info("Por seguridad, no cierres la pestaña hasta que acabe el tiempo")},t.one("chat").customGET().then(function(e){return console.log("Conectando...",e)},function(t){return r.cancel(e.mytimeout),n.warning("Error, tal vez el Chat Server ya está activo"),console.log("Error, tal vez el Chat Server ya está activo. ",t),e.diagnostico="Error, tal vez el Chat Server ya está activo",e.counter=0})}])}.call(this),function(){angular.module("WissenSystem").directive("sidenavSelectUsuDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}control/sidenavSelectUsuDir.tpl.html`,scope:!1,controller:"SidenavSelectUsuCtrl"}}]).controller("SidenavSelectUsuCtrl",["$scope","Restangular","toastr","MySocket","SocketData","SocketClientes","$mdSidenav","$timeout",function(e,t,n,r,o,i,a,s){return e.selectedUser={},e.avatar={masculino:{abrev:"M",def:"Masculino",img:e.imagesPath+"perfil/system/avatars/male1.png"},femenino:{abrev:"F",def:"Femenino",img:e.imagesPath+"perfil/system/avatars/female1.png"}},e.seleccionarUsu=function(t){var n,r,o,a,s,c;if(c=t.rowid?t.rowid:t.id,t.seleccionado=!t.seleccionado,t.seleccionado){for(e.selectedUser=t,a=[],n=0,r=(o=i.usuarios_all).length;n<r;n++)((s=o[n]).rowid?s.rowid:s.id)!==c?a.push(s.seleccionado=!1):a.push(void 0);return a}},e.seleccionarCkUsu=function(t){var n,r,o,a,s,c;if(c=t.rowid?t.rowid:t.id,t.seleccionado){for(e.selectedUser=t,a=[],n=0,r=(o=i.usuarios_all).length;n<r;n++)((s=o[n]).rowid?s.rowid:s.id)!==c?a.push(s.seleccionado=!1):a.push(void 0);return a}},e.ingresando_seleccionado=!1,e.ingresar_seleccionado=function(t){var o;if(!1===e.ingresando_seleccionado)return t?(o=t.rowid?t.rowid:t.id,e.ingresando_seleccionado=!0,r.let_him_enter(o,e.cltdisponible_selected.resourceId),e.cerrar_sidenav()):(o=e.selectedUser.rowid?e.selectedUser.rowid:e.selectedUser.id)?(e.ingresando_seleccionado=!0,r.let_him_enter(o,e.cltdisponible_selected.resourceId),e.cerrar_sidenav()):n.warning("Selecciona un usuario")},e.cerrar_sidenav=function(){return a("sidenavSelectusu").close(),s(function(){return e.ingresando_seleccionado=!1},50)}}])}.call(this),function(){angular.module("WissenSystem").directive("sidenavEditUsuDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}control/sidenavEditUsuDir.tpl.html`,scope:!1,controller:"SidenavEditUsuCtrl"}}]).controller("SidenavEditUsuCtrl",["$scope","Restangular","toastr","MySocket","SocketData","$mdSidenav","$mdDialog","$filter",function(e,t,n,r,o,i,a,s){return e.niveles_king=[],e.traer_niveles=function(){return t.all("niveles/niveles-usuario").getList().then(function(t){return e.niveles_king=t},function(e){return n.warning("No se trajeron las niveles","Problema"),console.log("No se trajo niveles ",e)})},e.traer_niveles(),e.entidades=[],e.traer_entidades=function(){return t.all("entidades").getList().then(function(t){return e.entidades=t},function(e){return n.warning("No se trajeron las entidades","Problema"),console.log("No se trajo entidades ",e)})},e.traer_entidades(),e.categorias_king1=[],e.categorias_king2=[],e.traer_categorias=function(){return t.all("categorias/categorias-usuario").getList().then(function(t){return e.categorias_king1=t,angular.copy(e.categorias_king1,e.categorias_king2)},function(e){return n.warning("No se trajeron las categorias","Problema"),console.log("No se trajo categorias ",e)})},e.traer_categorias(),e.avatar={masculino:{abrev:"M",def:"Masculino",img:e.imagesPath+"perfil/system/avatars/male1.png"},femenino:{abrev:"F",def:"Femenino",img:e.imagesPath+"perfil/system/avatars/female1.png"}},e.guardando_edicion=!1,e.guardar=function(){return e.guardando_edicion=!0,t.one("usuarios/update").customPUT(e.clt_to_edit).then(function(t){return n.success("Cambios guardados."),e.guardando_edicion=!1,console.log("Cambios guardados",t)},function(t){return n.warning("No se guardó cambios del usuario","Problema"),console.log("No se guardó cambios del usuario ",t),e.guardando_edicion=!1})},e.cancelar=function(){return e.guardando_edicion=!1,i("sidenavEditusu").close()},e.cambiarPass=function(r){var o;return o=a.prompt().title("Contraseña").textContent("Escribe nueva contraseña").placeholder("Contraseña").ariaLabel("Contraseña").targetEvent(r).ok("Cambiar").cancel("Cancelar"),a.show(o).then(function(r){var o;return o={usu_id:e.clt_to_edit.id,password:r},t.one("usuarios/cambiar-pass").customPUT(o).then(function(e){return n.success("Contraseña cambiada.")},function(e){return n.warning("No se cambió la contraseña","Problema"),console.log("No se guardó cambios del usuario ",e)})},function(){return console.log("Canceló cambio de pass")})},e.cambiaInscripcion=function(e,r){var o;return e.cambiando=!0,o={usuario_id:r.id,categoria_id:e.categoria_id},e.selected?t.one("inscripciones/inscribir").customPUT(o).then(function(t){var n;return e.cambiando=!1,console.log("Inscripción creada",t),0===(n=s("filter")(r.inscripciones,{categoria_id:o.categoria_id})).length?r.inscripciones.push(t[0]):(n[0].id=t[0].id,n[0].deleted_at=t[0].deleted_at)},function(t){return n.warning("No se inscribó el usuario","Problema"),console.log("No se inscribó el usuario ",t),e.cambiando=!1,e.selected=!1}):t.one("inscripciones/desinscribir").customPUT(o).then(function(t){return e.cambiando=!1,console.log("Inscripción creada",t),r.inscripciones=s("filter")(r.inscripciones,{categoria_id:"!"+o.categoria_id})},function(t){return n.warning("No se quitó inscripción","Problema"),console.log("No se quitó inscripción ",t),e.cambiando=!1,e.selected=!0})}}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("PerfilCtrl",["$scope","Restangular","toastr",function(e,t,n){return e.newusername="",e.passantiguo="",e.newpass="",e.newpassverif="",e.status={passCambiado:!1},e.cambiarPass=function(r,o,i){var a;if(r===o){if(!(r.length<3))return e.cambiandoPass=!0,a={password:o,oldpassword:i},t.one("perfiles/cambiarpassword/"+e.USER.id).customPUT(a).then(function(t){return n.success("Contraseña cambiada."),e.status.passCambiado=!1,e.cambiandoPass=!1},function(t){return(t=t.data).$error&&"Contraseña antigua es incorrecta"===t.error.message?n.warning(t.error.message):n.error("No se pudo cambiar la contraseña."),e.cambiandoPass=!1});n.warning("La contraseña debe tener mínimo 3 caracteres. Sin espacios ni Ñ ni tildes.")}else n.warning("Las contraseñas no coinciden")}}])}.call(this),function(){angular.module("WissenSystem").config(["$stateProvider","App","$translateProvider",function(e,t,n){return e.state("panel.perfil",{url:"^/perfil",views:{contenido_panel:{templateUrl:`${t.views}perfil/perfil.tpl.html`,controller:"PerfilCtrl"}},data:{pageTitle:"Perfil"}}),n.translations("EN",{PASS:"Contraseña"}).translations("ES",{PASS:"Password"})}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("panel.categorias",{url:"^/categorias",views:{contenido_panel:{templateUrl:`${e.views}categorias/categorias.tpl.html`,controller:"CategoriasCtrl"}},data:{pageTitle:"Categorias"}}),n.translations("EN",{CATEGORIAS_TITLE:"Categs",NIVELES_TITLE:"Levels",DISCIPLINA_TITLE:"Disciplines"}).translations("ES",{CATEGORIAS_TITLE:"Categorias",NIVELES_TITLE:"Niveles",DISCIPLINA_TITLE:"Disciplinas"})}])}.call(this),function(){angular.module("WissenSystem").controller("CategoriasCtrl",["$scope","Restangular","toastr",function(e,t,n){return e.comprobar_evento_actual=function(){return e.evento_actual?e.evento_actual.idioma_principal_id?e.idiomaPreg={selected:e.evento_actual.idioma_principal_id}:void 0:n.warning("Pimero debes crear o seleccionar un evento actual")},e.categorias_king=[],e.niveles_king=[],e.disciplinas_king=[],e.comprobar_evento_actual(),e.$on("cambio_evento_user",function(){return e.comprobar_evento_actual()}),e.$on("cambia_evento_actual",function(){return e.comprobar_evento_actual()})}])}.call(this),function(){angular.module("WissenSystem").controller("CategoriasDirCtrl",["$scope","Restangular","toastr","$uibModal","App","$filter",function(e,t,n,r,o,i){return e.creando=!1,e.traer_categorias=function(){return t.all("categorias/categorias-usuario").getList().then(function(t){return e.categoriasking=t},function(e){return n.warning("No se trajeron las categorias","Problema"),console.log("No se trajo categorias ",e)})},e.traer_categorias(),e.$on("cambio_evento_user",function(){return e.traer_categorias()}),e.crear_categoria=function(){return e.creando=!0,t.one("categorias/store").customPOST().then(function(t){return t.editando=!0,e.categoriasking.push(t),e.creando=!1,console.log("Categorias creada",t)},function(t){return n.warning("No se creó la categoria","Problema"),console.log("No se creó categoria ",t),e.creando=!1})},e.cerrar_edicion=function(e){return e.editando=!1},e.editarCategoria=function(e){return e.editando=!0},e.eliminarCategoria=function(t){return r.open({templateUrl:o.views+"categorias/removeCategoria.tpl.html",controller:"RemoveCategoriaCtrl",resolve:{elemento:function(){return t}}}).result.then(function(t){return e.categoriasking=i("filter")(e.categoriasking,{id:"!"+t.id}),console.log("Resultado del modal: ",t)})},e.finalizar_edicion=function(t){return e.guardando(t),t.editando=!1},e.guardando=function(e){return t.all("categorias/guardar").customPUT(e).then(function(e){return n.success("Categoria guardada.")},function(e){return n.warning("No se pudo guardar la categoria","Problema"),console.log("No se pudo guardar la categoria ",e)})}}]).controller("RemoveCategoriaCtrl",["$scope","$uibModalInstance","elemento","Restangular","toastr",function(e,t,n,r,o){return e.elemento=n,console.log("elemento",n),e.ok=function(){return r.all("categorias/destroy").customDELETE(n.id).then(function(e){return o.success("Categoria eliminada con éxito.","Eliminado"),t.close(n)},function(e){return o.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("categoriasDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}categorias/categoriasDir.tpl.html`,scope:{idiomapreg:"=",eventoactual:"=",categoriasking:"=",nivelesking:"=",disciplinasking:"="},link:function(e,t,n){},controller:"CategoriasDirCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("DisciplinasCtrl",["$scope","Restangular","toastr","$uibModal","App","$filter",function(e,t,n,r,o,i){return e.creando=!1,e.traer_disciplinas=function(){return t.all("disciplinas/disciplinas-usuario").getList().then(function(t){return e.disciplinasking=t},function(e){return n.warning("No se trajeron las disciplinas","Problema"),console.log("No se trajo disciplinas ",e)})},e.traer_disciplinas(),e.$on("cambio_evento_user",function(){return e.traer_disciplinas()}),e.crear_disciplina=function(){return e.creando=!0,t.one("disciplinas/store").customPOST().then(function(t){return t.editando=!0,e.disciplinasking.push(t),e.creando=!1,console.log("Disciplina creada",t)},function(t){return n.warning("No se creó la disciplina","Problema"),console.log("No se creó disciplina ",t),e.creando=!1})},e.cerrar_edicion=function(e){return e.editando=!1},e.editarDisciplina=function(e){return e.editando=!0},e.eliminarDisciplina=function(t){return r.open({templateUrl:o.views+"categorias/removeDisciplina.tpl.html",controller:"RemoveDisciplinaCtrl",resolve:{elemento:function(){return t}}}).result.then(function(t){return e.disciplinasking=i("filter")(e.disciplinasking,{id:"!"+t.id}),console.log("Resultado del modal: ",t)})},e.finalizar_edicion=function(t){return e.guardando(t),t.editando=!1},e.guardando=function(e){return t.all("disciplinas/guardar").customPUT(e).then(function(e){return n.success("Disciplina guardada."),console.log("Disciplina guardada: ",e)},function(e){return n.warning("No se pudo guardar la disciplina","Problema"),console.log("No se pudo guardar la disciplina ",e)})}}]).controller("RemoveDisciplinaCtrl",["$scope","$uibModalInstance","elemento","Restangular","toastr",function(e,t,n,r,o){return e.elemento=n,console.log("elemento",n),e.ok=function(){return r.all("disciplinas/destroy").customDELETE(n.id).then(function(e){return o.success("Disciplina eliminada con éxito.","Eliminado"),t.close(n)},function(e){return o.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("disciplinasDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}categorias/disciplinasDir.tpl.html`,scope:{idiomapreg:"=",eventoactual:"=",disciplinasking:"="},link:function(e,t,n){},controller:"DisciplinasCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("NivelesCtrl",["$scope","Restangular","toastr","$uibModal","App","$filter",function(e,t,n,r,o,i){return e.creando=!1,e.traer_niveles=function(){return t.all("niveles/niveles-usuario").getList().then(function(t){return e.nivelesking=t},function(e){return n.warning("No se trajeron las niveles","Problema"),console.log("No se trajo niveles ",e)})},e.traer_niveles(),e.$on("cambio_evento_user",function(){return e.traer_niveles()}),e.crear_nivel=function(){return e.creando=!0,t.one("niveles/store").customPOST().then(function(t){return t.editando=!0,e.nivelesking.push(t),e.creando=!1,console.log("Nivel creada",t)},function(t){return n.warning("No se creó el nivel","Problema"),console.log("No se creó nivel ",t),e.creando=!1})},e.cerrar_edicion=function(e){return e.editando=!1},e.editarNivel=function(e){return e.editando=!0},e.eliminarNivel=function(t){return r.open({templateUrl:o.views+"categorias/removeNivel.tpl.html",controller:"RemoveNivelCtrl",resolve:{elemento:function(){return t}}}).result.then(function(t){return e.nivelesking=i("filter")(e.nivelesking,{id:"!"+t.id}),console.log("Resultado del modal: ",t)})},e.finalizar_edicion=function(t){return e.guardando(t),t.editando=!1},e.guardando=function(e){return t.all("niveles/guardar").customPUT(e).then(function(e){return n.success("Nivel guardada."),console.log("Nivel guardada: ",e)},function(e){return n.warning("No se pudo guardar el nivel","Problema"),console.log("No se pudo guardar el nivel ",e)})}}]).controller("RemoveNivelCtrl",["$scope","$uibModalInstance","elemento","Restangular","toastr",function(e,t,n,r,o){return e.elemento=n,console.log("elemento",n),e.ok=function(){return r.all("niveles/destroy").customDELETE(n.id).then(function(e){return o.success("Nivel eliminado con éxito.","Eliminado"),t.close(n)},function(e){return o.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",e),t.dismiss("Error")})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("nivelesDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}categorias/nivelesDir.tpl.html`,scope:{idiomapreg:"=",eventoactual:"=",nivelesking:"="},link:function(e,t,n){},controller:"NivelesCtrl"}}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App",function(e,t){return e.state("panel.filemanager",{url:"/filemanager",views:{contenido_panel:{templateUrl:`${t.views}fileManager/fileManager.tpl.html`,controller:"FileManagerCtrl"}},data:{pageTitle:"Administrador de archivos"}})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("FileManagerCtrl",["$scope","Upload","$timeout","$filter","App","Restangular","Perfil","$uibModal","$mdDialog","resolved_user","toastr","AuthService",function(e,t,n,r,o,i,a,s,c,u,l,d){var p,g;e.USER=u,e.subir_intacta={intacta:!0},e.hasRoleOrPerm=d.hasRoleOrPerm,e.subirImagenes="nada",e.vm={},function(){e.dato={imgUsuario:{id:e.USER.imagen_id,nombre:e.USER.imagen_nombre}}}(),e.imagesPath=o.images,e.perfilPath=o.images+"perfil/",e.imgFiles=[],e.errorMsg="",e.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||!1!==FileAPI.html5),e.dato.usuarioElegido=[],i.one("imagenes/usuarios").customGET().then(function(t){return e.imagenes=t.imagenes,e.usuarios=t.usuarios,e.dato.usuarioElegido=t[0],e.dato.imgParaUsuario=t.imagenes.length>0?t.imagenes[0]:void 0},function(e){return l.error("No se trajeron las imágenes y usuarios.")}),e.uploadFoto=function(){var t;if(t=e.vm.picture)return t=t.replace(/^data\:image\/\w+\;base64\,/,""),i.one("imagenes/store").customPOST({foto:t}).then(function(e){return l.success("Foto subida correctamente.")},function(e){return l.error("No se pudo subir foto","Error")})},e.upload=function(t){var n,r,o,i,a;if(e.imgFiles=t,e.errorMsg="",t&&t.length){for(a=[],r=o=0,i=t.length;0<=i?o<i:o>i;r=0<=i?++o:--o)n=t[r],a.push(p(n));return a}},p=function(t){return e.errorMsg=null,g(t),e.generateThumb(t)},e.generateThumb=function(t){if(null!==t&&e.fileReaderSupported&&t.type.indexOf("image")>-1)return n(function(){var e;return(e=new FileReader).readAsDataURL(t),e.onload=function(e){return n(function(){return t.dataUrl=e.target.result})}})},g=function(n){var r;if(r=e.subir_intacta.intacta?"-intacta":"",!(n.size>1e7))return t.upload({url:o.Server+"api/imagenes/store"+r,file:n}).progress(function(e){var t;return t=parseInt(100*e.loaded/e.total),n.porcentaje=t}).success(function(t,n,r,o){return e.imagenes.push(t)}).error(function(e){return console.log("Falla uploading: ",e)}).xhr(function(e){});e.errorMsg="Archivo excede los 10MB permitidos."},e.pedirCambioUsuario=function(t){return i.one("imagenes/cambiar-imagen-perfil/"+e.USER.id).customPUT({imagen_id:t.id}).then(function(n){return a.setImagen(n.imagen_id,t.nombre),e.$emit("cambianImgs",{image:n}),l.success("Imagen principal cambiada")},function(e){return l.error("No se pudo cambiar imagen","Problema")})},e.cambiarLogo=function(e){return i.one("imagenes/cambiar-logo").customPUT({logo_id:e.id}).then(function(e){return l.success("Logo del colegio cambiado")},function(e){return l.error("No se pudo cambiar el logo","Problema")})},e.asignToUser=function(t,n){return s.open({controller:"AsignToUserCtrl",templateUrl:o.views+"fileManager/asignToUser.tpl.html",resolve:{usuarios:function(){return e.usuarios},perfilPath:function(){return e.perfilPath}}}).result.then(function(t){return e.cambiarFotoUnUsuario(t,n)})},e.imagenSelect=function(e,t){},e.fotoSelect=function(e,t){},e.rotarImagen=function(e){return i.one("imagenes/rotarimagen/"+e.id).customPUT().then(function(t){return e.nombre="",l.success("Imagen rotada"),e.nombre=t+"?"+(new Date).getTime()},function(e){return l.error("Imagen no rotada")})},e.borrarImagen=function(t){return s.open({templateUrl:o.views+"fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"sm",resolve:{imagen:function(){return t}}}).result.then(function(t){return e.imagenes=r("filter")(e.imagenes,{id:"!"+t.id})})},e.onCopyError=function(){return l.warning("No se pudo copiar")},e.onCopySuccess=function(){return l.success("Copiado")},e.usuarioSelect=function(t,n){return e.dato.selectUsuarioModel=t},e.cambiarFotoUnUsuario=function(e,t){var n;return n={imgUsuario:t.id},i.one("imagenes/cambiar-img-usuario/"+e.id).customPUT(n).then(function(n){return l.success("Imagen asignada con éxito"),e.imagen_id=t.id,e.imagen_nombre=t.nombre},function(e){return l.error("Error al asignar foto al usuario","Problema")})}}])}.call(this),function(){angular.module("WissenSystem").controller("RemoveImageCtrl",["$scope","$uibModalInstance","imagen","App","Restangular","AuthService","toastr",function(e,t,n,r,o,i,a){e.imagesPath=r.images+"perfil/",e.imagen=n,e.hasRoleOrPerm=i.hasRoleOrPerm,e.ok=function(){return o.one("imagenes/destroy/"+n.id).customDELETE().then(function(e){return a.success("La imagen ha sido removida.")},function(e){return a.error("No se pudo eliminar la imagen.")}),t.close(n)},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("AsignToUserCtrl",["$scope","$uibModalInstance","toastr","usuarios","perfilPath","App",function(e,t,n,r,o,i){e.usuarios=r,e.imagesPath=i.images,e.perfilPath=o,e.asignar=function(e){return t.close(e)},e.cancelar=function(){return t.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("MisImagenes",["$scope","$uibModalInstance","Upload","$timeout","$filter","App","Restangular","Perfil","$uibModal","$mdDialog","resolved_user","toastr","AuthService",function(e,t,n,r,o,i,a,s,c,u,l,d,p){var g,f;return e.USER=l,e.subir_intacta={intacta:!0},e.hasRoleOrPerm=p.hasRoleOrPerm,e.subirImagenes="nada",e.vm={},function(){return e.dato={imgUsuario:{id:e.USER.imagen_id,nombre:e.USER.imagen_nombre}}}(),e.imagesPath=i.images,e.perfilPath=i.images+"perfil/",e.imgFiles=[],e.errorMsg="",e.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||!1!==FileAPI.html5),e.dato.usuarioElegido=[],a.one("imagenes/usuarios").customGET().then(function(t){return e.imagenes=t.imagenes,e.usuarios=t.usuarios,e.dato.usuarioElegido=t[0],e.dato.imgParaUsuario=t.imagenes.length>0?t.imagenes[0]:void 0},function(e){return d.error("No se trajeron las imágenes y usuarios.")}),e.uploadFoto=function(){var n;if(n=e.vm.picture)return n=n.replace(/^data\:image\/\w+\;base64\,/,""),a.one("imagenes/store").customPOST({foto:n}).then(function(e){return d.success("Foto subida correctamente."),e.nombre="perfil/"+e.nombre,t.close(e)},function(e){return d.error("No se pudo subir foto","Error")})},e.elegirImagen=function(e){return t.close(e)},e.upload=function(t){var n,r,o,i,a;if(e.imgFiles=t,e.errorMsg="",t&&t.length){for(a=[],r=o=0,i=t.length;0<=i?o<i:o>i;r=0<=i?++o:--o)n=t[r],a.push(g(n));return a}},g=function(t){return e.errorMsg=null,f(t),e.generateThumb(t)},e.generateThumb=function(t){if(null!==t&&e.fileReaderSupported&&t.type.indexOf("image")>-1)return r(function(){var e;return(e=new FileReader).readAsDataURL(t),e.onload=function(e){return r(function(){return t.dataUrl=e.target.result})}})},f=function(t){var r;if(r=e.subir_intacta.intacta?"-intacta":"",!(t.size>1e7))return n.upload({url:i.Server+"api/imagenes/store"+r,file:t}).progress(function(e){var n;return n=parseInt(100*e.loaded/e.total),t.porcentaje=n}).success(function(t,n,r,o){return e.imagenes.push(t)}).error(function(e){return console.log("Falla uploading: ",e)}).xhr(function(e){});e.errorMsg="Archivo excede los 10MB permitidos."},e.pedirCambioUsuario=function(t){return a.one("imagenes/cambiar-imagen-perfil/"+e.USER.id).customPUT({imagen_id:t.id}).then(function(n){return s.setImagen(n.imagen_id,t.nombre),e.$emit("cambianImgs",{image:n}),d.success("Imagen principal cambiada")},function(e){return d.error("No se pudo cambiar imagen","Problema")})},e.cambiarLogo=function(e){return a.one("imagenes/cambiar-logo").customPUT({logo_id:e.id}).then(function(e){return d.success("Logo del colegio cambiado")},function(e){return d.error("No se pudo cambiar el logo","Problema")})},e.asignToUser=function(t,n){return c.open({controller:"AsignToUserCtrl",templateUrl:i.views+"fileManager/asignToUser.tpl.html",resolve:{usuarios:function(){return e.usuarios},perfilPath:function(){return e.perfilPath}}}).result.then(function(t){return e.cambiarFotoUnUsuario(t,n)})},e.rotarImagen=function(e){return a.one("imagenes/rotarimagen/"+e.id).customPUT().then(function(t){return e.nombre="",d.success("Imagen rotada"),e.nombre=t+"?"+(new Date).getTime()},function(e){return d.error("Imagen no rotada")})},e.borrarImagen=function(t){return c.open({templateUrl:i.views+"fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"sm",resolve:{imagen:function(){return t}}}).result.then(function(t){return e.imagenes=o("filter")(e.imagenes,{id:"!"+t.id})})},e.onCopyError=function(){return d.warning("No se pudo copiar")},e.onCopySuccess=function(){return d.success("Copiado")},e.usuarioSelect=function(t,n){return e.dato.selectUsuarioModel=t},e.cambiarFotoUnUsuario=function(e,t){var n;return n={imgUsuario:t.id},a.one("imagenes/cambiar-img-usuario/"+e.id).customPUT(n).then(function(n){return d.success("Imagen asignada con éxito"),e.imagen_id=t.id,e.imagen_nombre=t.nombre},function(e){return d.error("Error al asignar foto al usuario","Problema")})},e.ok=function(){return t.close("Cerrando...")},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),GridSampler={},GridSampler.checkAndNudgePoints=function(e,t){for(var n=qrcode.width,r=qrcode.height,o=!0,i=0;i<t.length&&o;i+=2){var a=Math.floor(t[i]),s=Math.floor(t[i+1]);if(-1>a||a>n||-1>s||s>r)throw"Error.checkAndNudgePoints ";o=!1,-1==a?(t[i]=0,o=!0):a==n&&(t[i]=n-1,o=!0),-1==s?(t[i+1]=0,o=!0):s==r&&(t[i+1]=r-1,o=!0)}o=!0;for(i=t.length-2;i>=0&&o;i-=2){a=Math.floor(t[i]),s=Math.floor(t[i+1]);if(-1>a||a>n||-1>s||s>r)throw"Error.checkAndNudgePoints ";o=!1,-1==a?(t[i]=0,o=!0):a==n&&(t[i]=n-1,o=!0),-1==s?(t[i+1]=0,o=!0):s==r&&(t[i+1]=r-1,o=!0)}},GridSampler.sampleGrid3=function(e,t,n){for(var r=new BitMatrix(t),o=new Array(t<<1),i=0;t>i;i++){for(var a=o.length,s=i+.5,c=0;a>c;c+=2)o[c]=.5+(c>>1),o[c+1]=s;n.transformPoints1(o),GridSampler.checkAndNudgePoints(e,o);try{for(c=0;a>c;c+=2){var u=4*Math.floor(o[c])+Math.floor(o[c+1])*qrcode.width*4,l=e[Math.floor(o[c])+qrcode.width*Math.floor(o[c+1])];qrcode.imagedata.data[u]=l?255:0,qrcode.imagedata.data[u+1]=l?255:0,qrcode.imagedata.data[u+2]=0,qrcode.imagedata.data[u+3]=255,l&&r.set_Renamed(c>>1,i)}}catch(e){throw"Error.checkAndNudgePoints"}}return r},GridSampler.sampleGridx=function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h,m,_){var v=PerspectiveTransform.quadrilateralToQuadrilateral(n,r,o,i,a,s,c,u,l,d,p,g,f,h,m,_);return GridSampler.sampleGrid3(e,t,v)},Version.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),Version.VERSIONS=buildVersions(),Version.getVersionForNumber=function(e){if(1>e||e>40)throw"ArgumentException";return Version.VERSIONS[e-1]},Version.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return Version.getVersionForNumber(e-17>>2)}catch(e){throw"Error getVersionForNumber"}},Version.decodeVersionInformation=function(e){for(var t=4294967295,n=0,r=0;r<Version.VERSION_DECODE_INFO.length;r++){var o=Version.VERSION_DECODE_INFO[r];if(o==e)return this.getVersionForNumber(r+7);var i=FormatInformation.numBitsDiffering(e,o);t>i&&(n=r+7,t=i)}return 3>=t?this.getVersionForNumber(n):null},PerspectiveTransform.quadrilateralToQuadrilateral=function(e,t,n,r,o,i,a,s,c,u,l,d,p,g,f,h){var m=this.quadrilateralToSquare(e,t,n,r,o,i,a,s);return this.squareToQuadrilateral(c,u,l,d,p,g,f,h).times(m)},PerspectiveTransform.squareToQuadrilateral=function(e,t,n,r,o,i,a,s){return dy2=s-i,dy3=t-r+i-s,0==dy2&&0==dy3?new PerspectiveTransform(n-e,o-n,e,r-t,i-r,t,0,0,1):(dx1=n-o,dx2=a-o,dx3=e-n+o-a,dy1=r-i,denominator=dx1*dy2-dx2*dy1,a13=(dx3*dy2-dx2*dy3)/denominator,a23=(dx1*dy3-dx3*dy1)/denominator,new PerspectiveTransform(n-e+a13*n,a-e+a23*a,e,r-t+a13*r,s-t+a23*s,t,a13,a23,1))},PerspectiveTransform.quadrilateralToSquare=function(e,t,n,r,o,i,a,s){return this.squareToQuadrilateral(e,t,n,r,o,i,a,s).buildAdjoint()};var FORMAT_INFO_MASK_QR=21522,FORMAT_INFO_DECODE_LOOKUP=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),BITS_SET_IN_HALF_BYTE=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);FormatInformation.numBitsDiffering=function(e,t){return BITS_SET_IN_HALF_BYTE[15&(e^=t)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,4)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,8)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,12)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,16)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,20)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,24)]+BITS_SET_IN_HALF_BYTE[15&URShift(e,28)]},FormatInformation.decodeFormatInformation=function(e){var t=FormatInformation.doDecodeFormatInformation(e);return null!=t?t:FormatInformation.doDecodeFormatInformation(e^FORMAT_INFO_MASK_QR)},FormatInformation.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,r=0;r<FORMAT_INFO_DECODE_LOOKUP.length;r++){var o=FORMAT_INFO_DECODE_LOOKUP[r],i=o[0];if(i==e)return new FormatInformation(o[1]);var a=this.numBitsDiffering(e,i);t>a&&(n=o[1],t=a)}return 3>=t?new FormatInformation(n):null},ErrorCorrectionLevel.forBits=function(e){if(0>e||e>=FOR_BITS.length)throw"ArgumentException";return FOR_BITS[e]};var L=new ErrorCorrectionLevel(0,1,"L"),M=new ErrorCorrectionLevel(1,0,"M"),Q=new ErrorCorrectionLevel(2,3,"Q"),H=new ErrorCorrectionLevel(3,2,"H"),FOR_BITS=new Array(M,L,H,Q);DataBlock.getDataBlocks=function(e,t,n){if(e.length!=t.TotalCodewords)throw"ArgumentException";for(var r=t.getECBlocksForLevel(n),o=0,i=r.getECBlocks(),a=0;a<i.length;a++)o+=i[a].Count;for(var s=new Array(o),c=0,u=0;u<i.length;u++){var l=i[u];for(a=0;a<l.Count;a++){var d=l.DataCodewords,p=r.ECCodewordsPerBlock+d;s[c++]=new DataBlock(d,new Array(p))}}for(var g=s[0].codewords.length,f=s.length-1;f>=0;){if(s[f].codewords.length==g)break;f--}f++;var h=g-r.ECCodewordsPerBlock,m=0;for(a=0;h>a;a++)for(u=0;c>u;u++)s[u].codewords[a]=e[m++];for(u=f;c>u;u++)s[u].codewords[h]=e[m++];var _=s[0].codewords.length;for(a=h;_>a;a++)for(u=0;c>u;u++){var v=f>u?a:a+1;s[u].codewords[v]=e[m++]}return s},DataMask={},DataMask.forReference=function(e){if(0>e||e>7)throw"System.ArgumentException";return DataMask.DATA_MASKS[e]},DataMask.DATA_MASKS=new Array(new DataMask000,new DataMask001,new DataMask010,new DataMask011,new DataMask100,new DataMask101,new DataMask110,new DataMask111),GF256.QR_CODE_FIELD=new GF256(285),GF256.DATA_MATRIX_FIELD=new GF256(301),GF256.addOrSubtract=function(e,t){return e^t},Decoder={},Decoder.rsDecoder=new ReedSolomonDecoder(GF256.QR_CODE_FIELD),Decoder.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),o=0;n>o;o++)r[o]=255&e[o];var i=e.length-t;try{Decoder.rsDecoder.decode(r,i)}catch(e){throw e}for(o=0;t>o;o++)e[o]=r[o]},Decoder.decode=function(e){for(var t=new BitMatrixParser(e),n=t.readVersion(),r=t.readFormatInformation().ErrorCorrectionLevel,o=t.readCodewords(),i=DataBlock.getDataBlocks(o,n,r),a=0,s=0;s<i.length;s++)a+=i[s].NumDataCodewords;for(var c=new Array(a),u=0,l=0;l<i.length;l++){var d=i[l],p=d.Codewords,g=d.NumDataCodewords;Decoder.correctErrors(p,g);for(s=0;g>s;s++)c[u++]=p[s]}return new QRCodeDataBlockReader(c,n.VersionNumber,r.Bits)},qrcode={},qrcode.imagedata=null,qrcode.width=0,qrcode.height=0,qrcode.qrCodeSymbol=null,qrcode.debug=!1,qrcode.maxImgSize=1048576,qrcode.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],qrcode.callback=null,qrcode.decode=function(e){if(0==arguments.length){var t=document.getElementById("qr-canvas"),n=t.getContext("2d");return qrcode.width=t.width,qrcode.height=t.height,qrcode.imagedata=n.getImageData(0,0,qrcode.width,qrcode.height),qrcode.result=qrcode.process(n),null!=qrcode.callback&&qrcode.callback(qrcode.result),qrcode.result}var r=new Image;r.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=r.height,o=r.width;if(r.width*r.height>qrcode.maxImgSize){var i=r.width/r.height;o=i*(n=Math.sqrt(qrcode.maxImgSize/i))}e.width=o,e.height=n,t.drawImage(r,0,0,e.width,e.height),qrcode.width=e.width,qrcode.height=e.height;try{qrcode.imagedata=t.getImageData(0,0,e.width,e.height)}catch(e){return qrcode.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=qrcode.callback&&qrcode.callback(qrcode.result))}try{qrcode.result=qrcode.process(t)}catch(e){console.log(e),qrcode.result="error decoding QR Code"}null!=qrcode.callback&&qrcode.callback(qrcode.result)},r.src=e},qrcode.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},qrcode.decode_url=function(e){var t="";try{t=escape(e)}catch(n){console.log(n),t=e}var n="";try{n=decodeURIComponent(t)}catch(e){console.log(e),n=t}return n},qrcode.decode_utf8=function(e){return qrcode.isUrl(e)?qrcode.decode_url(e):e},qrcode.process=function(e){var t=(new Date).getTime(),n=qrcode.grayScaleToBitmap(qrcode.grayscale());if(qrcode.debug){for(var r=0;r<qrcode.height;r++)for(var o=0;o<qrcode.width;o++){var i=4*o+r*qrcode.width*4;qrcode.imagedata.data[i]=(n[o+r*qrcode.width],0),qrcode.imagedata.data[i+1]=(n[o+r*qrcode.width],0),qrcode.imagedata.data[i+2]=n[o+r*qrcode.width]?255:0}e.putImageData(qrcode.imagedata,0,0)}var a=new Detector(n).detect();qrcode.debug&&e.putImageData(qrcode.imagedata,0,0);for(var s=Decoder.decode(a.bits).DataByte,c="",u=0;u<s.length;u++)for(var l=0;l<s[u].length;l++)c+=String.fromCharCode(s[u][l]);var d=(new Date).getTime()-t;return console.log(d),qrcode.decode_utf8(c)},qrcode.getPixel=function(e,t){if(qrcode.width<e)throw"point error";if(qrcode.height<t)throw"point error";return point=4*e+t*qrcode.width*4,p=(33*qrcode.imagedata.data[point]+34*qrcode.imagedata.data[point+1]+33*qrcode.imagedata.data[point+2])/100,p},qrcode.binarize=function(e){for(var t=new Array(qrcode.width*qrcode.height),n=0;n<qrcode.height;n++)for(var r=0;r<qrcode.width;r++){var o=qrcode.getPixel(r,n);t[r+n*qrcode.width]=e>=o}return t},qrcode.getMiddleBrightnessPerArea=function(e){for(var t=Math.floor(qrcode.width/4),n=Math.floor(qrcode.height/4),r=new Array(4),o=0;4>o;o++){r[o]=new Array(4);for(var i=0;4>i;i++)r[o][i]=new Array(0,0)}for(var a=0;4>a;a++)for(var s=0;4>s;s++){r[s][a][0]=255;for(var c=0;n>c;c++)for(var u=0;t>u;u++){var l=e[t*s+u+(n*a+c)*qrcode.width];l<r[s][a][0]&&(r[s][a][0]=l),l>r[s][a][1]&&(r[s][a][1]=l)}}for(var d=new Array(4),p=0;4>p;p++)d[p]=new Array(4);for(a=0;4>a;a++)for(s=0;4>s;s++)d[s][a]=Math.floor((r[s][a][0]+r[s][a][1])/2);return d},qrcode.grayScaleToBitmap=function(e){for(var t=qrcode.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(qrcode.width/n),o=Math.floor(qrcode.height/n),i=new Array(qrcode.height*qrcode.width),a=0;n>a;a++)for(var s=0;n>s;s++)for(var c=0;o>c;c++)for(var u=0;r>u;u++)i[r*s+u+(o*a+c)*qrcode.width]=e[r*s+u+(o*a+c)*qrcode.width]<t[s][a];return i},qrcode.grayscale=function(){for(var e=new Array(qrcode.width*qrcode.height),t=0;t<qrcode.height;t++)for(var n=0;n<qrcode.width;n++){var r=qrcode.getPixel(n,t);e[n+t*qrcode.width]=r}return e},Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=0>e?this.length+e:e,this.push.apply(this,n)};var MIN_SKIP=3,MAX_MODULES=57,INTEGER_MATH_SHIFT=8,CENTER_QUORUM=2;qrcode.orderBestPatterns=function(e){function t(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)}var n,r,o,i=t(e[0],e[1]),a=t(e[1],e[2]),s=t(e[0],e[2]);if(a>=i&&a>=s?(r=e[0],n=e[1],o=e[2]):s>=a&&s>=i?(r=e[1],n=e[0],o=e[2]):(r=e[2],n=e[0],o=e[1]),function(e,t,n){var r=t.x,o=t.y;return(n.x-r)*(e.y-o)-(n.y-o)*(e.x-r)}(n,r,o)<0){var c=n;n=o,o=c}e[0]=n,e[1]=r,e[2]=o},function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(e,t,n){return t.state("qrscanner",{url:"/qrscanner",views:{principal:{templateUrl:`${e.views}qrcode/qrScanner.tpl.html`,controller:"QrScannerCtrl"}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}]},data:{pageTitle:"QR Scanner"}})}])}.call(this),function(){angular.module("WissenSystem").controller("QrScannerCtrl",["$scope","Restangular","toastr","resolved_user","App","AuthService","MySocket",function(e,t,n,r,o,i,a){return e.USER=r,e.imagesPath=o.images,e.esperando=!1,e.usuarios=[],e.selectedUser={},i.verificar_acceso(),e.onSuccess=function(r){var o;if(!e.esperando)return n.info("Reconocido..."),e.esperando=!0,o={code:r},e.selectedUser.id&&(o.user_id=e.selectedUser.id),t.one("qr").customPOST(o).then(function(t){return t.res?"no_encontrado"===t.res&&n.warning("Código NO encontrado en la base de datos"):t.accepted?(e.selectedUser.id?a.got_qr(t,e.selectedUser.id):a.got_qr(t),n.success('Código acceptado: "'+t.comando+'"')):n.warning("Código NO aceptado","Tal vez ya ha sido usado antes"),setTimeout(function(){return e.esperando=!1},3e3)},function(t){return n.warning("No se pudo reconocer el código qr"),console.log("No se pudo reconocer el código qr ",t),e.esperando=!1})},e.onError=function(t){return e.errorqr=t},e.onVideoError=function(t){return e.errorqr=t},e.seleccionarUsu=function(t){var n,r,o,i,a;if(t.seleccionado=!t.seleccionado,t.seleccionado){for(e.selectedUser=t,i=[],n=0,r=(o=e.usuarios).length;n<r;n++)(a=o[n]).id!==t.id?i.push(a.seleccionado=!1):i.push(void 0);return i}},e.seleccionarCkUsu=function(t){var n,r,o,i,a;if(t.seleccionado){for(e.selectedUser=t,i=[],n=0,r=(o=e.usuarios).length;n<r;n++)(a=o[n]).id!==t.id?i.push(a.seleccionado=!1):i.push(void 0);return i}},t.all("usuarios").getList().then(function(t){return e.usuarios=t})}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(e,t,n,r,o){e.state("proyectando",{url:"/proyectando",views:{principal:{templateUrl:`${t.views}proyectando/proyectando.tpl.html`,controller:"ProyectandoCtrl"}},resolve:{resolved_user:["AuthService",function(e){return e.verificar()}]},data:{pageTitle:"WissenSystem - Proyectando"}}).state("proyectando.participantes",{url:"^/participantes",views:{contenido_panel:{templateUrl:`${t.views}proyectando/participantes.tpl.html`,controller:"ParticipantesCtrl"}},data:{pageTitle:"Participantes"}}).state("proyectando.puntajes_actuales",{url:"^/puntajes_actuales",views:{contenido_panel:{templateUrl:`${t.views}proyectando/puntajes_actuales.tpl.html`,controller:"PuntajesActualesCtrl"}},data:{pageTitle:"Puntajes actuales"}}).state("proyectando.grafico_barras",{url:"^/grafico_barras",views:{contenido_panel:{templateUrl:`${t.views}proyectando/grafico_barras.tpl.html`,controller:"GraficoBarrasCtrl"}},data:{pageTitle:"Gráfico de participantes"}}).state("proyectando.question",{url:"^/question",views:{contenido_panel:{templateUrl:`${t.views}proyectando/question.tpl.html`,controller:"SCQuestionCtrl"}},data:{pageTitle:"Pregunta"}}).state("proyectando.puntaje_particip",{url:"^/puntaje_particip",views:{contenido_panel:{templateUrl:`${t.views}proyectando/puntajeParticip.tpl.html`,controller:"SCPuntajeParticipCtrl"}},data:{pageTitle:"Puntaje Participante"}}),o.preferredLanguage("ES"),o.translations("EN",{INICIO_MENU:"Home",USERS_MENU:"Users",EVENTS_MENU:"Events",ENTIDADES_MENU:"Entities",CATEGS_MENU:"Categories",PREGUNTAS_MENU:"Questions",EVALUACIONES_MENU:"Tests",IDIOMA_MENU:"Language",INFORMES_MENU:"Reports",CONTROL_MENU:"Monitoring",SCANNER_MENU:"QR Scanner",SALIR:"Sign out",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Great ultimate",INSCRITO_EN:"You are signed in:",NO_ESTAS_INSCRITO:"You are`t signed in any category.",EXAM_HECHOS:"Done Exams"}).translations("ES",{INICIO_MENU:"Inicio",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorías",PREGUNTAS_MENU:"Preguntas",EVALUACIONES_MENU:"Evaluaciones",USERS_MENU:"Usuarios",IDIOMA_MENU:"Idioma",INFORMES_MENU:"Informes",CONTROL_MENU:"Control",SCANNER_MENU:"Escaner QR",SALIR:"Salir",ELIMINATORIAS:"Eliminatorias",GRAN_FINAL:"Gran final",INSCRITO_EN:"Estás inscrito en:",NO_ESTAS_INSCRITO:"No estás inscrito en ninguna categoría.",EXAM_HECHOS:"Exámenes hechos"}).translations("PT",{INICIO_MENU:"Iniciação",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorias",PREGUNTAS_MENU:"Interrogatório",EVALUACIONES_MENU:"Evaluations",USERS_MENU:"Usuários",IDIOMA_MENU:"Língua",INFORMES_MENU:"Informação",CONTROL_MENU:"Controle",SCANNER_MENU:"QR Scanner",SALIR:"Deixar",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Grande final",INSCRITO_EN:"Você está matriculado:",NO_ESTAS_INSCRITO:"Você não está registrado em qualquer categoria.",EXAM_HECHOS:"Testes feitos"}).translations("FR",{INICIO_MENU:"Initiation",EVENTS_MENU:"Événements",ENTIDADES_MENU:"Entités",CATEGS_MENU:"Catégories",PREGUNTAS_MENU:"Questionnement",EVALUACIONES_MENU:"Evaluations",USERS_MENU:"Utilisateurs",IDIOMA_MENU:"Langue",INFORMES_MENU:"Rapports",CONTROL_MENU:"Contrôle",SCANNER_MENU:"QR Scanner",SALIR:"Laisser",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Grande finale",INSCRITO_EN:"Vous êtes inscrit à:",NO_ESTAS_INSCRITO:"Vous n'êtes pas inscrit dans aucune catégorie.",EXAM_HECHOS:"Tests effectués"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("ProyectandoCtrl",["$scope","Restangular","$state","$stateParams","$rootScope","AuthService","App","resolved_user","$filter","MySocket","SocketData","Fullscreen",function(e,t,n,r,o,i,a,s,c,u,l,d){e.SocketData=l,e.examen=l.config.puntaje_to_show,e.USER=s,e.imagesPath=a.images,i.verificar_acceso(),e.categorias_traducidas=c("categoriasTraducidas")(e.USER.categorias_evento,e.USER.idioma_main_id),o.reload=function(){return n.go(n.current,r,{reload:!0})},e.setFullScreen=function(){return d.toggleAll()},e.openMenu=function(e,t){return t,e(t)},e.logout=function(){return u.desloguear(),i.logout(),e.in_evento_actual={},t.one("login/logout").customPUT().then(function(e){return console.log("Desconectado con éxito: ",e)},function(e){return console.log("Error desconectando!",e)})},o.$on("me_desloguearon",function(t,n){return e.logout()})}])}.call(this),function(){angular.module("WissenSystem").controller("ParticipantesCtrl",["$scope","$rootScope","App","SocketData","SocketClientes","$filter","MySocket","$timeout",function(e,t,n,r,o,i,a,s){a.get_clts(),e.SocketData=r,e.SocketClientes=o,e.participantesDeCategoria=function(e){return i("filter")(o.clientes,{logged:!0,categsel:e.categoria_id},!0)}}]).controller("PuntajesActualesCtrl",["$scope","$rootScope","App","SocketData","SocketClientes","$filter","MySocket","$timeout",function(e,t,n,r,o,i,a,s){e.examenes_cargados=function(){return t.examenes_cargados?t.examenes_cargados:[]}}]).controller("GraficoBarrasCtrl",["$scope","$rootScope","App","SocketData","SocketClientes","$filter","MySocket",function(e,t,n,r,o,i,a){var s;a.get_clts(),e.SocketData=r,e.participantes=[],e.participantes_actuales=function(){return o.participantes},e.participantes_en_categorias=function(){return function(e){return e.categsel>0}},e.calc_indice=function(e){return e<=7?e:e>7&&e<=14?e-7:e>14&&e<=21?e-14:e>21&&e<=28?e-21:e>28&&e<=35?e-28:e>35&&e<=42?e-35:1},e.calc_porcentaje=function(e){var t,n;return-1===(n=r.config.info_evento.free_till_question)||0===n?100:0===(t=100*e/n)?1:t>100?100:t},s=t.$on("set_free_till_question",function(t,n){return e.$apply()}),e.$on("$destroy",function(){return s()})}]).controller("SCPuntajeParticipCtrl",["$scope","$rootScope","Perfil","App","SocketData","toastr","$translate","$filter","$uibModal","MySocket",function(e,t,n,r,o,i,a,s,c,u){e.SocketData=o}])}.call(this),function(){angular.module("WissenSystem").controller("SCQuestionCtrl",["$scope","$http","Restangular","$state","MySocket","$rootScope","AuthService","Perfil","App","resolved_user","SocketData","$filter",function(e,t,n,r,o,i,a,s,c,u,l,d){e.MySocket=o,e.SocketData=l,e.indexChar=function(e){return String.fromCharCode(65+e)},e.opcion_elegida=-1,o.on("selec_opc_in_question",function(t){var n,r,o,i,a,s;for(e.opcion_elegida=t.opcion,s=[],r=n=0,o=(a=l.config.pregunta.opciones).length;n<o;r=++n)(i=a[r]).revelada_acertada=!1,i.revelada_no_acertada=!1,t.opcion===r?s.push(i.elegida=!0):s.push(i.elegida=!1);return s}),o.on("sc_reveal_answer",function(t){var n,r,o,i,a,s;for(s=[],r=n=0,o=(a=l.config.pregunta.opciones).length;n<o;r=++n)(i=a[r]).is_correct?r===e.opcion_elegida?(i.revelada_acertada=!0,s.push(i.revelada_no_acertada=!1)):(i.revelada_acertada=!1,s.push(i.revelada_no_acertada=!0)):s.push(void 0);return s})}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(e,t,n,r,o){e.state("panel.informes",{url:"^/informes/",views:{contenido_panel:{templateUrl:`${t.views}informes/informes.tpl.html`,controller:"InformesCtrl"}},resolve:{datos:["$q","Restangular","$stateParams",function(e,t,n){var r;return r=e.defer(),t.one("informes-infor/datos").customPUT().then(function(e){return r.resolve(e)},function(e){return r.reject(e)}),r.promise}]},data:{pageTitle:"Informes"}}).state("panel.informes.ver_todos_los_examenes",{url:"ver_todos_los_examenes?gran_final&evento_id",params:{gran_final:null,evento_id:null},views:{report_content:{templateUrl:`${t.views}informes/verTodosLosExamenes.tpl.html`,controller:"VerTodosLosExamenesCtrl",resolve:{examenes:["Restangular","$stateParams",function(e,t){return e.all("informes/todos-los-examenes").getList({gran_final:t.gran_final,evento_id:t.evento_id})}]}}},data:{pageTitle:"Todos los Examenes - Wissen"}}).state("panel.informes.ver_todos_los_examenes_por_entidades",{url:"ver_todos_los_examenes_por_entidades?gran_final&evento_id",params:{gran_final:null,evento_id:null},views:{report_content:{templateUrl:`${t.views}informes/verTodosLosExamenesPorEnt.tpl.html`,controller:"VerTodosLosExamenesPorEntCtrl",resolve:{entidades:["Restangular","$stateParams",function(e,t){var n,r;return n={gran_final:t.gran_final,evento_id:t.evento_id},localStorage.requested_entidades&&(r=JSON.parse(localStorage.requested_entidades)).length>0&&(n.requested_entidades=r),e.one("puestos/todos-examenes-ent").customPUT(n)}]}}},data:{pageTitle:"Todos los exámenes por entidades - Wissen"}}).state("panel.informes.ver_examenes_por_entidades_categorias",{url:"ver_examenes_por_entidades_categorias?gran_final&evento_id",params:{gran_final:null,evento_id:null},views:{report_content:{templateUrl:`${t.views}informes/verExamenesPorEntCateg.tpl.html`,controller:"VerExamenesPorEntidadesCtrl",resolve:{entidades:["Restangular","$stateParams",function(e,t){var n,r,o;return n={gran_final:t.gran_final,evento_id:t.evento_id},localStorage.requested_entidades&&(o=JSON.parse(localStorage.requested_entidades)).length>0&&(n.requested_entidades=o),localStorage.requested_categorias&&(r=JSON.parse(localStorage.requested_categorias)).length>0&&(n.requested_categorias=r),e.one("puestos/examenes-ent-categ").customPUT(n)}]}}},data:{pageTitle:"Exámenes por entidades - Wissen"}}).state("panel.informes.ver_examenes_por_categorias",{url:"ver_examenes_por_categorias?gran_final&evento_id",params:{gran_final:null,evento_id:null},views:{report_content:{templateUrl:`${t.views}informes/verExamenesPorCategorias.tpl.html`,controller:"VerExamenesPorCategoriasCtrl",resolve:{categorias:["Restangular","$stateParams",function(e,t){var n,r,o;return n={gran_final:t.gran_final,evento_id:t.evento_id},localStorage.requested_entidades&&(o=JSON.parse(localStorage.requested_entidades)).length>0&&(n.requested_entidades=o),localStorage.requested_categorias&&(r=JSON.parse(localStorage.requested_categorias)).length>0&&(n.requested_categorias=r),e.one("puestos/examenes-categorias").customPUT(n)}]}}},data:{pageTitle:"Exámenes por categorías - Wissen"}}),o.translations("EN",{INICIO_MENU:"Home"}).translations("ES",{INICIO_MENU:"Inicio"}).translations("PT",{INICIO_MENU:"Inicio"}).translations("FR",{INICIO_MENU:"Inicio"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("InformesCtrl",["$scope","$http","Restangular","$state","$rootScope","toastr","datos","$filter","$uibModal","App",function(e,t,n,r,o,i,a,s,c,u){var l,d,p,g;for(e.eventos_infor=a.eventos,e.selected={entidades:[],categorias:[]},e.sortType="promedio",e.sortReverse=!1,e.searchExam="",e.saveConfig=function(){return localStorage.config=JSON.stringify(e.config)},localStorage.config?(localStorage.config.gran_final&&(e.config.gran_final=!1),localStorage.config.orientacion&&(e.config.orientacion="vertical"),localStorage.config.todas_entidades&&(e.config.todas_entidades=!1),localStorage.config.todas_categorias&&(e.config.todas_categorias=!1),e.config=JSON.parse(localStorage.config)):(e.config={gran_final:!1,orientacion:"vertical",todas_entidades:!1,todas_categorias:!1},e.saveConfig()),localStorage.requested_entidades&&(e.selected.entidades=JSON.parse(localStorage.requested_entidades)),localStorage.requested_categorias&&(e.selected.categorias=JSON.parse(localStorage.requested_categorias)),d=0,p=(g=e.eventos_infor).length;d<p;d++)(l=g[d]).actual&&(e.selected.evento_id=l.id,e.selected.evento=l,e.selected.categorias_cargadas=l.categorias);return e.cargar_entidades_categorias=function(){var t,n,r,o;for(o=[],t=0,n=(r=e.eventos_infor).length;t<n;t++)(l=r[t]).id===selected.evento_id?(e.selected.evento=l,o.push(e.selected.categorias_cargadas=l.categorias)):o.push(void 0);return o},e.cargar_evaluaciones=function(t){var n,r,o,i,a;for(e.selected.categoria=t,e.selected.evaluaciones=[],a=[],r=0,o=(i=t.evaluaciones).length;r<o;r++)(n=i[r]).actual&&(e.selected.evaluacion=n,n.selected=!0),a.push(e.selected.evaluaciones.push(n));return a},e.cargar_preguntas=function(t){var n,r,o,i,a,s,c,u,l,d;for(e.selected.evaluacion=t,e.selected.preguntas=[],r=0,i=(u=e.selected.evaluaciones).length;r<i;r++)(n=u[r]).selected=t===n;for(d=[],o=0,a=(l=t.preguntas_evaluacion).length;o<a;o++)s=l[o],d.push(function(){var t,n,r,o;for(o=[],t=0,n=(r=s.preguntas_traducidas).length;t<n;t++)(c=r[t]).idioma_id===e.USER.idioma_main_id?(c.tipo_pregunta=s.tipo_pregunta,o.push(e.selected.preguntas.push(c))):o.push(void 0);return o}());return d},e.tabSeleccionado=function(t){return e.config.tab_seleccionado=t,e.saveConfig()},e.$watch("config.orientacion",function(){return e.saveConfig()}),e.$watch("config.gran_final",function(){return e.saveConfig()}),e.$watch("config.todas_entidades",function(){return e.saveConfig()}),e.$watch("config.todas_categorias",function(){return e.saveConfig()}),e.cargarResultados=function(){return n.one("puestos/calcular-resultados").customPUT({gran_final:e.config.gran_final,evento_id:e.selected.evento_id}).then(function(e){return i.success("Calculados con éxito")},function(e){return i.error("No se pudo calcular")})},e.traerTodosLosExamenes=function(){return console.log("Entra"),r.go("panel.informes.ver_todos_los_examenes",{gran_final:e.config.gran_final,evento_id:e.selected.evento_id})},e.traerTodosLosExamenesPorEntidades=function(){return e.config.todas_entidades?delete localStorage.requested_entidades:localStorage.requested_entidades=JSON.stringify(e.selected.entidades),r.go("panel.informes.ver_todos_los_examenes_por_entidades",{gran_final:e.config.gran_final,evento_id:e.selected.evento_id},{reload:!0})},e.traerExamenesEntidadesCategorias=function(){return e.config.todas_entidades?delete localStorage.requested_entidades:localStorage.requested_entidades=JSON.stringify(e.selected.entidades),e.config.todas_categorias?delete localStorage.requested_categorias:localStorage.requested_categorias=JSON.stringify(e.selected.categorias),r.go("panel.informes.ver_examenes_por_entidades_categorias",{gran_final:e.config.gran_final,evento_id:e.selected.evento_id},{reload:!0})},e.traerExamenesCategorias=function(){return e.config.todas_entidades?delete localStorage.requested_entidades:localStorage.requested_entidades=JSON.stringify(e.selected.entidades),e.config.todas_categorias?delete localStorage.requested_categorias:localStorage.requested_categorias=JSON.stringify(e.selected.categorias),r.go("panel.informes.ver_examenes_por_categorias",{gran_final:e.config.gran_final,evento_id:e.selected.evento_id},{reload:!0})},e.traerExamenesCategoria=function(){var t;return e.$parent.cmdCategSelected.id?(t=e.$parent.cmdCategSelected.id,n.all("informes/examenes-categoria").getList({gran_final:e.gran_final,categoria_id:t}).then(function(t){return e.categorias=t,e.mostrando="por_categorias"},function(e){return i.warning("No se trajeron los exámenes por entidad y categorías","Problema"),console.log("No se trajeron los exámenes por entidad y categorías ",e)})):i.warning("Selecciona una categoría.")},e.mostrarPuesto=function(e,t,n){return e.puesto=t,n&&(e.logo_nombre=n.logo_nombre,e.alias_entidad=n.alias_entidad,e.nombre_entidad=n.nombre_entidad,e.lider_nombre=n.lider_nombre),MySocket.sc_show_puntaje_examen(e)},e.eliminarExamen=function(t){return c.open({templateUrl:u.views+"informes/seguroEliminExam.tpl.html",controller:"SeguroEliminExamCtrl",resolve:{examen:function(){return t}}}).result.then(function(n){var r,o;if(i.success("Examen de "+t.nombres+" "+t.apellidos+" eliminado."),e.examenes=s("filter")(e.examenes,{examen_id:"!"+n.id}),(o=s("filter")(e.entidades,{entidad_id:t.entidad_id})[0])&&(o.examenes&&(o.examenes=s("filter")(o.examenes,{examen_id:"!"+n.id})),o.categorias&&((r=s("filter")(o.categorias,{categoria_id:t.categoria_id})[0]).examenes=s("filter")(r.examenes,{examen_id:"!"+n.id}))),(r=s("filter")(e.categorias,{categoria_id:t.categoria_id})[0])&&r.examenes)return r.examenes=s("filter")(r.examenes,{examen_id:"!"+n.id})})}}])}.call(this),function(){"use strict";angular.module("WissenSystem").directive("puestosDir",["App",function(e){return{restrict:"E",templateUrl:`${e.views}informes/puestosDir.tpl.html`,controller:"PuestosDirCtrl"}}]).controller("PuestosDirCtrl",["$scope","Restangular","toastr","$filter","MySocket","SocketData","$uibModal","App",function(e,t,n,r,o,i,a,s){return e.SocketData=i,e.mostrando=!1,e.sortType="promedio",e.sortReverse=!1,e.searchExam="",e.gran_final=!0,e.traerTodosLosExamenes=function(){return t.all("informes/todos-los-examenes").getList({gran_final:e.gran_final}).then(function(t){return e.examenes=t,e.mostrando="todos"},function(e){return n.warning("No se trajeron los exámenes","Problema"),console.log("No se trajeron los exámenes ",e)})},e.traerExamenesEntidades=function(){return t.all("informes/examenes-entidades").getList({gran_final:e.gran_final}).then(function(t){return e.entidades=t,e.mostrando="por_entidades"},function(e){return n.warning("No se trajeron los exámenes por entidad","Problema"),console.log("No se trajeron los exámenes por entidad",e)})},e.traerExamenesEntidadesCategorias=function(){return t.all("informes/examenes-entidades-categorias").getList({gran_final:e.gran_final}).then(function(t){return e.entidades=t,e.mostrando="por_entidades_categorias"},function(e){return n.warning("No se trajeron los exámenes por entidad y categorías","Problema"),console.log("No se trajeron los exámenes por entidad y categorías ",e)})},e.traerExamenesCategorias=function(){return t.all("informes/examenes-categorias").getList({gran_final:e.gran_final}).then(function(t){return e.categorias=t,e.mostrando="por_categorias"},function(e){return n.warning("No se trajeron los exámenes por entidad y categorías","Problema"),console.log("No se trajeron los exámenes por entidad y categorías ",e)})},e.traerExamenesCategoria=function(){var r;return e.$parent.cmdCategSelected.id?(r=e.$parent.cmdCategSelected.id,t.all("informes/examenes-categoria").getList({gran_final:e.gran_final,categoria_id:r}).then(function(t){return e.categorias=t,e.mostrando="por_categorias"},function(e){return n.warning("No se trajeron los exámenes por entidad y categorías","Problema"),console.log("No se trajeron los exámenes por entidad y categorías ",e)})):n.warning("Selecciona una categoría.")},e.mostrarPuesto=function(e,t,n){var r;return r={},angular.copy(e,r),r.puesto=t,n&&(r.logo_nombre=n.logo_nombre,r.alias_entidad=n.alias_entidad,r.nombre_entidad=n.nombre_entidad,r.lider_nombre=n.lider_nombre),o.sc_show_puntaje_examen(r)},e.eliminarExamen=function(t){return a.open({templateUrl:s.views+"informes/seguroEliminExam.tpl.html",controller:"SeguroEliminExamCtrl",resolve:{examen:function(){return t}}}).result.then(function(o){var i,a;if(n.success("Examen de "+t.nombres+" "+t.apellidos+" eliminado."),e.examenes=r("filter")(e.examenes,{examen_id:"!"+o.id}),(a=r("filter")(e.entidades,{entidad_id:t.entidad_id})[0])&&(a.examenes&&(a.examenes=r("filter")(a.examenes,{examen_id:"!"+o.id})),a.categorias&&((i=r("filter")(a.categorias,{categoria_id:t.categoria_id})[0]).examenes=r("filter")(i.examenes,{examen_id:"!"+o.id}))),(i=r("filter")(e.categorias,{categoria_id:t.categoria_id})[0])&&i.examenes)return i.examenes=r("filter")(i.examenes,{examen_id:"!"+o.id})})}}])}.call(this),function(){angular.module("WissenSystem").controller("SeguroEliminExamCtrl",["$scope","$uibModalInstance","examen","Restangular","toastr","$state",function(e,t,n,r,o,i){return e.examen=n,e.ok=function(){return e.asignando=!0,r.all("examenes_respuesta/destroy/"+n.examen_id).customDELETE().then(function(e){return t.close(e)},function(e){return o.warning("No se pudo eliminar examen.","Problema"),console.log("Error eliminando el examen: ",e)})},e.cancel=function(){return t.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("VerTodosLosExamenesCtrl",["$scope","Restangular","toastr","$filter","$uibModal","App","examenes",function(e,t,n,r,o,i,a){return e.examenes=a}]).controller("VerTodosLosExamenesPorEntCtrl",["$scope","Restangular","toastr","$filter","$uibModal","App","entidades",function(e,t,n,r,o,i,a){return e.entidades=a}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("VerExamenesPorEntidadesCtrl",["$scope","Restangular","toastr","$filter","$uibModal","App","entidades",function(e,t,n,r,o,i,a){var s,c,u,l,d,p,g,f,h,m;for(d=localStorage.texto_informativo_informe,e.texto_informativo=d||"<center>Los finalistas deben presentarse en <b>LA GRAN FINAL</b> el día jueves <b>28 de septiembre</b> a las <u>7:00am</u> en el Coliseo Municipal con <b>los pabellones</b>(escudos, heraldos) de su colegio y una <u>representación de compañeros</u> que lo apoyen en las pruebas. ¡Mucho éxito, gracias por participar! </center>",e.entidades=[],e.cambia_texto_informativo=function(){return localStorage.texto_informativo_informe=e.texto_informativo},p=0,f=a.length;p<f;p++){for(l=[],g=0,h=(m=(u=a[p]).categorias).length;g<h;g++)(s=m[g]).examenes=r("orderObjectBy")(s.examenes,"promedio",!0),c={},angular.copy(s.examenes[0],c),c.nombre_categ=s.nombre_categ,c.abrev_categ=s.abrev_categ,c.resultados||(c.resultados={promedio:0}),l.push(c);u.finalistas=l}return e.entidades=a}]).controller("VerExamenesPorCategoriasCtrl",["$scope","Restangular","toastr","$filter","$uibModal","App","categorias",function(e,t,n,r,o,i,a){var s,c,u,l,d,p;for(l=localStorage.txt_informativo_por_categorias,e.texto_informativo=l||"<center><b>La Unión Colombiana del Norte</b> les agradece grandemente por participar de estas olimpiadas. <b>SIGAMOS MEJORANDO</b>, todo esto es en pro de la educación Adventista. Oremos para que el próximo año sea aún mejor. ¡Dios los bendiga! </center>",e.cambia_texto_informativo=function(){return localStorage.txt_informativo_por_categorias=e.texto_informativo},u=[],d=0,p=a.length;d<p;d++)(s=a[d]).examenes=r("orderObjectBy")(s.examenes,"promedio",!0),c={},angular.copy(s.examenes[0],c),c.nombre_categ=s.nombre_categ,c.abrev_categ=s.abrev_categ,c.resultados||(c.resultados={promedio:0}),u.push(c);return e.finalistas=u,e.categorias=a}])}.call(this),function(){angular.module("WissenSystem").filter("porIdioma",[function(){return function(e,t){var n,r,o,i;if(e){for(i=[],t=parseFloat(t),r=0,o=e.length;r<o;r++)n=e[r],t===parseFloat(n.idioma_id)&&i.push(n);return i}return!1}}]).filter("idiomas_del_sistema",[function(){return function(e,t){var n,r,o,i;if(e){for(i=[],r=0,o=e.length;r<o;r++)n=e[r],t?n.used_by_system||i.push(n):n.used_by_system&&i.push(n);return i}return!1}}]).filter("porIdiomasEdit",[function(){return function(e,t){var n,r,o,i,a,s,c;if(e&&e.length>0&&e[0].uncodigo_id&&console.log(e,t),c=[],t&&e)for(r=0,a=t.length;r<a;r++)for(o=t[r],o=parseFloat(o),i=0,s=e.length;i<s;i++)n=e[i],o===parseFloat(n.idioma_id)&&c.push(n);return c}}]).filter("catsByIdioma",[function(){return function(e,t){var n,r,o,i;for(i=[],r=0,o=e.length;r<o;r++)(n=e[r]).idioma_id===parseFloat(t)&&i.push(n);return i}}]).filter("decimales",[function(){return function(e,t){return(e=(e=parseFloat(e))%1==0?e.toFixed(0):e.toFixed(t)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]).filter("decimales_if",[function(){return function(e,t){var n;return n=(e=(e=parseFloat(e))%1==0?e.toFixed(0):e.toFixed(t)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),n=parseFloat(n)}}]).filter("exaTime",[function(){return function(e){var t,n,r,o,i;return i=Math.floor(e/1e3),t=3600,60,n=Math.floor(i/t),r=Math.floor(i%t/60),"",o=(o=Math.floor(i%60))<10?"0"+o:void 0,(n=n<10?"0"+n:void 0)+":"+(r=r<10?"0"+r:void 0)+":"+o}}]).filter("secondsToDateTime",[function(){return function(e,t){var n,r,o;return e?(o=function(e){return e<10?"0"+e:""+e},r=e%60,t?(n=Math.floor(e%3600/60),o(Math.floor(e/3600))+":"+o(n)+":"+o(r)):o(n=Math.floor(e%60/60))+":"+o(r)):""}}]).filter("orderObjectBy",[function(){return function(e,t,n){var r,o;return r=[],angular.forEach(e,function(e){return r.push(e)}),o=function(e,t){return e.res_tiempo>t.res_tiempo?n?1:-1:e.res_tiempo===t.res_tiempo?0:n?-1:1},r.sort(function(e,r){switch(t){case"promedio":return e.res_by_promedio?e.res_promedio>r.res_promedio?n?-1:1:e.res_promedio===r.res_promedio?o(e,r):n?1:-1:e.res_puntos>r.res_puntos?n?-1:1:e.res_puntos===r.res_puntos?o(e,r):n?1:-1;case"cantidad_pregs":return e.res_cant_pregs>r.res_cant_pregs?n?-1:1:e.res_cant_pregs===r.res_cant_pregs?o(e,r):n?1:-1;case"nombres":case"examen_id":case"categorias":case"examen_at":return e[t]>r[t]?n?-1:1:e[t]===r[t]?o(e,r):n?1:-1;case"tiempo":return o(e,r)}}),r}}]).filter("orderParticipantes",[function(){return function(e,t){var n,r;return t?(n=[],angular.forEach(e,function(e){return n.push(e)}),r=function(e,t){return e.tiempo>t.tiempo?1:e.tiempo===t.tiempo?0:-1},n.sort(function(e,t){return e.correctas>t.correctas?-1:e.correctas===t.correctas?r(e,t):1}),n):e}}]).filter("orderPuntajesActuales",[function(){return function(e){var t,n;if(e&&0!==e.length)return t=[],angular.forEach(e,function(e){return t.push(e)}),n=function(e,t){return e.tiempo>t.tiempo?1:e.tiempo===t.tiempo?0:-1},console.log(e[0]),e[0].res_by_promedio?t.sort(function(e,t){return e.res_promedio>t.res_promedio?-1:e.res_promedio===t.res_promedio?n(e,t):1}):t.sort(function(e,t){return e.res_puntos>t.res_puntos?-1:e.res_puntos===t.res_puntos?n(e,t):1}),t}}]),window.removeAccents=function(e){return e.replace(/á/g,"a").replace(/â/g,"a").replace(/é/g,"e").replace(/è/g,"e").replace(/ê/g,"e").replace(/í/g,"i").replace(/ï/g,"i").replace(/ì/g,"i").replace(/ó/g,"o").replace(/ô/g,"o").replace(/ú/g,"u").replace(/ü/g,"u").replace(/ç/g,"c").replace(/ß/g,"s").replace(/Á/g,"A").replace(/É/g,"E").replace(/Í/g,"I").replace(/Ó/g,"O").replace(/Ú/g,"U")}}.call(this),function(){angular.module("WissenSystem").filter("clearhtml",function(){return function(e){return e?String(e).replace(/<[^>]+>/gm,""):""}})}.call(this),function(){angular.module("WissenSystem").filter("categsInscritas",["$filter",function(e){return function(t,n,r){var o,i,a,s,c,u,l,d,p,g,f,h,m,_,v,w;if(r=parseInt(r),t&&n){if(v=[],void 0===t[0]||0===t.length||void 0===t.length||!t[0].inscripciones)return[];if(1===t.length)for(w=t[0],c=0,g=n.length;c<g;c++){for(s=n[c],i={},(a=e("porIdioma")(s.categorias_traducidas,r)).length>0&&(i=a[0]),i.algunos=!1,i.nivel_id=s.nivel_id,l=0,f=(_=w.inscripciones).length;l<f;l++)(u=_[l]).categoria_id===s.id&&(i.allowed_to_answer=u.allowed_to_answer,i.examenes=u.examenes,i.inscripcion_id=u.id,i.categ_traducida_id=i.id,i.selected=!0);i.selected||(i.inscripcion_id=void 0,i.selected=!1),v.push(i)}else if(t.length>1)for(d=0,h=n.length;d<h;d++){for(s=n[d],(i=e("porIdioma")(s.categorias_traducidas,r)).length>0&&(i=i[0]),i.nivel_id=s.nivel_id,i.incripcion_id=void 0,o=0,p=0,m=t.length;p<m;p++)w=t[p],e("filter")(w.inscripciones,{categoria_id:s.id}).length>0&&o++;0===o?(i.selected=!1,i.algunos=!1):o===t.length?(i.selected=!0,i.algunos=!1):(i.selected=!1,i.algunos=!0),v.push(i)}return v}return[]}}]).filter("categsInscritasDeUsuario",["$filter",function(e){return function(t,n,r,o){var i,a,s,c,u,l,d,p,g,f,h,m,_;if(t&&n){for(_=[],c=0,g=n.length;c<g;c++)for(s=n[c],(a=e("porIdioma")(s.categorias_traducidas,parseFloat(r))).length>0&&(a=a[0]),l=0,f=t.length;l<f;l++)(u=t[l]).categoria_id===s.id&&(a.nivel_id=s.nivel_id,a.allowed_to_answer=u.allowed_to_answer,a.examenes=u.examenes,a.inscripcion_id=u.id,a.categ_traducida_id=a.id,_.push(a));if(o)for(d=0,h=_.length;d<h;d++)(i=_[d]).categoria_id===o?i.selected=!0:i.selected=!1;else for(p=0,m=_.length;p<m;p++)(i=_[p]).selected=!1;return _}return[]}}]).filter("listaCategsDelUsuarioSegunNivel",["$filter",function(e){return function(e,t){var n,r,o,i;if(e&&t){for(i=[],t=parseInt(t),r=0,o=e.length;r<o;r++)(n=e[r]).nivel_id!==t&&null!==t&&0!==t&&-1!==t||i.push(n);return i}return e}}]).filter("categSelectedDeUsuario",["$filter",function(e){return function(t,n,r,o){var i,a,s,c,u,l;if(t&&n){for(l=[],s=0,c=n.length;s<c;s++)(a=n[s]).id===parseInt(o)&&(i=e("porIdioma")(a.categorias_traducidas,parseFloat(r))).length>0&&(i=i[0],(u=e("filter")(t,{categoria_id:a.id}))&&u.length>0&&(u=u[0],i.allowed_to_answer=u.allowed_to_answer,i.examenes=u.examenes,i.inscripcion_id=u.id,l.push(i)));return l}return[]}}])}.call(this),function(){angular.module("WissenSystem").filter("nombreEntidad",["$filter",function(e){return function(t,n,r){var o;return t&&n?(t=parseFloat(t),(o=e("filter")(n,{id:t})).length>0?r?o[0].alias:o[0].nombre:t):t}}]).filter("nivelesTraducidos",["$filter",function(e){return function(t,n){var r,o,i,a,s;if(t&&n){for(n=parseFloat(n),s=[],r=0,o=t.length;r<o;r++)a=t[r],(i=e("porIdioma")(a.niveles_traducidos,n)).length>0&&(i[0].nivel_king_id=a.id,s.push(i[0]));return s}return t}}]).filter("categoriasTraducidas",["$filter",function(e){return function(t,n,r){var o,i,a,s,c;if(t&&n){for(n=parseFloat(n),c=[],a=0,s=t.length;a<s;a++)o=t[a],r?(r=parseFloat(r),o.nivel_id!==r&&-1!==r&&null!==r||(i=e("porIdioma")(o.categorias_traducidas,n)).length>0&&(i[0].categoria_king_id=o.id,c.push(i[0]))):o&&(i=e("porIdioma")(o.categorias_traducidas,n)).length>0&&c.push(i[0]);return c}return t}}]).filter("nombreCategoria",["$filter",function(e){return function(t,n,r,o){var i,a;return t=parseFloat(t),r=parseFloat(r),(i=e("filter")(n,{id:t})).length>0?(i=i[0],(a=e("porIdioma")(i.categorias_traducidas,r)).length>0?(a=a[0],o?a.abrev:a.nombre):""):""}}])}.call(this),function(){angular.module("WissenSystem").filter("cantPregsEvaluacion",["$filter","Perfil",function(e,t){return function(n){var r,o,i,a,s;if(n){for(o=0,r=0,i=n.length;r<i;r++)(s=n[r]).tipo_pregunta?o++:(a=e("porIdioma")(s.contenidos_traducidos,t.idioma())).length>0&&(o+=a[0].preguntas_agrupadas.length);return o}return!1}}]).filter("noPregActual",["$filter","Perfil",function(e,t){return function(n){var r,o,i,a,s,c,u,l,d,p,g,f,h,m,_,v,w,E,C,b;if(n){for(o=0,r=0,c=n.length;r<c;r++)if(o++,(v=n[r]).tipo_pregunta){for(b=!1,i=0,u=(_=e("porIdioma")(v.preguntas_traducidas,t.idioma())).length;i<u;i++)for(a=0,l=(w=_[i].opciones).length;a<l;a++)w[a].respondida&&(b=!0);if(!b)return o}else for(s=0,d=(m=e("porIdioma")(v.contenidos_traducidos,t.idioma())).length;s<d;s++)for(o++,f=0,p=(E=m[s].preguntas_agrupadas).length;f<p;f++){for(b=!1,h=0,g=(C=E[f].opciones).length;h<g;h++)C[h].respondida&&(b=!0);if(!b)return o}return o}return!1}}]).filter("preguntaActual",["$filter","Perfil",function(e,t){return function(n,r){var o,i,a,s,c,u,l,d,p,g,f,h,m,_,v,w,E,C,b,y,S;if(o=[],angular.forEach(n,function(e){return o.push(e)}),o=e("orderBy")(o,"orden")){if(r)return[o[r-1]];for(i=0,u=o.length;i<u;i++)if((w=o[i]).tipo_pregunta){for(S=!1,a=0,l=(v=e("porIdioma")(w.preguntas_traducidas,t.idioma())).length;a<l;a++)for(s=0,d=(E=v[a].opciones).length;s<d;s++)E[s].respondida&&(S=!0);if(!S)return[w]}else for(c=0,p=(_=e("porIdioma")(w.contenidos_traducidos,t.idioma())).length;c<p;c++)for(h=0,g=(C=_[c].preguntas_agrupadas).length;h<g;h++){for(S=!1,m=0,f=(b=C[h].opciones).length;m<f;m++)b[m].respondida&&(S=!0);if(!S)return[w]}return(y=o[0])&&(y.terminado=!0,y=[y]),y}return!1}}])}.call(this),function(){angular.module("WissenSystem").directive("updateTitle",["$rootScope","$timeout",function(e,t){return{link:function(n,r){var o;return o=function(e,n,o){var i;return i="MyVc",n.data&&n.data.pageTitle&&(i=n.data.pageTitle),o&&o.username&&(i=o.username+" - MyVc"),t(function(){return r.text(i)},0,!1)},e.$on("$stateChangeSuccess",o)}}}])}.call(this),function(){angular.module("WissenSystem").directive("contenteditable",["$timeout","$window",function(e,t){return{require:"ngModel",scope:{guardarNombrePunto:"="},link:function(n,r,o,i){return r.bind("blur keyup change",function(o){return e(function(){var e;return 13===o.keyCode?(o.cancelBubble=!0,o.returnValue=!1,(e=t.document.getElementById("msg-especifico"))&&e.focus(),n.guardarNombrePunto(n.$parent.cliente),o.preventDefault()):n.$apply(function(){return i.$setViewValue(r.html())})},0)}),i.$render=function(){return r.html(i.$viewValue)}}}}])}.call(this),function(){angular.module("WissenSystem").factory("Perfil",["Restangular","App","$q","$cookies","$rootScope","AUTH_EVENTS","$http",function(e,t,n,r,o,i,a){var s,c;return c={},s=0,{setUser:function(e){return c=e},User:function(){return c},id:function(){return c.user_id},idioma:function(){return c.idioma_main_id},setImagen:function(e,t){return c.imagen_id=e,c.imagen_nombre=t},setResourceId:function(e){return s=e},getResourceId:function(){return s},setRegistered:function(e){return c.registered=e},getRegistered:function(){return c.registered},deleteUser:function(){return c={}}}}])}.call(this),function(){angular.module("WissenSystem").factory("preguntasServ",["Restangular","App","$q","$cookies","$rootScope","AUTH_EVENTS","$http",function(e,t,n,r,o,i,a){var s,c;return[],!1,s=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,c=[],{setUser:function(e){return e},getPreguntas:function(){var e;return e=n.defer(),(c=s.open("wissenDB",2)).onupgradeneeded=function(){return c.result.createObjectStore("preguntas_king",{keyPath:"id",autoIncrement:!0}).put({descripcion:"Una pregunta para traducir",tipo_pregunta:"Test",duracion:20,categoria_id:1,added_by:1,preguntas_traducidas:[{id:1,enunciado:"<p>¿Cuánto es <b>dos</b> más dos?</p>",ayuda:"Este es un texto de ayuda",pregunta_id:4,idioma_id:1,idioma:"Español",puntos:5,added_by:1,opciones:[{id:1,definicion:"Primera opción, y necesito meter mucho texto para ver que tal se verá al ingresar más cosas.",is_correct:!1},{id:2,definicion:"Segunda opción",is_correct:!0},{id:3,definicion:"Tercera opción",is_correct:!1}]},{id:2,enunciado:"How much is 2+2?",ayuda:"",pregunta_id:4,idioma_id:2,idioma:"English",puntos:5,added_by:1,opciones:[{id:4,definicion:"Fist option",is_correct:!1},{id:5,definicion:"Second option",is_correct:!0},{id:6,definicion:"Third option",is_correct:!1}]}]},{descripcion:"Otra pregunta",tipo_pregunta:"Test",duracion:20,categoria_id:1,added_by:1,preguntas_traducidas:[{id:1,enunciado:"<p>¿Quién es más rápido?</p>",ayuda:"Debes pensar en tu familia",pregunta_id:5,idioma_id:1,idioma:"Español",puntos:5,added_by:1,opciones:[{id:7,definicion:"Mi mamá.",is_correct:!1},{id:8,definicion:"Mi papá",is_correct:!0},{id:9,definicion:"Mi hermano",is_correct:!1},{id:10,definicion:"Yo",is_correct:!1}]},{id:2,enunciado:"Who is the faster one in the family?",ayuda:"You have to think in your family",pregunta_id:5,idioma_id:2,idioma:"English",puntos:5,added_by:1,opciones:[{id:11,definicion:"My mother",is_correct:!1},{id:12,definicion:"My father",is_correct:!0},{id:13,definicion:"My brother",is_correct:!1},{id:14,definicion:"Me",is_correct:!1}]}]})},c.onsuccess=function(){var t;return t=c.result.transaction(["preguntas_king"],"readwrite").objectStore("preguntas_king"),(c=t.get(1)).onerror=function(e){return console.log("Error")},c.onsuccess=function(t){return console.log("Powerrr",c.result),e.resolve([c.result])}},e.promise},savePregunta:function(e){var t;return t=n.defer(),(c=s.open("wissenDB",2)).onsuccess=function(){var t;return t=c.result.transaction(["preguntas_king"],"readwrite").objectStore("preguntas_king"),console.log("objectStore",t),t.put(e)},t.promise}}}])}.call(this),function(){var e=[].indexOf;angular.module("WissenSystem").factory("MySocket",["App","$q","$rootScope","Perfil","$timeout","$cookies","$http","$state","SocketData","SocketClientes","$filter","webNotification",function(t,n,r,o,i,a,s,c,u,l,d,p){var g,f,h,m,_,v,w,E,C,b,y,S,k,A,N,P,B,T,x,I,R,$,U,M,O,D,L,q,F,j,G,V,z,W,H,X,Y,Q,J;return C=localStorage.getItem("dominio").split(":"),E="",E=e.call(C[0],"http")>=0?C[1]:C[0],(J=io.connect(E+":8787")).on("te_conectaste",function(e){var t,n;return u.conectado(e.datos),o.setResourceId(e.datos.resourceId),localStorage.getItem("registered_boolean")||(localStorage.registered_boolean=!1),n="false"!==(n=!!localStorage.getItem("registered_boolean")&&localStorage.getItem("registered_boolean"))&&n,o.setRegistered(n),o.User().id?this.emit("loguear",{usuario:o.User(),registered:n,nombre_punto:localStorage.nombre_punto}):(t=null!==localStorage.getItem("nombre_punto")&&localStorage.getItem("nombre_punto"),this.emit("reconocer:punto:registered",{nombre_punto:t,registered:n}))}),J.on("logueado:yo",function(e){return 0===l.categorias_king.length&&e.categorias_king&&(l.categorias_king=e.categorias_king),u.config.info_evento=e.info_evento,o.setResourceId(e.yo.resourceId),r.$emit("logueado:yo:agregado_a_arrays",e.yo),u.logueado(e.yo)}),J.on("logueado:alguien",function(e){return 0===l.categorias_king.length&&e.categorias_king&&(l.categorias_king=e.categorias_king),u.logueado(e.clt),r.$apply()}),J.on("user:left",function(e){return u.desconectar(e.resourceId),r.$apply()}),J.on("conectado:alguien",function(e){return u.cliente(e.clt.resourceId)?u.actualizar_clt(e.clt):(u.conectado(e.clt),r.$emit("clt_registrado",{clientes:l.clientes}))}),J.on("take:clientes",function(e){var t,n,o,i;if(u.fix_clientes(e.clts),u.config.info_evento=e.info_evento,c.is("proyectando.grafico_barras"))for(l.participantes=[],n=0,o=(i=l.clientes).length;n<o;n++)(t=i[n]).categsel>0&&l.participantes.push(t);return r.$apply()}),J.on("take:usuarios",function(e){return l.usuarios_all=e.usuarios}),J.on("reconocido:punto:registered",function(e){var t;if((t=u.cliente(e.resourceId)).nombre_punto=d("clearhtml")(e.nombre_punto),t.registered=e.registered,u.actualizar_clt(t),t.resourceId===o.getResourceId())return r.$emit("reconocido:mi_nombre_punto",{nombre_punto:e.nombre_punto})}),J.on("deslogueado",function(e){return A()}),J.on("got_your_qr",function(e){return e.seleccionar?(l.usuarios_all=e.usuarios,u.token_auth=e.from_token,console.log(e)):e.usuario_id?Restangular.one("qr/validar-usuario").customPUT({user_id:e.usuario_id,token_auth:e.from_token}).then(function(e){if(e.token)return l.usuarios_all=[],a.put("xtoken",e.token),s.defaults.headers.common.Authorization="Bearer "+a.get("xtoken"),c.go("panel"),location.refresh()},function(e){return toastr.warning("No se pudo ingresar"),console.log("No se pudo ingresar ",e)}):void 0}),J.on("correspondencia",function(e){return l.mensajes.push(e.mensaje),p.showNotification(e.mensaje.from.user_data.nombres+" "+e.mensaje.from.user_data.apellidos,{body:e.mensaje.texto,icon:"images/system/favicon-myvc.ico",autoClose:6e3},function(e,t){return e?console.log("Unable to show notification: "+e.message):setTimeout(function(){return console.log("Hiding notification...."),t()},6e3)}),r.$emit("llegaCorrespondencia")}),J.on("a_establecer_fondo",function(e){return u.config.info_evento.img_name=e.img_name,r.$apply()}),J.on("a_mostrar_solo_fondo",function(e){return c.transitionTo("proyectando")}),J.on("a_cambiar_teleprompter",function(e){return u.config.info_evento.msg_teleprompter=e.msg_teleprompter,c.transitionTo("proyectando"),r.$apply()}),J.on("sesion_closed",function(e){if(e.clt.resourceId===o.getResourceId())return unregister(),r.lastState=null,r.lastStateParam=null,r.permiso_de_salir=!0,o.deleteUser(),c.transitionTo("login"),a.remove("xtoken"),delete s.defaults.headers.common.Authorization}),J.on("cerrar:tu_sesion",function(e){return r.$emit("me_desloguearon")}),J.on("me_registraron",function(e){var t;return localStorage.registered_boolean=!0,(t=u.cliente(o.getResourceId())).registered=!0,u.actualizar_clt(t),r.$apply()}),J.on("me_desregistraron",function(e){var t;return localStorage.registered_boolean=!1,(t=u.cliente(o.getResourceId())).registered=!1,u.actualizar_clt(t),r.$apply()}),J.on("nombre_punto_cambiado",function(e){var t;return(t=u.cliente(e.resourceId)).nombre_punto=d("clearhtml")(e.nombre),r.$emit("nombre_punto_cambiado",{nombre:t.nombre_punto,resourceId:e.resourceId})}),J.on("take_usuarios",function(e){return l.usuarios_all=e.usuarios}),J.on("change_the_categ_selected",function(e){return u.cliente(o.getResourceId()),u.cambiar_mi_categsel(e.categsel,e.categsel_nombre,e.categsel_abrev),r.$emit("categ_selected_change",e.categsel)}),J.on("change_a_categ_selected",function(e){var t;return(t=u.cliente(e.resourceId)).categsel=e.categsel,t.categsel_id=e.categsel,t.categsel_nombre=e.categsel_nombre,t.categsel_abrev=e.categsel_abrev,u.actualizar_clt(t)}),J.on("a_categ_selected_change",function(e){var t;return(t=u.cliente(e.resourceId)).categsel=e.categsel,t.categsel_id=e.categsel,t.categsel_nombre=e.categsel_nombre,t.categsel_abrev=e.categsel_abrev,u.actualizar_clt(t)}),J.on("empezar_examen",function(e){return r.$emit("empezar_examen")}),J.on("sc_show_participantes",function(e){var t;if((t=d("filter")(o.User().roles,{name:"Pantalla"}))&&t.length>0)return A(),c.is("proyectando.participantes")?r.$apply():c.go("proyectando.participantes")}),J.on("sc_mostrar_resultados_actuales",function(e){var t;if((t=d("filter")(o.User().roles,{name:"Pantalla"}))&&t.length>0)return r.examenes_cargados=e.examenes_cargados,c.is("proyectando.puntajes_actuales")?r.$apply():c.go("proyectando.puntajes_actuales")}),J.on("sc_show_barras",function(e){var t,n,o,i;for(A(),l.participantes=[],n=0,o=(i=l.clientes).length;n<o;n++)(t=i[n]).categsel>0&&l.participantes.push(t);return c.go("proyectando.grafico_barras"),r.$apply()}),J.on("sc_show_question",function(e){var t;if("Pantalla"===(t=o.User().roles[0].name)||"Presentador"===t||"Admin"===t)return u.config.pregunta=e.pregunta,u.config.no_question=e.no_question,u.config.reveal_answer=!1,"Pantalla"===o.User().roles[0].name&&c.go("proyectando.question"),r.$apply()}),J.on("sc_show_logo_entidad_partici",function(e){return u.config.show_logo_entidad_partici=e.valor,r.$apply()}),J.on("sc_show_puntaje_particip",function(e){return u.config.cliente_to_show=e.cliente,c.go("proyectando.puntaje_particip"),r.$apply()}),J.on("sc_show_puntaje_examen",function(e){return u.config.puntaje_to_show=e.examen,c.go("proyectando.puntaje_particip"),r.$apply()}),J.on("sc_answered",function(e){if(A(),!c.includes("proyectando")&&!r.silenciar_respuestas&&!r.silenciar_todo&&e.resourceId!==o.getResourceId())return"correct"===e.cliente.answered?new Audio("/sounds/Pin.wav").play():new Audio("/sounds/Error.wav").play()}),J.on("next_question",function(e){return u.set_waiting(),r.$apply(),r.$emit("next_question")}),J.on("goto_question_no",function(e){return u.set_waiting(),r.$emit("goto_question_no",e.numero)}),J.on("set_free_till_question",function(e){return u.config.info_evento.free_till_question=e.free_till_question,r.$emit("set_free_till_question",e.free_till_question)}),J.on("set_puestos_ordenados",function(e){return u.config.info_evento.puestos_ordenados=e.puestos_ordenados}),T=function(e,t){return J.on(e,function(){var e;return e=arguments,r.$apply(function(){return t.apply(J,e)})})},b=function(e,t,n){return J.emit(e,t,function(){var e;return e=arguments,r.$apply(function(){if(n)return n.apply(J,e)})})},$=function(e,t){return t?this.emit("registrar",{registrar_boolean:e}):this.emit("registrar",{cliente:t,registrar_boolean:e})},v=function(){var e;return e="false"!==(e=null!==localStorage.getItem("registered_boolean")&&localStorage.getItem("registered_boolean")),this.emit("desloguear",{registered:e,nombre_punto:localStorage.nombre_punto})},_=function(e){var t;return t=null!==localStorage.getItem("nombre_punto")&&localStorage.getItem("nombre_punto"),e?this.emit("conectar",{qr:e,nombre_punto:t}):this.emit("conectar",{nombre_punto:t})},P=function(e,t){var n;return t?(n={qr:e,usuario_id:t,from_token:a.get("xtoken")},this.emit("got_qr",n)):this.emit("got_qr",{qr:e,from_token:a.get("xtoken")})},x=function(e,t){if(e)return this.emit("let_him_enter",{usuario_id:e,from_token:a.get("xtoken"),resourceId:t})},A=function(){return J.connected?J.emit("get_clts"):(l.cliente=[],l.registrados_logueados=[],l.registrados_no_logged=[],l.sin_registrar=[])},Y=function(e){return this.emit("correspondencia",{mensaje:e})},k=function(e){return this.emit("establecer_fondo",{img_name:e})},R=function(e){return this.emit("mostrar_solo_fondo",{img_name:e})},g=function(e){return this.emit("cambiar_teleprompter",{msg_teleprompter:e})},Q=function(e,t){return this.emit("correspondencia",{mensaje:e,to:t.resourceId})},f=function(e){return this.emit("cerrar_sesion_a",{resourceId:e})},U=function(e){return this.emit("registrar_a",{resourceId:e})},w=function(e){return this.emit("desregistrar_a",{resourceId:e})},B=function(e,t){return t=d("clearhtml")(t),this.emit("guardar:nombre_punto",{resourceId:e,nombre:t})},N=function(){var e;if(0===l.usuarios_all.length)return e=a.get("xtoken"),this.emit("get_usuarios",{from_token:e})},h=function(e,t){var n,r;return(r=u.cliente(e)).categsel=t,(n=d("categSelectedDeUsuario")(r.user_data.inscripciones,l.categorias_king,o.User().idioma_main_id,r.categsel)).length>0&&(r.categsel_nombre=n[0].nombre,r.categsel_abrev=n[0].abrev,r.categsel_id=n[0].categoria_id),u.actualizar_clt(r,t),this.emit("change_a_categ_selected",{resourceId:e,categsel:t,categsel_nombre:r.categsel_nombre,categsel_abrev:r.categsel_abrev})},m=function(e,t,n){return this.emit("warn_my_categ_selected",{categsel:e,categsel_nombre:t,categsel_abrev:n})},y=function(){if(this.emit("empezar_examen"),!r.silenciar_todo)return new Audio("/sounds/Sirviendo.wav").play()},S=function(e){return this.emit("empezar_examen_cliente",{resourceId:e})},V=function(){return this.emit("sc_show_participantes")},j=function(){return this.emit("sc_show_barras")},H=function(e,t){return this.emit("sc_show_question",{no_question:e,pregunta:t})},X=function(e){return this.emit("selec_opc_in_question",{opcion:e})},F=function(){return this.emit("sc_reveal_answer")},G=function(e){return this.emit("sc_show_logo_entidad_partici",{valor:e})},W=function(e){return(e.puesto=1)?(i(function(){return this.emit("sc_show_puntaje_particip",{cliente:e})},1800),r.silenciar_todo?void 0:new Audio("/sounds/Siguiente.wav").play()):this.emit("sc_show_puntaje_particip",{cliente:e})},z=function(e){return 1!==e.puesto?this.emit("sc_show_puntaje_examen",{examen:e}):(i(()=>this.emit("sc_show_puntaje_examen",{examen:e}),1800),r.silenciar_todo?void 0:new Audio("sounds/Primer_lugar.wav").play())},M=function(e,t){var n;return n=o.getResourceId(),this.emit("sc_answered",{resourceId:n,valor:e,tiempo:t})},L=function(){if(u.set_waiting(),this.emit("next_question"),!r.silenciar_todo)return new Audio("/sounds/Siguiente.wav").play()},q=function(e){return u.cliente(e.resourceId).answered="waiting",this.emit("next_question",{resourceId:e.resourceId})},O=function(e,t){return u.cliente(e.resourceId).answered="waiting",this.emit("goto_question_no_clt",{resourceId:e.resourceId,numero:t})},D=function(e){return this.emit("sc_mostrar_resultados_actuales",{examenes_cargados:e})},I=function(e){return this.emit("liberar_hasta_pregunta",{numero:e}),u.config.info_evento.preg_actual=e},{usuarios_all:this.usuarios_all,conectar:_,readyState:function(){return J.connected},on:T,emit:b,registrar:$,desloguear:v,got_qr:P,send_email:Y,establecer_fondo:k,mostrar_solo_fondo:R,cambiar_teleprompter:g,send_email_to:Q,get_clts:A,cerrar_sesion_a:f,registrar_a:U,desregistrar_a:w,guardar_nombre_punto:B,get_usuarios:N,let_him_enter:x,change_a_categ_selected:h,change_my_categ_selected:m,empezar_examen:y,empezar_examen_cliente:S,sc_show_participantes:V,sc_show_barras:j,sc_show_question:H,selec_opc_in_question:X,sc_reveal_answer:F,sc_show_logo_entidad_partici:G,sc_show_puntaje_particip:W,sc_show_puntaje_examen:z,sc_answered:M,sc_next_question:L,sc_next_question_cliente:q,sc_goto_question_no_clt:O,sc_mostrar_resultados_actuales:D,liberar_hasta_pregunta:I}}])}.call(this),function(){angular.module("WissenSystem").factory("SocketData",["SocketClientes","$rootScope","$filter","$q","Perfil",function(e,t,n,r,o){var i,a;return this.cliente_to_show=[],this.clt_selected={},"",{desconectar:t=>(e.clientes=n("filter")(e.clientes,{resourceId:"!"+t}),e.sin_registrar=n("filter")(e.sin_registrar,{resourceId:"!"+t}),e.registrados_logueados=n("filter")(e.registrados_logueados,{resourceId:"!"+t}),e.registrados_no_logged=n("filter")(e.registrados_no_logged,{resourceId:"!"+t})),token_auth:"",cliente:a=(t=>{var n,r,o,i,a;for(r=!1,o=0,i=(a=e.clientes).length;o<i;o++)if((n=a[o]).resourceId===t)return r=n;return r}),get_cliente:t=>{var n,o,i,a,s;for(o=r.defer(),i=0,a=(s=e.clientes).length;i<a;i++)(n=s[i]).resourceId===t&&o.resolve(n);return o.promise},cambiar_mi_categsel:(e,t,n)=>{var r;return(r=a(o.getResourceId())).categsel=e,r.categsel_id=e,r.categsel_nombre=t,r.categsel_abrev=n,i(r)},fix_clientes:t=>{var r,i,a,s,c,u,l;for(a=0,c=t.length;a<c;a++)i=t[a],(r=n("categSelectedDeUsuario")(i.user_data.inscripciones,e.categorias_king,o.User().idioma_main_id,i.categsel)).length>0&&(i.categsel_nombre=r[0].nombre,i.categsel_abrev=r[0].abrev,i.categsel_id=r[0].categoria_id);for(e.clientes=t,e.registrados_logueados.splice(0,e.registrados_logueados.length),e.registrados_no_logged.splice(0,e.registrados_no_logged.length),e.sin_registrar.splice(0,e.sin_registrar.length),s=0,u=(l=e.clientes).length;s<u;s++)(i=l[s]).registered?i.logged?e.registrados_logueados.push(i):e.registrados_no_logged.push(i):e.sin_registrar.push(i);return!0},conectado:t=>{var n,r,o,i,a;for(n=!1,0,o=r=0,i=(a=e.clientes).length;r<i;o=++r)a[o].resourceId===t.resourceId&&(n=!0,o);return n||(e.clientes.push(t),t.registered?e.registrados_no_logged.push(t):e.sin_registrar.push(t)),!0},logueado:t=>{var r,i,a,s,c,u,l,d,p,g,f,h,m,_,v,w;if((r=n("categSelectedDeUsuario")(t.user_data.inscripciones,e.categorias_king,o.User().idioma_main_id,t.categsel)).length>0&&(t.categsel_nombre=r[0].nombre,t.categsel_abrev=r[0].abrev,t.categsel_id=r[0].categoria_id),t.registered){for(c=a=0,p=(m=e.registrados_no_logged).length;a<p;c=++a)m[c].resourceId===t.resourceId&&e.registrados_no_logged.splice(c,1);for(c=u=0,g=(_=e.registrados_logueados).length;u<g;c=++u)_[c].resourceId===t.resourceId&&e.registrados_logueados.splice(c,1,t)}else{for(i=!1,c=l=0,f=(v=e.sin_registrar).length;l<f;c=++l)v[c].resourceId===t.resourceId&&(e.sin_registrar.splice(c,1,t),i=!0);i||e.sin_registrar.push(t)}for(i=!1,s=0,c=d=0,h=(w=e.clientes).length;d<h;c=++d)w[c].resourceId===t.resourceId&&(i=!0,s=c);return i&&e.clientes.splice(s,1,t),!0},deslogueado:t=>{var n,r,o,i,a,s,c;for(a=!1,o=0,i=r=0,s=(c=e.clientes).length;r<s;i=++r)(n=c[i]).resourceId===t.resourceId&&n.logged===t.logged&&(a=!0,o=i);return a?(e.clientes.splice(o,1,t),t.registered?t.logged?(e.registrados_logueados.push(t),e.registrados_no_logged.splice(o,1)):(e.registrados_no_logged.push(t),e.registrados_logueados.splice(o,1)):e.sin_registrar.splice(o,1,t)):(e.clientes.push(t),t.registered?e.sin_registrar.push(t):e.sin_registrar.splice(o,1,t)),!0},actualizar_clt:i=(t=>{var n,r,o,i,a,s,c,u,l,d,p,g,f;for(r=n=0,s=(d=e.clientes).length;n<s;r=++n)d[r].resourceId===t.resourceId&&e.clientes.splice(r,1,t);if(t.registered)if(t.logged)for(r=o=0,c=(p=e.registrados_logueados).length;o<c;r=++o)p[r].resourceId===t.resourceId&&e.registrados_logueados.splice(r,1,t);else for(r=i=0,u=(g=e.registrados_no_logged).length;i<u;r=++i)g[r].resourceId===t.resourceId&&e.registrados_no_logged.splice(r,1,t);else for(r=a=0,l=(f=e.sin_registrar).length;a<l;r=++a)f[r].resourceId===t.resourceId&&e.sin_registrar.splice(r,1,t);return!1}),config:{pregunta:{},reveal_answer:!1,show_logo_entidad_partici:!1,info_evento:{examen_iniciado:!1,preg_actual:0,free_till_question:-1,img_name:"",puestos_ordenados:!0}},set_waiting:()=>{var t,n,r,o,i,a,s,c,u,l;for(n=t=0,i=(c=e.clientes).length;t<i;n=++t)c[n].answered="waiting";for(n=r=0,a=(u=e.registrados_logueados).length;r<a;n=++r)u[n].answered="waiting";for(n=o=0,s=(l=e.sin_registrar).length;o<s;n=++o)l[n].answered="waiting";return!1},clt_selected:this.clt_selected}}]).factory("SocketClientes",["$rootScope",function(e){return this.clientes=[],this.registrados_logueados=[],this.registrados_no_logged=[],this.sin_registrar=[],this.usuarios_all=[],this.mensajes=[],this.categorias_king=[],this.participantes=[],{clientes:this.clientes,registrados_logueados:this.registrados_logueados,registrados_no_logged:this.registrados_no_logged,sin_registrar:this.sin_registrar,usuarios_all:this.usuarios_all,mensajes:this.mensajes,categorias_king:this.categorias_king,participantes:this.participantes}}])}.call(this),function(){angular.module("WissenSystem").factory("AuthService",["Restangular","$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter","toastr","MySocket",function(e,t,n,r,o,i,a,s,c,u,l){var d;return(d={}).verificando=!1,d.promesa_de_verificacion={},d.verificar=function(){var e;return d.verificando?d.promesa_de_verificacion:(e=s.defer(),o.User().id||o.User().rowid?e.resolve(o.User()):r.get("xtoken")?void 0!==r.get("xtoken")&&"undefined"!==r.get("xtoken")&&"[object Object]"!==r.get("xtoken")?d.login_from_token().then(function(t){return o.setUser(t),e.resolve(t)},function(t){return console.log("No se logueó from token"),e.reject(t)}):(console.log("Token mal estructurado: ",r.get("xtoken")),d.borrarToken(),i.$broadcast(a.notAuthenticated),e.reject("Token mal estructurado.")):(console.log("No hay cookie token."),e.reject("No hay cookie token."),t.go("login"),i.$broadcast(a.notAuthenticated)),d.promesa_de_verificacion=e.promise,d.promesa_de_verificacion)},d.verificar_acceso=function(){var e,n;return o.User().id||o.User().rowid||t.go("login"),!(n=t.current).data.needed_permissions||(e=n.data.needed_permissions,d.isAuthorized(e)?void 0:(console.log("No tiene permisos, y... "),i.lastState=n.name,d.isAuthenticated()?(i.$broadcast(a.notAuthorized),console.log("...está Autenticado.")):(console.log("...NO está Autenticado."),t.transitionTo("login"))))},d.login_credentials=function(c){var p;return p=s.defer(),d.borrarToken(),e.one("login/login").customPOST(c).then(function(e){var t;return e.token?(r.put("xtoken",e.token),n.defaults.headers.common.Authorization="Bearer "+r.get("xtoken"),o.setUser(e),t="false"!==(t=null!==localStorage.getItem("registered_boolean")&&localStorage.getItem("registered_boolean")),l.emit("loguear",{usuario:e,registered:t,nombre_punto:localStorage.nombre_punto}),i.$broadcast(a.loginSuccess),p.resolve(e)):(console.log("No se trajo un token en el login.",e),i.$broadcast(a.loginFailed),p.reject("Error en login"))},function(e){return console.log("No se pudo loguear. ",e,t),e.data&&e.data.error&&("Token expirado"===e.data.error||"token_expired"===e.error?(u.warning("La sesión ha expirado"),"login"!==t.current.name&&t.go("login")):i.$broadcast(a.loginFailed)),p.reject("Error en login")}),p.promise},d.login_from_token=function(){var t;return t=s.defer(),o.User().id?t.resolve(o.User()):o.User().rowid||(n.defaults.headers.common.Authorization="Bearer "+r.get("xtoken"),e.one("login/verificar").post().then(function(e){var n;return n="false"!==(n=null!==localStorage.getItem("registered_boolean")&&localStorage.getItem("registered_boolean")),l.emit("loguear",{usuario:e,registered:n,nombre_punto:localStorage.nombre_punto}),o.setUser(e),t.resolve(e)},function(e){return console.log("No se pudo loguear con token. ",e),t.reject("Error en login con token."),i.$broadcast(a.loginFailed)})),t.promise},d.logout=function(e){return i.lastState=null,i.lastStateParam=null,d.borrarToken(),o.deleteUser(),t.transitionTo("login")},d.borrarToken=function(){return r.remove("xtoken"),delete n.defaults.headers.common.Authorization},d.isAuthenticated=function(){if(o.User().id||o.User().rowid)return!0},d.isAuthorized=function(e){var t,n;return!!(n=o.User()).is_superuser||(angular.isArray(e)||(e=[e]),angular.isArray(n.perms)?(t=[],_.each(e,function(e){if(-1!==n.perms.indexOf(e))return t.push(e)}),d.isAuthenticated()&&t.length>0):!(e.length>0))},d.hasRoleOrPerm=function(e,t){var n;if(!angular.isArray(e)){if(!e)return!1;e=[e]}return n=[],_.each(e,function(e){var t;if([],(t=c("filter")(o.User().roles,{name:e}))&&t.length>0)return n.push(e)}),n.length>0},d}])}.call(this);