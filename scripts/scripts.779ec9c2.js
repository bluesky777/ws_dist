(function(){"use strict";angular.module("WissenSystem",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.router","ui.bootstrap","ui.select","ui.sortable","pascalprecht.translate","angular-loading-bar","restangular","toastr","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","angularFileUpload","FBAngular","ngMaterial","froala","ngCordova","angular-svg-round-progress"]).constant("App",function(){var a,b,c;return a="http://localhost/",console.log("Entra al dominio: ",location.hostname),location.hostname.match("lalvirtual")&&(a="http://lalvirtual.com/wissen/"),location.hostname.match("olimpiadaslibertad")&&(a="http://olimpiadaslibertad.com/"),c=a+"wissenLaravel/public/",b=a+"ProyectoDecimo/",{Server:c,views:"views/",images:c+"images/",perfilPath:c+"images/perfil/",imgSystemPath:c+"images/eventos/"}}()).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",participante:"participante",tecnico:"tecnico",profesor:"profesor",guest:"guest"}).constant("PERMISSIONS",{can_work_like_admin:"can_work_like_admin",can_work_like_teacher:"can_work_like_teacher",can_work_like_participante:"can_work_like_participante",can_work_like_tecnico:"can_work_like_tecnico",can_work_like_guest:"can_work_like_guest",can_accept_images:"can_accept_images",can_edit_participantes:"can_edit_participantes",can_edit_usuarios:"can_edit_usuarios"})}).call(this),function(){"use strict";angular.module("WissenSystem").controller("MainCtrl",["$scope","$window","$interval",function(a,b,c){}]).controller("LandingCtrl",["$scope","$window","$interval",function(a,b,c){}])}.call(this),function(a,b,c){"use strict";function d(){this.$get=["$$sanitizeUri",function(a){return function(b){var c=[];return g(b,l(c,function(b,c){return!/^unsafe/.test(a(b,c))})),c.join("")}}]}function e(a){var c=[],d=l(c,b.noop);return d.chars(a),c.join("")}function f(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function g(a,c){function d(a,d,f,g){if(d=b.lowercase(d),B[d])for(;j.last()&&C[j.last()];)e("",j.last());A[d]&&j.last()==d&&e("",d),g=x[d]||!!g,g||j.push(d);var i={};f.replace(p,function(a,b,c,d,e){var f=c||d||e||"";i[b]=h(f)}),c.start&&c.start(d,i,g)}function e(a,d){var e,f=0;if(d=b.lowercase(d))for(f=j.length-1;f>=0&&j[f]!=d;f--);if(f>=0){for(e=j.length-1;e>=f;e--)c.end&&c.end(j[e]);j.length=f}}var f,g,i,j=[],k=a;for(j.last=function(){return j[j.length-1]};a;){if(g=!0,j.last()&&D[j.last()])a=a.replace(new RegExp("(.*)<\\s*\\/\\s*"+j.last()+"[^>]*>","i"),function(a,b){return b=b.replace(s,"$1").replace(u,"$1"),c.chars&&c.chars(h(b)),""}),e("",j.last());else if(0===a.indexOf("<!--")?(f=a.indexOf("--",4),f>=0&&a.lastIndexOf("-->",f)===f&&(c.comment&&c.comment(a.substring(4,f)),a=a.substring(f+3),g=!1)):t.test(a)?(i=a.match(t),i&&(a=a.replace(i[0],""),g=!1)):r.test(a)?(i=a.match(o),i&&(a=a.substring(i[0].length),i[0].replace(o,e),g=!1)):q.test(a)&&(i=a.match(n),i&&(a=a.substring(i[0].length),i[0].replace(n,d),g=!1)),g){f=a.indexOf("<");var l=0>f?a:a.substring(0,f);a=0>f?"":a.substring(f),c.chars&&c.chars(h(l))}if(a==k)throw m("badparse","The sanitizer was unable to parse the following block of html: {0}",a);k=a}e()}function h(a){if(!a)return"";var b=I.exec(a),c=b[1],d=b[3],e=b[2];return e&&(H.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in H?H.textContent:H.innerText),c+e+d}function i(a){return a.replace(/&/g,"&amp;").replace(v,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(w,function(a){var b=a.charCodeAt(0);return 159>=b||173==b||b>=1536&&1540>=b||1807==b||6068==b||6069==b||b>=8204&&8207>=b||b>=8232&&8239>=b||b>=8288&&8303>=b||65279==b||b>=65520&&65535>=b?"&#"+b+";":a}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function j(a){var c="",d=a.split(";");return b.forEach(d,function(a){var d=a.split(":");if(2==d.length){var e=J(b.lowercase(d[0])),a=J(b.lowercase(d[1]));(("color"===e||"background-color"===e)&&(a.match(/^rgb\([0-9%,\. ]*\)$/i)||a.match(/^rgba\([0-9%,\. ]*\)$/i)||a.match(/^hsl\([0-9%,\. ]*\)$/i)||a.match(/^hsla\([0-9%,\. ]*\)$/i)||a.match(/^#[0-9a-f]{3,6}$/i)||a.match(/^[a-z]*$/i))||"text-align"===e&&("left"===a||"right"===a||"center"===a||"justify"===a)||"float"===e&&("left"===a||"right"===a||"none"===a)||("width"===e||"height"===e)&&a.match(/[0-9\.]*(px|em|rem|%)/))&&(c+=e+": "+a+";")}}),c}function k(a,b,c,d){return"img"===a&&b["ta-insert-video"]&&("ta-insert-video"===c||"allowfullscreen"===c||"frameborder"===c||"contenteditble"===c&&"false"===d)?!0:!1}function l(a,c){var d=!1,e=b.bind(a,a.push);return{start:function(a,f,g){a=b.lowercase(a),!d&&D[a]&&(d=a),d||E[a]!==!0||(e("<"),e(a),b.forEach(f,function(d,g){var h=b.lowercase(g),l="img"===a&&"src"===h||"background"===h;("style"===h&&""!==(d=j(d))||k(a,f,h,d)||G[h]===!0&&(F[h]!==!0||c(d,l)))&&(e(" "),e(g),e('="'),e(i(d)),e('"'))}),e(g?"/>":">"))},end:function(a){a=b.lowercase(a),d||E[a]!==!0||(e("</"),e(a),e(">")),a==d&&(d=!1)},chars:function(a){d||e(i(a))}}}var m=b.$$minErr("$sanitize"),n=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,o=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,q=/^</,r=/^<\s*\//,s=/<!--(.*?)-->/g,t=/<!DOCTYPE([^>]*?)>/i,u=/<!\[CDATA\[(.*?)]]>/g,v=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,w=/([^\#-~| |!])/g,x=f("area,br,col,hr,img,wbr"),y=f("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),z=f("rp,rt"),A=b.extend({},z,y),B=b.extend({},y,f("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=b.extend({},z,f("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),D=f("script,style"),E=b.extend({},x,B,C,A),F=f("background,cite,href,longdesc,src,usemap"),G=b.extend({},F,f("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),H=document.createElement("pre"),I=/^(\s*)([\s\S]*?)(\s*)$/,J=function(){return String.prototype.trim?function(a){return b.isString(a)?a.trim():a}:function(a){return b.isString(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}();b.module("ngSanitize",[]).provider("$sanitize",d),b.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,d=/^mailto:/;return function(f,g){function h(a){a&&n.push(e(a))}function i(a,c){n.push("<a "),b.isDefined(g)&&(n.push('target="'),n.push(g),n.push('" ')),n.push('href="'),n.push(a),n.push('">'),h(c),n.push("</a>")}if(!f)return f;for(var j,k,l,m=f,n=[];j=m.match(c);)k=j[0],j[2]==j[3]&&(k="mailto:"+k),l=j.index,h(m.substr(0,l)),i(k,j[0].replace(d,"")),m=m.substring(l+j[0].length);return h(m),a(n.join(""))}}])}(window,window.angular),function(){"use strict";angular.module("WissenSystem").controller("ApplicationController",["$scope","USER_ROLES","AuthService","toastr","$state","$rootScope","Restangular","$filter",function(a,b,c,d,e,f,g,h){return a.isAuthorized=c.isAuthorized,a.hasRoleOrPerm=c.hasRoleOrPerm,a.USER_ROLES=b,a.isLoginPage=!1,a.navFull=!0,a.toggleNav=function(){return a.navFull=!a.navFull},a.tema="theme-zero",a.cambiarTema=function(b){return a.tema=b},a.floatingSidebar=0,a.toggleFloatingSidebar=function(){return a.floatingSidebar=a.floatingSidebar?!1:!0},a.idiomas_del_sistema=function(){var b,c,d,e,f;for(a.idiomas_usados=h("idiomas_del_sistema")(a.idiomas),e=a.idiomas_usados,f=[],c=0,d=e.length;d>c;c++)b=e[c],"ES"===b.abrev?f.push(b.actual=!0):f.push(void 0);return f},a.idiomas=[],g.all("idiomas").getList().then(function(b){return a.idiomas=b,a.idiomas_del_sistema()},function(a){return console.log("No se trajeron los idiomas del sistema.",a)})}])}.call(this),function(){angular.module("WissenSystem").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider","App","PERMISSIONS","RestangularProvider","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig","uiSelectConfig",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return h.setBaseUrl(f.Server+"api/"),d.defaults.useXDomain=!0,delete d.defaults.headers.common["X-Requested-With"],d.defaults.headers.common.Accept="application/json",d.defaults.headers.common["Content-Type"]="application/json",m.theme="select2",m.resetSearchInput=!0,c.otherwise("/login"),b.state("main",{url:"/",views:{principal:{templateUrl:f.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{pageTitle:"En Construcción"}}).state("landing",{url:"/landing",views:{principal:{templateUrl:f.views+"main/landing.tpl.html",controller:"LandingCtrl"}},data:{pageTitle:"Liceo Adventista Libertad"}}).state("login",{url:"/login",views:{principal:{templateUrl:""+f.views+"login/login.tpl.html",controller:"LoginCtrl"}},data:{pageTitle:"Ingresar a Wissen"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:""+f.views+"login/logout.tpl.html",controller:"LogoutCtrl"}},data:{icon_fa:"fa fa-user"}}),j.bigLoader=!0,_.mixin({findByValues:function(a,b,c){var d;return d=_.filter(a,function(a){return _.contains(c,a[b])}),0===d.length?!1:d[0]}}),this}]).filter("capitalize",function(){return function(a,b){return a?a.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}})}.call(this),function(){angular.module("WissenSystem").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$translate","$cookies","Restangular","Perfil","AuthService","AUTH_EVENTS","toastr",function(a,b,c,d,e,f,g,h,i,j,k){var l;return a.examen_actual=[],a.$state=c,a.$stateParams=d,a.lastState=null,a.lastStateParam=null,a.$on("event:auth-loginRequired",function(a){return console.log("Acceso no permitido, vamos a loguear",a),c.transitionTo("login")}),l=function(){return null===a.lastState||"login"===a.lastState||"/"===a.lastState||"main"===a.lastState?c.go("panel"):c.transitionTo(a.lastState,a.lastStateParam)},a.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),l()}),a.$on("$stateChangeStart",function(b,c,d,e,f){return null===a.lastState||"logout"!==c.name&&"login"!==c.name&&"main"!==c.name?(a.lastState=c.name,a.lastStateParam=d):void 0}),a.$on("$stateChangeSuccess",function(b,d,e,f,g){return a.pageTitle=c.current.name}),a.$on("$stateChangeError",function(b,d,e,f,g){return console.log(a.lastState,"-Evento fallido: ",b),k.warning("Lo sentimos, hubo un error o no puedes acceder a esta vista"),"panel"!==a.lastState?c.transitionTo("panel"):c.transitionTo("login")}),a.$on("$translatePartialLoaderStructureChanged",function(){return e.refresh(),console.log("Translate refrescado supuestamente.")}),a.$on(j.loginSuccess,function(){return l()}),a.$on(j.loginFailed,function(a){return k.error("Datos incorrecto.","No se pudo loguear"),console.log("Evento loginFailed: ",a)}),a.$on(j.notAuthenticated,function(a){return k.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",a),c.transitionTo("login")}),a.$on(j.notAuthorized,function(b){return k.warning("No está autorizado para entrar a esta vista","Restringido"),c.go("panel"),console.log("Evento notAuthorized: ",b,a.lastState)})}])}.call(this),function(){"use strict";var a;a=function(){var a,b;return a=function(){return b("deviceready")},b=function(a){return angular.bootstrap($("html"),["WissenSystem"])},this.bindEvents=function(){return document.addEventListener("deviceready",a,!1)},void 0!==window.cordova?(console.log("Cordova found, wating for device."),this.bindEvents()):b("manual")},$(function(){return new a})}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(a,b,c,d,e){return e.translations("EN",{LOGIN_MSG:"Sign In to the panel"}).translations("ES",{LOGIN_MSG:"Ingresa al panel"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","Restangular","$cookies","Perfil","App","$state","cfpLoadingBar",function(a,b,c,d,e,f,g,h,i,j,k){a.logoPath="images/MyVc-1.gif",a.credentials={username:"",password:""},k.complete(),a.login=function(){var b;return b=d.login_credentials(a.credentials),b.then(function(a){},function(a){return console.log("Promise de login_credentials rechazada",a)})}}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(a,b,c,d,e){a.state("panel",{url:"/panel",views:{principal:{templateUrl:""+b.views+"panel/panel.tpl.html",controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}]},data:{pageTitle:"WissenSystem - Bienvenido"}}),e.preferredLanguage("ES"),e.translations("EN",{INICIO_MENU:"Home",USERS_MENU:"Users",EVENTS_MENU:"Events",ENTIDADES_MENU:"Entities",CATEGS_MENU:"Categories",PREGUNTAS_MENU:"Questions",EVALUACIONES_MENU:"Tests",IDIOMA_MENU:"Language"}).translations("ES",{INICIO_MENU:"Inicio",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorías",PREGUNTAS_MENU:"Preguntas",EVALUACIONES_MENU:"Evaluaciones",USERS_MENU:"Usuarios",IDIOMA_MENU:"Idioma",ELIMINATORIAS:"Eliminatorias",GRAN_FINAL:"Gran final",INSCRITO_EN:"Estás inscrito en:",EXAM_HECHOS:"Exámenes hechos"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("PanelCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","AuthService","Perfil","App","resolved_user","toastr","$translate","$filter","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.USER=j,a.imagesPath=i.images,g.verificar_acceso(),f.$on("$stateChangeSuccess",function(b,c,d,e,f){return a.cambiarTema("theme-zero")}),a.cambiarIdioma=function(b){return c.one("idiomas/cambiar-idioma").customPUT({idioma_id:b.id}).then(function(c){var d,e,f,g;for(l.use(b.abrev),a.USER.idioma_main_id=b.id,a.idiomas_del_sistema(),g=a.idiomas_usados,e=0,f=g.length;f>e;e++)d=g[e],d.actual=d.abrev===b.abrev?!0:!1;return k.success("Idioma cambiado por "+b.abrev)},function(a){return console.log("No se pudo cambiar el idioma.",a)})},a.set_system_event=function(b){return c.one("eventos/set-evento-actual").customPUT({id:b.id}).then(function(c){return console.log("Evento cambiado: ",c),angular.forEach(a.USER.eventos,function(a,b){return a.actual=!1}),b.actual=!0,k.success("Evento actual cambiado por "+b.alias)},function(a){return console.log("Error conectando!",a),k.warning("No se pudo cambiar el evento actual.")})},a.evento_actual={},a.el_evento_actual=function(){if(a.USER){if(!g.isAuthorized("can_work_like_admin"))return a.evento_actual=a.USER.evento_actual;try{return a.evento_actual=m("filter")(a.USER.eventos,{id:a.USER.evento_selected_id})[0]}catch(b){return a.evento_actual={}}finally{f.$broadcast("cambia_evento_actual")}}},a.el_evento_actual(),a.set_user_event=function(b){return c.one("eventos/set-user-event").customPUT({evento_id:b.id}).then(function(c){return console.log("Evento cambiado: ",c),a.USER.evento_selected_id=b.id,a.el_evento_actual(),k.success("Evento actual cambiado por "+b.alias),f.$broadcast("cambio_evento_user")},function(a){return console.log("Error conectando!",a),k.warning("No se pudo cambiar el evento actual.")})},a.logout=function(){return g.logout(),c.one("login/logout").customPUT().then(function(a){return console.log("Desconectado con éxito: ",a)},function(a){return console.log("Error desconectando!",a)})},a.traerEventos=function(){return c.all("eventos").getList().then(function(b){return a.USER.eventos=b,a.el_evento_actual()},function(a){return console.log("No se trajeron los eventos.")})}}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(a,b,c){return b.state("panel.eventos",{url:"^/eventos",views:{contenido_panel:{templateUrl:""+a.views+"eventos/eventos.tpl.html",controller:"EventosCtrl"},data:{pageTitle:"Eventos"}}}).state("panel.eventos_user",{url:"/eventos_user",templateUrl:"views/eventos/eventos_user.tpl.html",controller:"EventosUserCtrl"}),c.translations("EN",{EVENTS_TITLE:"Events",CREAR_EVENTO:"Create event"}).translations("ES",{EVENTS_TITLE:"Eventos"})}])}.call(this),function(){angular.module("WissenSystem").controller("EventosCtrl",["$scope","Restangular","$modal","$filter","App","toastr",function(a,b,c,d,e,f){return a.newEvent={with_pay:!1},a.currentEvent={idiomas_extras:[]},a.creando=!1,a.editando=!1,a.guardando_nuevo=!1,a.guardando_edit=!1,a.guardar_evento=function(){return a.guardando_nuevo=!0,b.one("eventos/store").customPOST(a.newEvent).then(function(b){return console.log("Evento guardado",b),b.idiomas_extras=a.newEvent.idiomas_extras,a.USER.eventos.push(b),a.guardando_nuevo=!1,a.creando=!1,f.success("Evento guardado con éxito.","Creado"),a.newEvent={with_pay:!1}},function(b){return console.log("No se pudo guardar el evento",b),f.warning("No se pudo crear evento.","Problema"),a.guardando_nuevo=!1}),a.el_evento_actual()},a.update_evento=function(){return a.guardando_edit=!0,b.one("eventos/update").customPUT(a.currentEvent).then(function(b){return console.log("Evento editado",b),a.guardando_edit=!1,f.success("Evento actualizado con éxito.")},function(b){return console.log("El Evento no se pudo editar",b),f.warning("No se pudo editar evento.","Problema"),a.guardando_edit=!1}),a.el_evento_actual()},a.crear_evento=function(){return a.editando=!1,a.creando=!0},a.cancelar_newevento=function(){return a.creando=!1},a.cancelar_currentEvento=function(){return a.editando=!1},a.editarEvento=function(b){return a.editando=!0,a.currentEvent=b,console.log("currentEvent",b)},a.quitandoIdiomas=function(c,d){var e;return console.log(c),e={evento_id:a.currentEvent.id,idioma_id:c.id},b.one("idiomas/destroy").customDELETE("",e).then(function(a){return f.success("Idioma quitado con éxito.","Eliminado")},function(a){return f.warning("No se pudo eliminar idioma.","Problema"),console.log("Error eliminando idioma: ",a)}),a.el_evento_actual()},a.idiomasSelect=function(c,d){var e;return console.log(c,a.currentEvent.idiomas_extras),e={evento_id:a.currentEvent.id,idioma_id:c.id},b.one("idiomas/store").customPOST(e).then(function(a){return f.success("Idioma agregado con éxito.","Añadido")},function(a){return f.warning("No se pudo agregar idioma.","Problema"),console.log("Error agregando idioma: ",a)}),a.el_evento_actual()},a.eliminarEvento=function(b){var f;return f=c.open({templateUrl:e.views+"eventos/removeEvento.tpl.html",controller:"RemoveEventoCtrl",resolve:{elemento:function(){return b}}}),f.result.then(function(b){return a.USER.eventos=d("filter")(a.USER.eventos,{id:"!"+b.id}),console.log("Resultado del modal: ",b)}),a.el_evento_actual()},a.traerEventos()}]).controller("RemoveEventoCtrl",["$scope","$modalInstance","elemento","Restangular","toastr",function(a,b,c,d,e){return a.elemento=c,a.ok=function(){return d.all("eventos/destroy").customDELETE(c.id).then(function(a){return e.success("Evento eliminado con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("cancel")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("EventosUserCtrl",["$scope","Restangular",function(a,b){}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(a,b,c){return b.state("panel.entidades",{url:"^/entidades",views:{contenido_panel:{templateUrl:""+a.views+"entidades/entidades.tpl.html",controller:"EntidadesCtrl"}},data:{pageTitle:"Entidades"}}),c.translations("EN",{ENTIDADES_TITLE:"Entities"}).translations("ES",{ENTIDADES_TITLE:"Entidades"})}])}.call(this),function(){angular.module("WissenSystem").controller("EntidadesCtrl",["$scope","Restangular","uiGridConstants","App","$filter","$modal","toastr",function(a,b,c,d,e,f,g){var h,i;a.imgSystemPath=d.imgSystemPath,a.perfilPath=d.perfilPath,a.creando=!1,a.editando=!1,a.imagenes=[{id:1,nombre:"gato-dormido-ordenador.jpg","public":!0},{id:2,nombre:"gato-dormido-ordenador.jpg","public":!0}],h='<a tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs shiny icon-only info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-default btn-xs shiny icon-only danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:50,enableCellEdit:!1,enableColumnMenu:!1},{name:"edit",displayName:"Edit",width:70,enableSorting:!1,enableFiltering:!1,cellTemplate:h+i,enableCellEdit:!1,enableColumnMenu:!1},{field:"nombre",filter:{condition:c.filter.CONTAINS},enableHiding:!1},{field:"alias",width:70,filter:{condition:c.filter.CONTAINS},displayName:"Alias"},{field:"lider_nombre",displayName:"Lider",filter:{condition:c.filter.CONTAINS}}],multiSelect:!1,onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,f){return console.log("Fila editada, ",c," Column:",d," newValue:"+e+" oldValue:"+f),e!==f&&b.one("entidades/update",c.id).customPUT(c).then(function(b){return a.toastr.success("Entidad actualizada con éxito","Actualizado")},function(b){return a.toastr.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",b)}),a.$apply()})}},b.all("entidades").getList().then(function(b){return a.gridOptions.data=b}),a.editar=function(b){return a.creando=!1,a.editando=!0,a.currentEntidad=b,console.log(b,a.guardando,a.editando)},a.eliminar=function(b){var c;return c=f.open({templateUrl:d.views+"eventos/removeEvento.tpl.html",controller:"RemoveEntidadCtrl",resolve:{elemento:function(){return b}}}),c.result.then(function(b){return a.gridOptions.data=e("filter")(a.gridOptions.data,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},a.crearNuevo=function(){return a.creando=!0,a.editando=!1},a.cancelarNuevo=function(){return a.creando=!1,a.guardando=!1},a.cancelarEdit=function(){return a.editando=!1},a.guardando=!1,a.guardar_nuevo=function(){return a.guardando=!0,b.one("entidades/store").customPOST(a.newEntidad).then(function(b){return console.log("Entidad guardado",b),a.gridOptions.data.push(b),a.guardando=!1,a.creando=!1,g.success("Entidad guardada con éxito.","Creado"),a.newEntidad={nombre:"",lider_nombre:""}},function(b){return console.log("No se pudo guardar el entidad",b),g.warning("No se pudo crear entidad.","Problema"),a.guardando=!1})},a.guardando_cambios=!1,a.guardar_cambios=function(){return a.guardando_cambios=!0,b.one("entidades/update").customPUT(a.currentEntidad).then(function(b){return a.guardando_cambios=!1,a.editando=!1,g.success("Entidad guardada con éxito.","Creado"),a.newEntidad={nombre:"",lider_nombre:""}},function(b){return console.log("No se pudo guardar entidad",b),g.warning("No se pudo crear entidad.","Problema"),a.guardando_cambios=!1})}}]).controller("RemoveEntidadCtrl",["$scope","$modalInstance","elemento","Restangular","toastr",function(a,b,c,d,e){return a.elemento=c,a.ok=function(){return d.all("entidades/destroy").customDELETE(c.id).then(function(a){return e.success("Entidad eliminada con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar elemento.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("cancel")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(a,b,c){return b.state("panel.evaluaciones",{url:"^/evaluaciones",views:{contenido_panel:{templateUrl:""+a.views+"evaluaciones/evaluaciones.tpl.html",controller:"EvaluacionesCtrl"}},data:{pageTitle:"Evaluaciones"}}),c.translations("EN",{ENTIDADES_TITLE:"Tests"}).translations("ES",{ENTIDADES_TITLE:"Evaluaciones"})}])}.call(this),function(){angular.module("WissenSystem").controller("EvaluacionesCtrl",["$scope","Restangular","App","toastr",function(a,b,c,d){a.comprobar_evento_actual=function(){return a.evento_actual?a.evento_actual.idioma_principal_id?a.idioma={selected:a.evento_actual.idioma_principal_id}:void 0:d.warning("Pimero debes crear o seleccionar un evento actual")},a.comprobar_evento_actual(),a.$on("cambio_evento_user",function(){return a.comprobar_evento_actual()}),a.$on("cambia_evento_actual",function(){return a.comprobar_evento_actual()}),a.imgSystemPath=c.imgSystemPath,a.perfilPath=c.perfilPath,a.creando=!1,a.editando=!1,a.newEvaluacion={},a.currentEvalua={},a.categorias_king=[],b.all("categorias/categorias-usuario").getList().then(function(b){return a.categorias_king=b}),a.crearNuevo=function(){return a.creando=!0},a.cancelarNuevo=function(){return a.creando=!1},a.cancelarEdit=function(){return a.editando=!1},a.guardando=!1,a.guardarNuevo=function(){return a.guardando=!0,b.one("evaluaciones/store").customPOST(a.newEvaluacion).then(function(b){return a.evaluaciones.push(b),console.log(a.evaluaciones),a.guardando=!1,a.creando=!1,d.success("Evaluación guardada con éxito"),console.log("Evaluación guardada con éxito",b)},function(b){return d.warning("Evaluación guardada con éxito"),a.guardando=!1,console.log("No se pudo guardar la evaluación",b)})}}])}.call(this),function(){angular.module("WissenSystem").directive("gridEvaluaciones",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"evaluaciones/gridEvaluacionesDir.tpl.html",scope:{currenteval:"=",evaluaciones:"=",categoriasking:"=",idioma:"="},link:function(a,b,c){},controller:"GridEvaluacionesCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("GridEvaluacionesCtrl",["$scope","Restangular","uiGridConstants","$modal","$filter","App","toastr",function(a,b,c,d,e,f,g){var h,i,j,k;h='<a tooltip="Editar" tooltip-placement="left" class="btn btn-xs btn-info" ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',i='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-xs btn-danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a>',k='<span ng-bind="row.entity.categoria_id | nombreCategoria:grid.appScope.categoriasking:grid.appScope.idioma"></span>',j='<md-checkbox ng-true-value="1" ng-false-value="0" ng-model="row.entity.actual" ng-change="grid.appScope.setActual(row.entity)" aria-label="Actual" ng-disable="row.entity.actualizando" style="margin-top: 0px;">Actual</md-checkbox>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enebleGridColumnMenu:!1,columnDefs:[{field:"id",displayName:"Id",width:60,enableCellEdit:!1,enableColumnMenu:!1},{name:"edit",displayName:"Edit",width:80,enableSorting:!1,enableFiltering:!1,cellTemplate:h+i,enableCellEdit:!1,enableColumnMenu:!1},{field:"descripcion",displayName:"Descripción",filter:{condition:c.filter.CONTAINS},enableHiding:!1},{field:"categoria_id",displayName:"Categoría",filter:{condition:c.filter.CONTAINS},cellTemplate:k,enableCellEdit:!1},{field:"actual",displayName:"Actual",width:90,filter:{condition:c.filter.CONTAINS},cellTemplate:j,enableCellEdit:!1}],multiSelect:!1,onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,f){return console.log("Fila editada, ",c," Column:",d," newValue:"+e+" oldValue:"+f),e!==f&&b.one("evaluaciones/update").customPUT(c).then(function(a){return g.success("Evaluaciones actualizada con éxito","Actualizado")},function(a){return g.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}},b.all("evaluaciones").getList().then(function(b){return a.evaluaciones=b,a.gridOptions.data=a.evaluaciones}),a.setActual=function(c){return c.actualizando=!0,console.log(c),b.one("evaluaciones/set-actual").customPUT(c).then(function(b){var d,f,h,i,j;for(g.success("Actualizado con éxito","Actualizado"),c.actualizando=!1,d=e("filter")(a.evaluaciones,{categoria_id:c.categoria_id}),j=[],h=0,i=d.length;i>h;h++)f=d[h],f.id!==c.id?j.push(f.actual=0):j.push(void 0);return j},function(a){return g.warning("No se cambió como actual o no"),console.log("No estableció como actual o no",a),c.actualizando=!1})},a.editar=function(b){return a.$parent.creando=!1,a.$parent.editando=!0,a.$parent.currentEvaluacion=b},a.eliminar=function(b){var c;return c=d.open({templateUrl:f.views+"evaluaciones/removeEvaluacion.tpl.html",controller:"RemoveEvaluacionCtrl",resolve:{elemento:function(){return b},categoriasking:function(){return a.categoriasking}}}),c.result.then(function(b){return a.evaluaciones=e("filter")(a.evaluaciones,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})}}]).controller("RemoveEvaluacionCtrl",["$scope","$modalInstance","elemento","categoriasking","Restangular","toastr",function(a,b,c,d,e,f){return a.elemento=c,a.categoriasking=d,console.log("elemento",c,d),a.ok=function(){return e.all("evaluaciones/destroy").customDELETE(c.id).then(function(a){return f.success("Evaluacion eliminada con éxito.","Eliminado"),b.close(c)},function(a){return f.warning("No se pudo eliminar evaluación.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").config(["$stateProvider","App","$translateProvider",function(a,b,c){return a.state("panel.preguntas",{url:"^/preguntas",views:{contenido_panel:{templateUrl:""+b.views+"preguntas/preguntas.tpl.html",controller:"PreguntasCtrl"}},data:{pageTitle:"Preguntas"}}),c.translations("EN",{BUSCAR_PLACEHOLDER:"Find",TIP_BTN_NUEVA_PREGUNTA:"Create a new question",BTN_NUEVA_PREGUNTA:"New question"}).translations("ES",{BUSCAR_PLACEHOLDER:"Buscar",TIP_BTN_NUEVA_PREGUNTA:"Crear una nueva pregunta",BTN_NUEVA_PREGUNTA:"Nueva pregunta"})}])}.call(this),function(){"use strict";angular.module("WissenSystem").controller("PreguntasCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","preguntasServ","$filter",function(a,b,c,d,e,f,g,h,i){return a.preguntas_king=[],a.evalu_seleccionada={id:-1},a.grupo="grupo",a.king="king",a.comprobar_evento_actual=function(){return a.evento_actual?a.evento_actual.idioma_principal_id?a.idiomaPreg={selected:a.evento_actual.idioma_principal_id}:void 0:g.warning("Pimero debes crear o seleccionar un evento actual")},a.comprobar_evento_actual(),a.$on("cambio_evento_user",function(){return a.comprobar_evento_actual()}),a.$on("cambia_evento_actual",function(){return a.comprobar_evento_actual()}),a.creando=!1,a.inicializado=!1,a.showDetail=!1,a.categoria=0,a.evaluacion_id=0,a.preguntas_king=[],a.preguntas_king2=[],a.categorias=[],a.traerDatos=function(){return c.all("categorias/categorias-usuario").getList().then(function(b){return a.categorias=b,a.categorias.length>0?(a.categoria=b[0].id,a.traerEvaluaciones(),a.traerPreguntas()):void 0},function(a){return console.log("No se trajeron las categorías ",a)})},a.traerDatos(),a.traerEvaluaciones=function(){return c.all("evaluaciones").getList({categoria_id:a.categoria}).then(function(b){return a.evaluaciones=b},function(a){return console.log("No se trajeron las evaluaciones ",a)})},a.traerPreguntas=function(){return c.all("preguntas").getList({categoria_id:a.categoria}).then(function(b){return a.preguntas_king=b,a.preguntas_king2=b,a.inicializado=!0,console.log("$scope.inicializado",a.inicializado)},function(b){
return console.log("Pailas la promesa de las preguntas ",b),a.inicializado=!0})},a.traerPreguntasYEvaluaciones=function(){return a.traerPreguntas(),a.traerEvaluaciones()},a.traerPreguntasDeEvaluacion=function(){var b;return"sin_asignar"===a.evaluacion_id?c.all("pregunta_evaluacion/solo-sin-asignar").getList({categoria_id:a.categoria}).then(function(b){return a.preguntas_king=b},function(b){return console.log("No se trajo las preguntas sin asignar ",b),a.inicializado=!0}):(a.traerPreguntas(),b=i("filter")(a.evaluaciones,{id:a.evaluacion_id}),b.length>0&&(a.preguntas_evaluacion=b[0].preguntas_evaluacion),console.log("$scope.evaluacion",a.evaluacion_id,a.preguntas_evaluacion))},a.selectEvaluacion=function(b,c){var d,e,f,g,h;for(a.evalu_seleccionada=b,h=a.evaluaciones,f=0,g=h.length;g>f;f++)d=h[f],d.selected=!1;return b.selected=!0,e=i("filter")(a.evaluaciones,{id:b.id}),e.length>0?a.preguntas_evaluacion2=e[0].preguntas_evaluacion:void 0},a.$on("finalizaEdicionPreg",function(a){}),a.$on("preguntaEliminada",function(b,c){return a.preguntas_king=i("filter")(a.preguntas_king,{id:"!"+c.id,tipo_pregunta:"!undefined"},!0),console.log("Recibido eliminación",c,i("filter")(a.preguntas_king,{id:"!"+c.id,tipo_pregunta:"!undefined"}))}),a.$on("preguntaQuitada",function(b,c){return a.preguntas_evaluacion2=i("filter")(a.preguntas_evaluacion2,{id:"!"+c}),console.log("Recibido quitada",c)}),a.$on("grupoEliminado",function(b,c){return a.preguntas_king=i("filter")(a.preguntas_king,function(a,b){return a.tipo_pregunta?!0:a.id!==c.id?!0:!1})})}]).filter("pregsByCatsAndEvaluacion",["$filter",function(a){return function(b,c,d,e){var f,g,h,i,j;for(h=[],i=0,j=b.length;j>i;i++)g=b[i],parseFloat(g.categoria_id)===parseFloat(c)&&(e&&0!==parseFloat(e)?(f=!1,f=g.tipo_pregunta?a("filter")(d,{pregunta_id:g.id}):a("filter")(d,{grupo_pregs_id:g.id}),f&&f.length>0&&(g.pregunta_eval_id=f[0].id,g.orden=f[0].orden,h.push(g))):h.push(g));return h}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPreguntaCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr",function(a,b,c,d,e,f,g){a.eventoactualselec=parseInt(a.eventoactualselec),a.idiomaPreg=[a.eventoactualselec],a.editorOptions={inlineMode:!0,placeholder:""},a.mostrarConfiguracion=!1,a.mostrarConfig=function(){return a.mostrarConfiguracion=!a.mostrarConfiguracion},a.cerrarEdicion=function(){return a.preguntaking.editando=!1},a.finalizarEdicion=function(){return a.$emit("finalizaEdicionPreg"),c.one("preguntas/update").customPUT(a.preguntaking).then(function(b){return console.log("Cambios guardados",b),a.preguntaking.editando=!1,g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},a.aplicarCambios=function(){return c.one("preguntas/update").customPUT(a.preguntaking).then(function(a){return console.log("Cambios guardados",a),g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},a.cambiaTipoPregunta=function(){return console.log("Cambia el tipo: ",a.preguntaking.tipo_pregunta),a.$broadcast("cambiaTipoPregunta")}}])}.call(this),function(){angular.module("WissenSystem").directive("editPregunta",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"preguntas/editPreguntaDir.tpl.html",scope:{preguntaking:"=",eventoactual:"=",eventoactualselec:"@"},link:function(a,b,c){},controller:"EditPreguntaCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("editPregTraducDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"preguntas/editPregTraducDir.tpl.html",scope:{preguntatraduc:"=",preguntaking:"=",eventoactual:"="},link:function(a,b,c){},controller:"EditPregTraducDirCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPregTraducDirCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","$filter",function(a,b,c,d,e,f,g,h){var i;return i="Agregar nueva opción",a.inicializar=function(){var b,c,d,e,f;for(f=a.preguntatraduc.opciones,d=0,e=f.length;e>d;d++)if(c=f[d],c.nueva)return;return b={id:-1,definicion:i,nueva:!0,is_correct:!1},a.preguntatraduc.opciones.push(b)},a.inicializar(),a.sortableOptions={"ui-floating":!0,update:function(b,d){var e,f,g,h,i,j,k,l;for(i=[],l=a.preguntatraduc.opciones,g=j=0,k=l.length;k>j;g=++j)h=l[g],-1!==h.id&&(f={},f[""+h.id]=g,i.push(f));return e={pregunta_traduc_id:a.preguntatraduc.id,sortHash:i},c.one("opciones/update-orden").customPUT(e).then(function(a){return console.log("Orden guardado")},function(a){return console.log("No se pudo guardar el orden",a)})}},a.addButtonNewOpcion=function(a,b){return b.creando=!0,b.nueva?(b.definicion="Opción "+a.opciones.length,b.preg_traduc_id=a.id,b.orden=a.opciones.length-1,1===a.opciones.length&&(b.is_correct=!0),c.one("opciones/store").customPOST(b).then(function(c){var d;return console.log("Opción guardada"),b.id=c.id,b.nueva=!1,b.creando=!1,d={id:-1,definicion:i,nueva:!0,is_correct:!1},a.opciones.push(d)},function(a){return console.log("No se pudo guardar la opción",a),b.definicion=i,b.creando=!1,g.warning("No se pudo crear nueva opción")})):void 0},a.setAsCorrect=function(b,c){return"Test"===a.preguntaking.tipo_pregunta&&(angular.forEach(b.opciones,function(a){return a.is_correct=0}),c.is_correct=1),"Multiple"===a.preguntaking.tipo_pregunta?c.is_correct=1:void 0},a.deleteOption=function(a,b,d){return c.one("opciones/destroy",b.id).customDELETE().then(function(c){return console.log("Opción eliminada",c),a.opciones=h("filter")(a.opciones,{id:"!"+b.id})},function(a){return console.log("No se pudo eliminar la opción",a),g.warning("No se pudo eliminar la opción")})},a.$on("cambiaTipoPregunta",function(){var b,c,d,e,f,g,h;if("Test"===a.preguntaking.tipo_pregunta){for(g=a.preguntaking.preguntas_traducidas,h=[],e=0,f=g.length;f>e;e++)d=g[e],b=0,h.push(function(){var a,e,f,g;for(f=d.opciones,g=[],a=0,e=f.length;e>a;a++)c=f[a],c.is_correct?b>0?g.push(c.is_correct=0):g.push(b+=1):g.push(void 0);return g}());return h}})}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","$mdToast","$modal","$filter",function(a,b,c,d,e,f,g,h,i){return a.elegirOpcion=function(a,b){return angular.forEach(a.opciones,function(a){return a.elegida=!1}),b.elegida=!0},a.toggleMostrarAyuda=function(a){return a.mostrar_ayuda=!a.mostrar_ayuda},a.asignarAEvaluacion=function(c){var d;return d=h.open({templateUrl:b.views+"preguntas/asignarPregunta.tpl.html",controller:"AsignarPreguntaCtrl",resolve:{pregunta:function(){return c},evaluaciones:function(){return a.evaluaciones}}}),d.result.then(function(a){return console.log("Resultado del modal: ",a)})},a.indexChar=function(a){return String.fromCharCode(65+a)},a.editarPregunta=function(a){return a.editando=!0},a.eliminarPregunta=function(c){var d;return console.log("Presionado para eliminar fila: ",c),d=h.open({templateUrl:b.views+"preguntas/removePregunta.tpl.html",controller:"RemovePreguntaCtrl",resolve:{pregunta:function(){return c}}}),d.result.then(function(b){return a.$emit("preguntaEliminada",b),console.log("Resultado del modal: ",b)})},a.previewPregunta=function(a){return a.showDetail===!0?a.showDetail=!1:a.showDetail=!0}}]).controller("RemovePreguntaCtrl",["$scope","$modalInstance","pregunta","Restangular","toastr",function(a,b,c,d,e){return a.pregunta=c,a.ok=function(){return d.all("preguntas/destroy/"+c.id).remove().then(function(a){return e.success("Pregunta eliminada con éxito.","Eliminada")},function(a){return e.warning("No se pudo eliminar la pregunta.","Problema"),console.log("Error eliminando pregunta: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("AsignarPreguntaCtrl",["$scope","$modalInstance","pregunta","evaluaciones","Restangular","toastr","$filter",function(a,b,c,d,e,f,g){return a.pregunta=c,a.evaluaciones=d,a.asignando=!1,a.selected=!1,a.ok=function(){var h;return a.asignando=!0,h={pregunta_id:c.id,evaluacion_id:a.selected},e.all("pregunta_evaluacion/asignar-pregunta").customPUT(h).then(function(c){var e;return f.success("Pregunta asignada con éxito."),a.asignando=!1,e=g("filter")(d,{id:a.selected})[0],e.preguntas_evaluacion.push(c),b.close(c)},function(b){return f.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",b),a.asignando=!1})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaEvalCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","$mdToast","$modal","$filter","toastr",function(a,b,c,d,e,f,g,h,i,j){return a.indexChar=function(a){return String.fromCharCode(65+a)},a.quitarPregunta=function(b){var d;return console.log("Aqui quito la preg",b.pregunta_eval_id,a.preguntasevaluacion2),a.quitando=!0,d={pregunta_id:b.id,evaluacion_id:a.selected,pregunta_eval_id:b.pregunta_eval_id},c.all("pregunta_evaluacion/quitar-pregunta").customPUT(d).then(function(c){return j.success("Pregunta quitada con éxito."),a.quitando=!1,a.$emit("preguntaQuitada",b.pregunta_eval_id)},function(b){return j.warning("No se pudo asignar la pregunta.","Problema"),console.log("Error asignando pregunta: ",b),a.quitando=!1})}}])}.call(this),function(){angular.module("WissenSystem").directive("viewPregunta",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"preguntas/viewPreguntaDir.tpl.html",scope:{idiomapreg:"=",preguntaking:"=",indice:"=",eventoactual:"=",eventoactualselec:"=",evaluaciones:"="},link:function(a,b,c){},controller:"ViewPreguntaCtrl"}}]).directive("viewPreguntaEval",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"preguntas/viewPreguntaEvalDir.tpl.html",scope:{idiomapreg:"=",preguntaking:"=",indice:"=",eventoactual:"=",eventoactualselec:"=",evaluaciones:"=",preguntasevaluacion2:"="},link:function(a,b,c){},controller:"ViewPreguntaEvalCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("AddPreguntaCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","$mdToast","toastr",function(a,b,c,d,e,f,g,h){return console.log("Add pregunta dir"),a.creando=!1,a.addNewPregunta=function(){return a.creando=!0,c.one("preguntas/store").customPOST({categoria_id:a.categoria}).then(function(b){return b.editando=!0,a.creando=!1,a.preguntasking.push(b),console.log("Pregunta añadida: ",a.preguntasking)},function(b){return console.log("Rechazada la nueva ",b),a.creando=!1,h.warning("No se creó pregunta","Problema")})},a.addNewPreguntaGrupo=function(){return a.creando=!0,c.one("grupo_preguntas/store").customPOST({categoria_id:a.categoria}).then(function(b){return b.editando=!0,a.creando=!1,a.preguntasking.push(b),console.log("Pregunta añadida: ",a.preguntasking)},function(b){return console.log("Rechazada la nueva ",b),a.creando=!1,h.warning("No se creó el grupo pregunta","Problema")})}}])}.call(this),function(){angular.module("WissenSystem").directive("addPregunta",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"preguntas/addPreguntaDir.tpl.html",scope:{preguntasking:"=",categoria:"=",examen:"=",tipo:"="},link:function(a,b,c){},controller:"AddPreguntaCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("viewGrupo",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"grupopreg/viewGrupoDir.tpl.html",scope:{idiomapreg:"=",grupoking:"=",indice:"=",eventoactual:"=",idiomaactualselec:"=",evaluaciones:"="},link:function(a,b,c){},controller:"ViewGrupoCtrl"}}]).directive("viewGrupoEval",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"grupopreg/viewGrupoEvalDir.tpl.html",scope:{idiomapreg:"=",grupoking:"=",indice:"=",eventoactual:"=",idiomaactualselec:"=",evaluaciones:"=",preguntasevaluacion2:"="},link:function(a,b,c){},controller:"ViewGrupoEvalCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","toastr","$modal","$filter",function(a,b,c,d,e,f,g,h,i){"$scope.idiomaactualselec = parseInt($scope.idiomaactualselec)\n$scope.idiomaPreg = $scope.idiomaactualselec";return a.creando=!1,a.addNewPregunta=function(b){return a.creando=!0,c.one("preguntas_agrupadas/store").customPOST({contenido_id:b.id}).then(function(c){return c.editando=!0,a.creando=!1,b.preguntas_agrupadas.push(c),console.log("Pregunta añadida: ",b)},function(b){return console.log("Rechazada la nueva ",b),a.creando=!1,g.warning("No se creó pregunta","Problema")})},a.asignarAEvaluacion=function(c){var d;return d=h.open({templateUrl:b.views+"grupopreg/asignarGrupo.tpl.html",controller:"AsignarGrupoCtrl",resolve:{pregunta:function(){return c},evaluaciones:function(){return a.evaluaciones}}}),d.result.then(function(a){return console.log("Resultado del modal: ",a)})},a.toggleMostrarAyuda=function(a){return a.mostrar_ayuda=!a.mostrar_ayuda},a.indexChar=function(a){return String.fromCharCode(65+a)},a.editarGrupo=function(a){return a.editando=!0},a.eliminarContenido=function(c){var d;return d=h.open({templateUrl:b.views+"grupopreg/removeGrupo.tpl.html",controller:"RemoveGrupoCtrl",resolve:{grupoking:function(){return c}}}),d.result.then(function(b){return a.$emit("grupoEliminado",b),console.log("Resultado del modal: ",b)})},a.editarPreguntaAgrup=function(a){return a.editando=!0},a.eliminarPreguntaAgrup=function(c,d){var e;return e=h.open({templateUrl:b.views+"grupopreg/removePreguntaAgrup.tpl.html",controller:"RemovePreguntaAgrupCtrl",resolve:{preg_agrup:function(){return c}}}),e.result.then(function(b){return a.$emit("pregAgrupEliminada",b),console.log("Resultado del modal: ",c.id,i("filter")(d.preguntas_agrupadas,{id:"!"+c.id})),d.preguntas_agrupadas=i("filter")(d.preguntas_agrupadas,{id:"!"+c.id})})},a.previewPreguntaAgrup=function(a){return a.showDetail=!a.showDetail}}]).controller("RemoveGrupoCtrl",["$scope","$modalInstance","grupoking","Restangular","toastr",function(a,b,c,d,e){return a.grupoking=c,a.ok=function(){return d.all("grupo_preguntas/destroy/"+c.id).remove().then(function(a){return e.success("Pregunta eliminada con éxito.","Eliminada")},function(a){return e.warning("No se pudo eliminar la grupoking.","Problema"),console.log("Error eliminando grupoking: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("RemovePreguntaAgrupCtrl",["$scope","$modalInstance","preg_agrup","Restangular","toastr",function(a,b,c,d,e){return a.preg_agrup=c,a.ok=function(){return d.all("preguntas_agrupadas/destroy/"+c.id).remove().then(function(a){return e.success("Pregunta eliminada con éxito.","Eliminada")},function(a){return e.warning("No se pudo eliminar la preg_agrup.","Problema"),console.log("Error eliminando preg_agrup: ",a)}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).controller("AsignarGrupoCtrl",["$scope","$modalInstance","pregunta","evaluaciones","Restangular","toastr","$filter",function(a,b,c,d,e,f,g){return a.pregunta=c,a.evaluaciones=d,a.asignando=!1,a.selected=!1,a.ok=function(){var h;return a.asignando=!0,h={grupo_pregs_id:c.id,evaluacion_id:a.selected},e.all("pregunta_evaluacion/asignar-grupo").customPUT(h).then(function(c){var e;return f.success("Grupo asignado con éxito."),a.asignando=!1,e=g("filter")(d,{id:a.selected})[0],e.preguntas_evaluacion.push(c),b.close(c)},function(b){return f.warning("No se pudo asignar el grupo.","Problema"),console.log("Error asignando el grupo: ",b),a.asignando=!1})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoEvalCtrl",["$scope","App","Restangular","$state","$cookies","$rootScope","toastr","$modal","$filter",function(a,b,c,d,e,f,g,h,i){return a.quitando=!1,a.quitarPregunta=function(b){var d,e;return a.quitando=!0,e=i("filter")(a.preguntasevaluacion2,{grupo_pregs_id:b.id})[0],d={pregunta_id:b.id,evaluacion_id:e.evaluacion_id,pregunta_eval_id:b.pregunta_eval_id},c.all("pregunta_evaluacion/quitar-pregunta").customPUT(d).then(function(c){return g.success("Pregunta quitada con éxito."),a.quitando=!1,a.$emit("preguntaQuitada",b.pregunta_eval_id)},function(b){return g.warning("No se pudo quitar la pregunta grupo.","Problema"),console.log("Error quitando pregunta: ",b),a.quitando=!1})}}])}.call(this),function(){angular.module("WissenSystem").directive("editContenido",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"grupopreg/editContenidoDir.tpl.html",scope:{grupoking:"=",indice:"=",eventoactual:"=",idiomaactualselec:"="},link:function(a,b,c){},controller:"EditContenidoCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditContenidoCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr",function(a,b,c,d,e,f,g){a.idiomaactualselec=parseInt(a.idiomaactualselec),a.idiomaPreg=[a.idiomaactualselec],a.editorOptions={inlineMode:!0,placeholder:""},a.cerrarEdicion=function(){return a.grupoking.editando=!1},a.finalizarEdicion=function(){var b;return a.$emit("finalizaEdicionContenido"),b={contenidos_traducidos:a.grupoking.contenidos_traducidos},c.one("contenido_traduc/update").customPUT(b).then(function(b){return console.log("Cambios guardados",b),a.grupoking.editando=!1,g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},a.aplicarCambios=function(){var b;return b={contenidos_traducidos:a.grupoking.contenidos_traducidos},c.one("contenido_traduc/update").customPUT(b).then(function(a){return console.log("Cambios guardados",a),g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")}}])}.call(this),function(){angular.module("WissenSystem").directive("editPreguntaAgrupada",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"grupopreg/editPreguntaAgrupDir.tpl.html",scope:{pregagrup:"="},link:function(a,b,c){},controller:"EditPreguntaAgrupCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("EditPreguntaAgrupCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr",function(a,b,c,d,e,f,g){var h;a.editorOptions={inlineMode:!0,placeholder:""},h="Agregar nueva opción",a.inicializar=function(){var b,c,d,e,f;for(f=a.pregagrup.opciones,d=0,e=f.length;e>d;d++)if(c=f[d],c.nueva)return;return b={id:-1,definicion:h,nueva:!0,is_correct:!1},a.pregagrup.opciones.push(b)},a.inicializar(),a.sortableOptions={"ui-floating":!0,update:function(b,d){var e,f,g,h,i,j,k,l;for(i=[],l=a.pregagrup.opciones,g=j=0,k=l.length;k>j;g=++j)h=l[g],-1!==h.id&&(f={},f[""+h.id]=g,i.push(f));return e={pregunta_agrupada_id:a.pregagrup.id,sortHash:i},c.one("opciones_agrupadas/update-orden").customPUT(e).then(function(a){return console.log("Orden guardado")},function(a){return console.log("No se pudo guardar el orden",a)})}},a.addButtonNewOpcion=function(a,b){return b.creando=!0,b.nueva?(b.definicion="Opción "+a.opciones.length,b.preg_agrupada_id=a.id,b.orden=a.opciones.length-1,1===a.opciones.length&&(b.is_correct=!0),c.one("opciones_agrupadas/store").customPOST(b).then(function(c){var d;return console.log("Opción guardada"),b.id=c.id,b.nueva=!1,b.creando=!1,d={id:-1,definicion:h,nueva:!0,is_correct:!1},a.opciones.push(d)},function(a){return console.log("No se pudo guardar la opción",a),b.definicion=h,b.creando=!1,g.warning("No se pudo crear nueva opción")})):void 0},a.setAsCorrect=function(b,c){return"Test"===a.pregagrup.tipo_pregunta&&(angular.forEach(b.opciones,function(a){return a.is_correct=0}),c.is_correct=1),"Multiple"===a.pregagrup.tipo_pregunta?c.is_correct=1:void 0},a.deleteOption=function(a,b,d){return c.one("opciones_agrupadas/destroy",b.id).customDELETE().then(function(c){return console.log("Opción eliminada",c),a.opciones=$filter("filter")(a.opciones,{id:"!"+b.id})},function(a){return console.log("No se pudo eliminar la opción",a),g.warning("No se pudo eliminar la opción")})},a.cerrarEdicion=function(){return a.pregagrup.editando=!1},a.mostrarConfiguracion=!1,a.mostrarConfig=function(){return a.mostrarConfiguracion=!a.mostrarConfiguracion},a.finalizarEdicion=function(){return a.$emit("finalizaEdicionPregAgrup"),c.one("preguntas_agrupadas/update").customPUT(a.pregagrup).then(function(b){return console.log("Cambios guardados",b),a.pregagrup.editando=!1,g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},a.aplicarCambios=function(){return c.one("preguntas_agrupadas/update").customPUT(a.pregagrup).then(function(a){return console.log("Cambios guardados",a),g.success("Cambios guardados con éxito")},function(a){return console.log("No se pudo guardar los cambios",a),g.warning("Cambios NO guardados","Problema")}),console.log("Guardando cambios...")},a.cambiaTipoPregunta=function(){var b,c,d,e,f,g;if(console.log("Cambia el tipo: ",a.pregagrup.tipo_pregunta),"Test"===a.pregagrup.tipo_pregunta){for(b=0,f=a.pregagrup.opciones,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.is_correct?b>0?g.push(c.is_correct=0):g.push(b+=1):g.push(void 0);return g}}}])}.call(this),function(){angular.module("WissenSystem").directive("iniciarDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"examen_respuesta/iniciarDir.tpl.html",scope:{eventoactual:"=",user:"="},link:function(a,b,c){},controller:"IniciarCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("IniciarCtrl",["$scope","Restangular","toastr","$filter","AuthService","$state","$modal","App",function(a,b,c,d,e,f,g,h){return a.categorias_king=[],a.traer_categorias_evento=function(){return b.all("categorias/categorias-evento").getList().then(function(b){return a.categorias_king=b},function(a){return c.warning("No se trajeron las categorias del evento","Problema"),console.log("No se trajo categorias ",a)})},e.hasRoleOrPerm(["admin","profesor","tecnico"])?a.$parent.traerEventos():a.traer_categorias_evento(),a.iniciarExamen=function(b){var c;return c=g.open({templateUrl:h.views+"examen_respuesta/seguroIniciarCtrl.tpl.html",controller:"SeguroIniciarCtrl",resolve:{inscripcion:function(){return b},entidades:function(){return a.$parent.entidades}}}),c.result.then(function(a){return console.log("Resultado del modal: ",a)})}}])}.call(this),function(){angular.module("WissenSystem").controller("SeguroIniciarCtrl",["$scope","$modalInstance","inscripcion","Restangular","toastr","$filter","$state","$rootScope",function(a,b,c,d,e,f,g,h){return a.inscripcion=c,a.ok=function(){return a.asignando=!0,d.all("examenes_respuesta/iniciar").customPOST(c).then(function(a){return h.examen_actual=a,g.transitionTo("panel.examen_respuesta"),b.close(a)},function(a){return e.warning("No se pudo iniciar el examen.","Problema"),console.log("Error creando el examen: ",a)})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("WissenSystem").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(a,b,c,d,e){a.state("panel.examen_respuesta",{url:"^/examen/:examen_respuesta_id",params:{examen_respuesta_id:{value:null}},views:{contenido_panel:{templateUrl:""+b.views+"examen_respuesta/examenRespuesta.tpl.html",controller:"ExamenRespuestaCtrl"}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}]},data:{pageTitle:"Examen"}}),e.translations("EN",{INICIO_MENU:"Home"}).translations("ES",{INICIO_MENU:"Inicio"})}])}.call(this),function(){angular.module("WissenSystem").controller("ExamenRespuestaCtrl",["$scope","Restangular","toastr","$filter","AuthService","$state","$modal","App","$rootScope","resolved_user","$interval",function(a,b,c,d,e,f,g,h,i,j,k){var l;return a.USER=j,a.imagesPath=h.images,a.pregunta_actual=0,a.pregunta_actual_porc=0,a.total_preguntas=0,a.cambiarTema("theme-one"),a.incializar=function(){return i.examen_actual?i.examen_actual.id||(console.log("Examen no válido",i.examen_actual),f.transitionTo("panel")):(console.log("No hay examen actual"),f.transitionTo("panel")),a.$on("$destroy",function(){return console.log("En destrucción!"),window.onbeforeunload=void 0}),a.categoria_traducida=d("categoriasTraducidas")([i.examen_actual.categoria],a.USER.idioma_main_id),a.categoria_traducida.length>0&&(a.categoria_traducida=a.categoria_traducida[0]),a.examen_actual=i.examen_actual,a.$on("respuesta_elegida",function(b,c){return a.pregunta_actual=a.pregunta_actual+1,a.pregunta_actual_porc=a.pregunta_actual/a.total_preguntas*100,console.log("pregunta_actual_porc",a.pregunta_actual_porc)}),a.$on("tiempo_preg_terminado",function(a){return console.log("Tiempo pregunta terminado")}),a.$on("tiempo_exam_terminado",function(a){return console.log("Tiempo examen terminado")}),a.tiempo_max=a.USER.gran_final?i.examen_actual.duracion_preg:i.examen_actual.duracion_exam,a.tiempo_max=60*a.tiempo_max,a.pregunta_actual=d("noPregActual")(a.examen_actual.preguntas),a.total_preguntas=d("cantPregsEvaluacion")(a.examen_actual.preguntas),a.pregunta_actual_porc=a.pregunta_actual/a.total_preguntas*100,console.log("no Preg Actual ",a.pregunta_actual,"de",a.total_preguntas,a.pregunta_actual_porc)},f.params.examen_respuesta_id?(l={exa_resp_id:f.params.examen_respuesta_id},b.all("examenes_respuesta/continuar").customPUT(l).then(function(b){return c.success("Continuamos el examen."),i.examen_actual=b,a.incializar()},function(a){return c.warning("No se pudo continuar el examen.","Problema"),console.log("Error continuando el examen: ",a)})):a.incializar(),a.guardando=function(){return console.log("Guardando")},a.finalizar_examen=function(){return console.log("Finalizar examen")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewPreguntaExamenCtrl",["$scope","Restangular","toastr","$filter","$rootScope","$state","$modal","App",function(a,b,c,d,e,f,g,h){return a.USER=a.$parent.USER,a.idioma=a.USER.idioma_main_id,a.examen_actual=e.examen_actual,a.elegirOpcion=function(b,c,d){var e;return angular.forEach(b.opciones,function(a){return a.elegida=!1}),c.elegida=!0,a.examen_actual.one_by_one?(c.letra=a.indexChar(d),e=g.open({templateUrl:h.views+"examen_respuesta/seguroRespuesta.tpl.html",controller:"SeguroRespuestaPregKingCtrl",resolve:{preguntatop:function(){return a.preguntaking},pregunta_traduc:function(){return b},opcion:function(){return c},examen_actual:function(){return a.examen_actual},agrupada:function(){return!1}}}),e.result.then(function(b){return c.respondida=!0,a.$emit("respuesta_elegida",d)})):void 0},a.toggleMostrarAyuda=function(a){return a.mostrar_ayuda=!a.mostrar_ayuda},a.indexChar=function(a){return String.fromCharCode(65+a)}}]).directive("viewPreguntaExamen",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"examen_respuesta/viewPreguntaExamenDir.tpl.html",scope:{preguntaking:"=",indice:"=",idiomapreg:"="},link:function(a,b,c){},controller:"ViewPreguntaExamenCtrl"}}]).controller("SeguroRespuestaPregKingCtrl",["$scope","$modalInstance","opcion","Restangular","toastr","$filter","examen_actual","preguntatop","pregunta_traduc","agrupada","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k){var l;return a.opcion=c,console.log(h,i),a.examen_actual=g,l={examen_actual_id:g.id,pregunta_top_id:h.id,pregunta_sub_id:i.id,idioma_id:i.idioma_id,tipo_pregunta:h.tipo_pregunta,opcion_id:c.id,tiempo:k.tiempo},a.ok=function(){var a,c,f;return c="examenes_respuesta/responder-pregunta",a="examenes_respuesta/responder-pregunta-agrupada",f=j?a:c,d.all(f).customPUT(l).then(function(a){return b.close(a)},function(a){return e.warning("No se pudo guardar respuesta.","Problema"),console.log("No se pudo guardar respuesta: ",a)})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").controller("ViewGrupoExamenCtrl",["$scope","Restangular","toastr","$filter","$rootScope","$state","$modal","App",function(a,b,c,d,e,f,g,h){return a.USER=a.$parent.USER,a.idioma=a.USER.idioma_main_id,a.examen_actual=e.examen_actual,a.elegirOpcion=function(b,d,e){var f;return angular.forEach(b.opciones,function(a){return a.elegida=!1}),d.elegida=!0,a.examen_actual.one_by_one?(d.letra=a.indexChar(e),f=g.open({templateUrl:h.views+"examen_respuesta/seguroRespuesta.tpl.html",controller:"SeguroRespuestaPregKingCtrl",resolve:{preguntatop:function(){return a.grupoking},pregunta_traduc:function(){return b},opcion:function(){return d},examen_actual:function(){return a.examen_actual},agrupada:function(){return!0}}}),f.result.then(function(a){return d.respondida=!0,c.success("Respuestuesta guardada")})):void 0},a.indexChar=function(a){return String.fromCharCode(65+a)},a.toggleMostrarAyuda=function(a){return a.mostrar_ayuda=!a.mostrar_ayuda}}]).directive("viewGrupoExamen",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"examen_respuesta/viewGrupoExamenDir.tpl.html",scope:{grupoking:"=",indice:"=",idiomapreg:"="},link:function(a,b,c){},controller:"ViewGrupoExamenCtrl"}}])}.call(this),function(){angular.module("WissenSystem").directive("timerDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"examen_respuesta/timerDir.tpl.html",scope:{tiempomax:"="},link:function(a,b,c){},controller:"TimerCtrl"}}]).controller("TimerCtrl",["$scope","Restangular","toastr","$filter","$state","$rootScope","$interval","Perfil",function(a,b,c,d,e,f,g,h){return f.tiempo=58,a.tiempo=f.tiempo,a.gran_final=a.$parent.USER.evento_actual.gran_final,a.duracion_exam=f.examen_actual.duracion_exam,a.duracion_preg=f.examen_actual.duracion_preg,g(function(){var b,c,d;if(f.tiempo++,a.tiempo=f.tiempo,c=new Date(1e3*f.tiempo),d=c.getSeconds(),b=c.getMinutes(),d=10>d?"0"+d:d,b=10>b?"0"+b:b,a.tiempo_formateado=b+":"+d,a.gran_final){if(a.duracion_preg<1e3*a.tiempo)return a.$emit("tiempo_preg_terminado")}else if(a.duracion_exam<6e4*a.tiempo)return a.$emit("tiempo_exam_terminado")},1e3,0)}])}.call(this),function(){angular.module("WissenSystem").config(["$stateProvider","App","PERMISSIONS",function(a,b,c){return a.state("panel.usuarios",{url:"^/usuarios",views:{contenido_panel:{templateUrl:""+b.views+"usuarios/usuarios.tpl.html",controller:"UsuariosCtrl"}},data:{pageTitle:"Usuarios",needed_permissions:[c.can_edit_usuarios]}})}])}.call(this),function(){angular.module("WissenSystem").controller("UsuariosCtrl",["$scope","$http","Restangular","$state","$cookies","$rootScope","toastr","uiGridConstants","$modal","$filter","App","AuthService",function(a,b,c,d,e,f,g,h,i,j,k,l){l.verificar_acceso(),a.imagesPath=k.images,a.usuarios=[],a.currentUsers=[],a.currentUser={inscripciones:[]},a.newUsu={sexo:"M",nivel:"",inscripciones:[]},a.editando=!1,a.creando=!1,a.comprobar_evento_actual=function(){return a.evento_actual?a.evento_actual.idioma_principal_id?a.idiomaPreg={selected:a.evento_actual.idioma_principal_id}:void 0:g.warning("Pimero debes crear o seleccionar un evento actual")},a.comprobar_evento_actual(),a.$on("cambio_evento_user",function(){return a.comprobar_evento_actual(),a.traer_niveles(),a.traer_entidades(),a.traer_categorias()}),a.$on("cambia_evento_actual",function(){return a.comprobar_evento_actual()}),a.niveles_king=[],a.traer_niveles=function(){return c.all("niveles/niveles-usuario").getList().then(function(b){return a.niveles_king=b},function(a){return g.warning("No se trajeron las niveles","Problema"),console.log("No se trajo niveles ",a)})},a.traer_niveles(),a.entidades=[],a.traer_entidades=function(){return c.all("entidades").getList().then(function(b){return a.entidades=b},function(a){return g.warning("No se trajeron las entidades","Problema"),console.log("No se trajo entidades ",a)})},a.traer_entidades(),a.categorias_king1=[],a.categorias_king2=[],
a.traer_categorias=function(){return c.all("categorias/categorias-usuario").getList().then(function(b){return a.categorias_king1=b,angular.copy(a.categorias_king1,a.categorias_king2)},function(a){return g.warning("No se trajeron las categorias","Problema"),console.log("No se trajo categorias ",a)})},a.traer_categorias(),a.avatar={masculino:{abrev:"M",def:"Masculino",img:a.imagesPath+"system/avatars/male1.jpg"},femenino:{abrev:"F",def:"Femenino",img:a.imagesPath+"system/avatars/female1.jpg"}},a.guardando=!1,a.guardarNuevo=function(){return a.guardando=!0,c.one("usuarios/store").customPOST(a.newUsu).then(function(b){return g.success("Usuario guardado con éxito."),a.usuarios.push(b),a.guardando=!1,console.log("Usuario creado",b)},function(b){return g.warning("No se creó el usuario","Problema"),console.log("No se creó usuario ",b),a.guardando=!1})},a.guardando_edicion=!1,a.guardarEdicion=function(){return a.guardando_edicion=!0,c.one("usuarios/update").customPUT(a.currentUser).then(function(b){return g.success("Cambios guardados."),a.guardando_edicion=!1,console.log("Cambios guardados",b)},function(b){return g.warning("No se guardó cambios del usuario","Problema"),console.log("No se guardó cambios del usuario ",b),a.guardando_edicion=!1})},a.checkeandoCategorias=function(a,b){return b.indexOf(a)>-1},a.toggle=function(a,b){var c;return c=b.indexOf(a),c>-1?b.splice(c,1):b.push(a)},a.checkeandoCategoriasEdit=function(a,b){return b.indexOf(a)>-1},a.toggleEdit=function(a,b){var c;return c=b.indexOf(a),c>-1?b.splice(c,1):b.push(a)},a.cancelarNuevo=function(){return a.creando=!1},a.cancelarEdicion=function(){return a.editando=!1},a.cambiaInscripcion=function(a,b){var d,e;return d=b[0],a.cambiando=!0,e={usuario_id:d.id,categoria_id:a.categoria_id},a.selected?c.one("inscripciones/inscribir").customPUT(e).then(function(b){var c;return a.cambiando=!1,console.log("Inscripción creada",b),c=j("filter")(d.inscripciones,{categoria_id:e.categoria_id}),0===c.length?d.inscripciones.push(b[0]):(c[0].id=b[0].id,c[0].deleted_at=b[0].deleted_at)},function(b){return g.warning("No se inscribó el usuario","Problema"),console.log("No se inscribó el usuario ",b),a.cambiando=!1,a.selected=!1}):c.one("inscripciones/desinscribir").customPUT(e).then(function(b){return a.cambiando=!1,console.log("Inscripción creada",b),d.inscripciones=j("filter")(d.inscripciones,{categoria_id:"!"+e.categoria_id})},function(b){return g.warning("No se quitó inscripción","Problema"),console.log("No se quitó inscripción ",b),a.cambiando=!1,a.selected=!0})}}])}.call(this),function(){angular.module("WissenSystem").directive("gridUsuarios",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"usuarios/gridUsuariosDir.tpl.html",scope:{usuarios:"=",categoriasking:"=",currentusers:"=",nivelesking:"=",idioma:"="},link:function(a,b,c){},controller:"GridUsuariosCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("GridUsuariosCtrl",["$scope","$http","Restangular","$state","$cookies","$interval","toastr","uiGridConstants","$modal","$filter","App",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;a.currentusers=[],a.currentuser={},a.seleccionar_fila=function(b){return a.gridApi.selection.clearSelectedRows(),a.gridApi.selection.selectRow(b),a.currentuser=b},a.seleccionar_entidad=function(b){var c;return console.log("Presionado para cambiar entidad: ",b),c=i.open({templateUrl:k.views+"usuarios/cambiarEntidadUsuario.tpl.html",controller:"SelectEntidadCtrl",resolve:{usuario:function(){return b},entidades:function(){return a.$parent.entidades}}}),c.result.then(function(a){return b.entidad_id=a,console.log("Resultado del modal: ",a)})},a.editando=!1,a.editar=function(b){return a.gridApi.selection.clearSelectedRows(),a.gridApi.selection.selectRow(b),a.$parent.currentUser=b,a.currentusers=[b],a.$parent.editando=!0},a.eliminar=function(b){var c;return a.gridApi.selection.clearSelectedRows(),a.gridApi.selection.selectRow(b),c=i.open({templateUrl:k.views+"usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return b},entidades:function(){return a.$parent.entidades}}}),c.result.then(function(b){return a.usuarios=j("filter")(a.usuarios,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},a.verRoles=function(a){var b;return b=i.open({templateUrl:k.views+"usuarios/verRoles.tpl.html",controller:"VerRolesCtrl",resolve:{usuario:function(){return a},roles:function(){return c.all("roles").getList().then(function(a){return a},function(a){return g.warning("No pudo traer los roles","Problema"),console.log("No pudo traer los roles ",a)})}}}),b.result.then(function(a){return console.log("Resultado del modal: ",a)})},l='<a tooltip="Editar" tooltip-placement="left" class="btn btn-default btn-xs " ng-click="grid.appScope.editar(row.entity)"><i class="fa fa-edit "></i></a>',m='<a tooltip="X Eliminar" tooltip-placement="right" class="btn btn-xs btn-danger" ng-click="grid.appScope.eliminar(row.entity)"><i class="fa fa-trash "></i></a> ',n='<a tooltip="Seleccionar" tooltip-placement="right" class="btn btn-xs btn-info" ng-click="grid.appScope.seleccionar_fila(row.entity)"><i class="fa fa-check "></i></a>',o='<a tooltip="{{row.entity.entidad_id | nombreEntidad:grid.appScope.$parent.entidades:false}}" tooltip-placement="left" class="btn btn-xs shiny btn-info" ng-click="grid.appScope.seleccionar_entidad(row.entity)" ng-bind="row.entity.entidad_id | nombreEntidad:grid.appScope.$parent.entidades:true"></a>',p='<a tooltip="Modificar roles" tooltip-placement="left" class="btn btn-xs btn-info" ng-click="grid.appScope.verRoles(row.entity)"><span ng-repeat="rol in row.entity.roles">{{rol.display_name}}-</span></a>',a.gridOptions={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,selectedItems:a.currentusers,multiSelect:!0,enableRowSelection:!0,enableSelectAll:!0,columnDefs:[{field:"id",displayName:"Id",width:60,enableCellEdit:!1,enableColumnMenu:!1},{name:"edicion",displayName:"Edición",width:100,enableSorting:!1,enableFiltering:!1,cellTemplate:l+m+n,enableCellEdit:!1,enableColumnMenu:!1},{field:"nombres",filter:{condition:h.filter.CONTAINS},enableHiding:!1},{field:"apellidos",filter:{condition:h.filter.CONTAINS}},{field:"sexo",width:60},{field:"username",filter:{condition:h.filter.CONTAINS},displayName:"Usuario"},{field:"entidad_id",displayName:"Entidad",cellTemplate:o,enableCellEdit:!1,filter:{condition:function(b,c){var d,e,f,g;return d=a.$parent.entidades,g=b.toLowerCase(),e=j("nombreEntidad")(c,d,!0),e=e.toLowerCase(),f=j("nombreEntidad")(c,d),f=f.toLowerCase(),-1!==e.indexOf(g)||-1!==f.indexOf(g)}}},{field:"roles",displayName:"Roles",cellTemplate:p,enableCellEdit:!1}],onRegisterApi:function(b){return a.gridApi=b,b.selection.on.rowSelectionChanged(a,function(c){return a.currentusers=b.selection.getSelectedRows()}),b.selection.on.rowSelectionChangedBatch(a,function(c){return a.currentusers=b.selection.getSelectedRows()}),b.edit.on.afterCellEdit(a,function(b,d,e,f){return console.log("Fila editada, ",b," Column:",d," newValue:"+e+" oldValue:"+f),e!==f&&c.one("usuarios/update",b.id).customPUT(b).then(function(a){return g.success("Usuario actualizado con éxito","Actualizado")},function(a){return g.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}},c.all("usuarios").getList().then(function(b){return a.usuarios=b,a.gridOptions.data=a.usuarios}),a.cambiaInscripcion=function(a,b){var d,e,f,h;for(a.cambiando=!0,e={usuarios:[],categoria_id:a.categoria_id},f=0,h=b.length;h>f;f++)d=b[f],e.usuarios.push({user_id:d.id});return a.selected?c.one("inscripciones/inscribir-varios").customPUT(e).then(function(c){var e,f,g,h,i,k;for(g=0,i=b.length;i>g;g++)for(d=b[g],h=0,k=c.length;k>h;h++)f=c[h],f.user_id===d.id&&(e=j("filter")(d.inscripciones,{categoria_id:f.categoria_id}),0===e.length?d.inscripciones.push(f):(e[0].id=f.id,e[0].deleted_at=f.deleted_at));return a.cambiando=!1,console.log("Usuarios inscritos: ",b)},function(b){return g.warning("No se inscribó el usuario","Problema"),console.log("No se inscribó el usuario ",b),a.cambiando=!1,a.selected=!1}):c.one("inscripciones/desinscribir-varios").customPUT(e).then(function(c){var d,e,f,g;for(a.cambiando=!1,g=[],e=0,f=b.length;f>e;e++)d=b[e],g.push(d.inscripciones=j("filter")(d.inscripciones,{categoria_id:"!"+a.categoria_id}));return g},function(b){return g.warning("No se quitó inscripción","Problema"),console.log("No se quitó inscripción ",b),a.cambiando=!1,a.selected=!0})}}]).controller("RemoveUsuarioCtrl",["$scope","$modalInstance","usuario","entidades","Restangular","toastr",function(a,b,c,d,e,f){return a.usuario=c,a.entidades=d,console.log("elemento",c,d),a.ok=function(){return e.all("usuarios/destroy").customDELETE(c.id).then(function(a){return f.success("Usuario eliminado con éxito.","Eliminado"),b.close(c)},function(a){return f.warning("No se pudo eliminar al usuario.","Problema"),console.log("Error eliminando usuario: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}]).controller("SelectEntidadCtrl",["$scope","$modalInstance","usuario","entidades","Restangular","toastr","$filter",function(a,b,c,d,e,f,g){return a.usuario=c,a.entidades=d,a.entidades_extras=g("filter")(d,{id:"!"+c.entidad_id}),console.log("elementos",c,d),a.seleccionar=function(c){var d;return d={user_id:a.usuario.id,entidad_id:c.id},e.all("usuarios/cambiar-entidad").customPUT(d).then(function(a){return f.success("Entidad cambiada con éxito.",c.alias),b.close(c.id)},function(a){return f.warning("No se pudo cambiar entidad.","Problema"),console.log("Error cambiando elemento: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}]).controller("VerRolesCtrl",["$scope","$modalInstance","usuario","roles","Restangular","toastr",function(a,b,c,d,e,f){return a.usuario=c,a.roles=d,a.datos={selecteds:[]},a.datos.selecteds=c.roles,a.seleccionando=function(b,d){var g;return g={user_id:c.id,role_id:b.id},console.log(a.datos.selecteds,b),e.one("roles/add-role-to-user").customPUT(g).then(function(a){return f.success("Rol agregado con éxito.")},function(a){return f.warning("No se pudo agregar el rol al usuario.","Problema"),console.log("No se pudo agregar el rol al usuario.: ",a)})},a.quitando=function(a,b){return console.log(a,b),e.one("roles/remove-role-to-user").customPUT({role_id:a.id,user_id:c.id}).then(function(a){return f.success("Rol quitado con éxito.")},function(a){return f.warning("No se pudo quitar el rol al usuario.","Problema"),console.log("No se pudo quitar el rol al usuario.: ",a)})},a.ok=function(){return c.roles=a.datos.selecteds,b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").config(["App","$stateProvider","$translateProvider",function(a,b,c){return b.state("panel.categorias",{url:"^/categorias",views:{contenido_panel:{templateUrl:""+a.views+"categorias/categorias.tpl.html",controller:"CategoriasCtrl"}},data:{pageTitle:"Categorias"}}),c.translations("EN",{CATEGORIAS_TITLE:"Categs",NIVELES_TITLE:"Levels",DISCIPLINA_TITLE:"Disciplines"}).translations("ES",{CATEGORIAS_TITLE:"Categorias",NIVELES_TITLE:"Niveles",DISCIPLINA_TITLE:"Disciplinas"})}])}.call(this),function(){angular.module("WissenSystem").controller("CategoriasCtrl",["$scope","Restangular","toastr",function(a,b,c){return a.comprobar_evento_actual=function(){return a.evento_actual?a.evento_actual.idioma_principal_id?a.idiomaPreg={selected:a.evento_actual.idioma_principal_id}:void 0:c.warning("Pimero debes crear o seleccionar un evento actual")},a.categorias_king=[],a.niveles_king=[],a.disciplinas_king=[],a.comprobar_evento_actual(),a.$on("cambio_evento_user",function(){return a.comprobar_evento_actual()}),a.$on("cambia_evento_actual",function(){return a.comprobar_evento_actual()})}])}.call(this),function(){angular.module("WissenSystem").controller("CategoriasDirCtrl",["$scope","Restangular","toastr","$modal","App","$filter",function(a,b,c,d,e,f){return a.creando=!1,a.traer_categorias=function(){return b.all("categorias/categorias-usuario").getList().then(function(b){return a.categoriasking=b},function(a){return c.warning("No se trajeron las categorias","Problema"),console.log("No se trajo categorias ",a)})},a.traer_categorias(),a.$on("cambio_evento_user",function(){return a.traer_categorias()}),a.crear_categoria=function(){return a.creando=!0,b.one("categorias/store").customPOST().then(function(b){return b.editando=!0,a.categoriasking.push(b),a.creando=!1,console.log("Categorias creada",b)},function(b){return c.warning("No se creó la categoria","Problema"),console.log("No se creó categoria ",b),a.creando=!1})},a.cerrar_edicion=function(a){return a.editando=!1},a.editarCategoria=function(a){return a.editando=!0},a.eliminarCategoria=function(b){var c;return c=d.open({templateUrl:e.views+"categorias/removeCategoria.tpl.html",controller:"RemoveCategoriaCtrl",resolve:{elemento:function(){return b}}}),c.result.then(function(b){return a.categoriasking=f("filter")(a.categoriasking,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},a.finalizar_edicion=function(b){return a.guardando(b),b.editando=!1},a.guardando=function(a){return b.all("categorias/guardar").customPUT(a).then(function(a){return c.success("Categoria guardada."),console.log("Categoria guardada: ",a)},function(a){return c.warning("No se pudo guardar la categoria","Problema"),console.log("No se pudo guardar la categoria ",a)})}}]).controller("RemoveCategoriaCtrl",["$scope","$modalInstance","elemento","Restangular","toastr",function(a,b,c,d,e){return a.elemento=c,console.log("elemento",c),a.ok=function(){return d.all("categorias/destroy").customDELETE(c.id).then(function(a){return e.success("Categoria eliminada con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("categoriasDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"categorias/categoriasDir.tpl.html",scope:{idiomapreg:"=",eventoactual:"=",categoriasking:"=",nivelesking:"=",disciplinasking:"="},link:function(a,b,c){},controller:"CategoriasDirCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("DisciplinasCtrl",["$scope","Restangular","toastr","$modal","App","$filter",function(a,b,c,d,e,f){return a.creando=!1,a.traer_disciplinas=function(){return b.all("disciplinas/disciplinas-usuario").getList().then(function(b){return a.disciplinasking=b},function(a){return c.warning("No se trajeron las disciplinas","Problema"),console.log("No se trajo disciplinas ",a)})},a.traer_disciplinas(),a.$on("cambio_evento_user",function(){return a.traer_disciplinas()}),a.crear_disciplina=function(){return a.creando=!0,b.one("disciplinas/store").customPOST().then(function(b){return b.editando=!0,a.disciplinasking.push(b),a.creando=!1,console.log("Disciplina creada",b)},function(b){return c.warning("No se creó la disciplina","Problema"),console.log("No se creó disciplina ",b),a.creando=!1})},a.cerrar_edicion=function(a){return a.editando=!1},a.editarDisciplina=function(a){return a.editando=!0},a.eliminarDisciplina=function(b){var c;return c=d.open({templateUrl:e.views+"categorias/removeDisciplina.tpl.html",controller:"RemoveDisciplinaCtrl",resolve:{elemento:function(){return b}}}),c.result.then(function(b){return a.disciplinasking=f("filter")(a.disciplinasking,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},a.finalizar_edicion=function(b){return a.guardando(b),b.editando=!1},a.guardando=function(a){return b.all("disciplinas/guardar").customPUT(a).then(function(a){return c.success("Disciplina guardada."),console.log("Disciplina guardada: ",a)},function(a){return c.warning("No se pudo guardar la disciplina","Problema"),console.log("No se pudo guardar la disciplina ",a)})}}]).controller("RemoveDisciplinaCtrl",["$scope","$modalInstance","elemento","Restangular","toastr",function(a,b,c,d,e){return a.elemento=c,console.log("elemento",c),a.ok=function(){return d.all("disciplinas/destroy").customDELETE(c.id).then(function(a){return e.success("Disciplina eliminada con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("disciplinasDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"categorias/disciplinasDir.tpl.html",scope:{idiomapreg:"=",eventoactual:"=",disciplinasking:"="},link:function(a,b,c){},controller:"DisciplinasCtrl"}}])}.call(this),function(){angular.module("WissenSystem").controller("NivelesCtrl",["$scope","Restangular","toastr","$modal","App","$filter",function(a,b,c,d,e,f){return a.creando=!1,a.traer_niveles=function(){return b.all("niveles/niveles-usuario").getList().then(function(b){return a.nivelesking=b},function(a){return c.warning("No se trajeron las niveles","Problema"),console.log("No se trajo niveles ",a)})},a.traer_niveles(),a.$on("cambio_evento_user",function(){return a.traer_niveles()}),a.crear_nivel=function(){return a.creando=!0,b.one("niveles/store").customPOST().then(function(b){return b.editando=!0,a.nivelesking.push(b),a.creando=!1,console.log("Nivel creada",b)},function(b){return c.warning("No se creó el nivel","Problema"),console.log("No se creó nivel ",b),a.creando=!1})},a.cerrar_edicion=function(a){return a.editando=!1},a.editarNivel=function(a){return a.editando=!0},a.eliminarNivel=function(b){var c;return c=d.open({templateUrl:e.views+"categorias/removeNivel.tpl.html",controller:"RemoveNivelCtrl",resolve:{elemento:function(){return b}}}),c.result.then(function(b){return a.nivelesking=f("filter")(a.nivelesking,{id:"!"+b.id}),console.log("Resultado del modal: ",b)})},a.finalizar_edicion=function(b){return a.guardando(b),b.editando=!1},a.guardando=function(a){return b.all("niveles/guardar").customPUT(a).then(function(a){return c.success("Nivel guardada."),console.log("Nivel guardada: ",a)},function(a){return c.warning("No se pudo guardar el nivel","Problema"),console.log("No se pudo guardar el nivel ",a)})}}]).controller("RemoveNivelCtrl",["$scope","$modalInstance","elemento","Restangular","toastr",function(a,b,c,d,e){return a.elemento=c,console.log("elemento",c),a.ok=function(){return d.all("niveles/destroy").customDELETE(c.id).then(function(a){return e.success("Nivel eliminado con éxito.","Eliminado"),b.close(c)},function(a){return e.warning("No se pudo eliminar al elemento.","Problema"),console.log("Error eliminando elemento: ",a),b.dismiss("Error")})},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("WissenSystem").directive("nivelesDir",["App",function(a){return{restrict:"E",templateUrl:""+a.views+"categorias/nivelesDir.tpl.html",scope:{idiomapreg:"=",eventoactual:"=",nivelesking:"="},link:function(a,b,c){},controller:"NivelesCtrl"}}])}.call(this),function(){angular.module("WissenSystem").factory("AuthService",["Restangular","$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter","toastr",function(a,b,c,d,e,f,g,h,i,j){var k;return k={},k.verificando=!1,k.promesa_de_verificacion={},k.verificar=function(){var a;return k.verificando?k.promesa_de_verificacion:(a=h.defer(),e.User().id?a.resolve(e.User()):d.get("xtoken")?void 0!==d.get("xtoken")&&"undefined"!==d.get("xtoken")&&"[object Object]"!==d.get("xtoken")?k.login_from_token().then(function(b){return e.setUser(b),a.resolve(b)},function(b){return console.log("No se logueó from token"),a.reject(b)}):(console.log("Token mal estructurado: ",d.get("xtoken")),k.borrarToken(),f.$broadcast(g.notAuthenticated),a.reject("Token mal estructurado.")):(console.log("No hay cookie token."),a.reject("No hay cookie token."),b.go("login"),f.$broadcast(g.notAuthenticated)),k.promesa_de_verificacion=a.promise,k.promesa_de_verificacion)},k.verificar_acceso=function(){var a,c;return e.User().id||b.go("login"),c=b.current,c.data.needed_permissions?(a=c.data.needed_permissions,k.isAuthorized(a)?void 0:(console.log("No tiene permisos, y... "),f.lastState=c.name,k.isAuthenticated()?(f.$broadcast(g.notAuthorized),console.log("...está Autenticado.")):(console.log("...NO está Autenticado."),b.transitionTo("login")))):!0},k.login_credentials=function(i){var l;return l=h.defer(),k.borrarToken(),a.one("login/login").customPOST(i).then(function(a){return a.token?(d.put("xtoken",a.token),c.defaults.headers.common.Authorization="Bearer "+d.get("xtoken"),e.setUser(a),f.$broadcast(g.loginSuccess),l.resolve(a)):(console.log("No se trajo un token en el login.",a),f.$broadcast(g.loginFailed),l.reject("Error en login"))},function(a){return console.log("No se pudo loguear. ",a,b),a.data&&a.data.error&&("Token expirado"===a.data.error||"token_expired"===a.error?(j.warning("La sesión ha expirado"),"login"!==b.current.name&&b.go("login")):f.$broadcast(g.loginFailed)),l.reject("Error en login")}),l.promise},k.login_from_token=function(){var b,i;return b=h.defer(),e.User().id||void 0===e.User().id?(c.defaults.headers.common.Authorization="Bearer "+d.get("xtoken"),i=a.one("login/verificar").post().then(function(a){return f.$broadcast(g.loginSuccess),b.resolve(a)},function(a){return console.log("No se pudo loguear con token. ",a),b.reject("Error en login con token."),f.$broadcast(g.loginFailed)})):b.resolve(e.User()),b.promise},k.logout=function(a){return f.lastState=null,f.lastStateParam=null,k.borrarToken(),e.deleteUser(),b.transitionTo("login")},k.borrarToken=function(){return d.remove("xtoken"),delete c.defaults.headers.common.Authorization},k.isAuthenticated=function(){return!!e.User().id},k.isAuthorized=function(a){var b,c;return c=e.User(),c.is_superuser?!0:(angular.isArray(a)||(a=[a]),angular.isArray(c.perms)?(b=[],_.each(a,function(a){return-1!==c.perms.indexOf(a)?b.push(a):void 0}),k.isAuthenticated()&&b.length>0):a.length>0?!1:!0)},k.hasRoleOrPerm=function(a,b){var c;if(!angular.isArray(a)){if(!a)return!1;a=[a]}return c=[],_.each(a,function(a){var b;return b=[],b=i("filter")(e.User().roles,{name:a}),b&&b.length>0?c.push(a):void 0}),c.length>0},k}])}.call(this),function(){angular.module("WissenSystem").factory("Perfil",["Restangular","App","$q","$cookies","$rootScope","AUTH_EVENTS","$http",function(a,b,c,d,e,f,g){var h;return h={},{setUser:function(a){return h=a},User:function(){return h},id:function(){return h.user_id},idioma:function(){return h.idioma_main_id},setImagen:function(a,b){return h.imagen_id=a,h.imagen_nombre=b},deleteUser:function(){return h={}}}}])}.call(this),function(){angular.module("WissenSystem").factory("preguntasServ",["Restangular","App","$q","$cookies","$rootScope","AUTH_EVENTS","$http",function(a,b,c,d,e,f,g){var h,i,j,k;return j=[],i=!1,h=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,k=[],{setUser:function(a){var b;return b=a},getPreguntas:function(){var b;return b=c.defer(),i===!1?(k=h.open("wissenDB",2),k.onupgradeneeded=function(){var a,b;return a=k.result,b=a.createObjectStore("preguntas_king",{keyPath:"id",autoIncrement:!0}),b.put({descripcion:"Una pregunta para traducir",tipo_pregunta:"Test",duracion:20,categoria_id:1,added_by:1,preguntas_traducidas:[{id:1,enunciado:"<p>¿Cuánto es <b>dos</b> más dos?</p>",ayuda:"Este es un texto de ayuda",pregunta_id:4,idioma_id:1,idioma:"Español",puntos:5,added_by:1,opciones:[{id:1,definicion:"Primera opción, y necesito meter mucho texto para ver que tal se verá al ingresar más cosas.",is_correct:!1},{id:2,definicion:"Segunda opción",is_correct:!0},{id:3,definicion:"Tercera opción",is_correct:!1}]},{id:2,enunciado:"How much is 2+2?",ayuda:"",pregunta_id:4,idioma_id:2,idioma:"English",puntos:5,added_by:1,opciones:[{id:4,definicion:"Fist option",is_correct:!1},{id:5,definicion:"Second option",is_correct:!0},{id:6,definicion:"Third option",is_correct:!1}]}]},{descripcion:"Otra pregunta",tipo_pregunta:"Test",duracion:20,categoria_id:1,added_by:1,preguntas_traducidas:[{id:1,enunciado:"<p>¿Quién es más rápido?</p>",ayuda:"Debes pensar en tu familia",pregunta_id:5,idioma_id:1,idioma:"Español",puntos:5,added_by:1,opciones:[{id:7,definicion:"Mi mamá.",is_correct:!1},{id:8,definicion:"Mi papá",is_correct:!0},{id:9,definicion:"Mi hermano",is_correct:!1},{id:10,definicion:"Yo",is_correct:!1}]},{id:2,enunciado:"Who is the faster one in the family?",ayuda:"You have to think in your family",pregunta_id:5,idioma_id:2,idioma:"English",puntos:5,added_by:1,opciones:[{id:11,definicion:"My mother",is_correct:!1},{id:12,definicion:"My father",is_correct:!0},{id:13,definicion:"My brother",is_correct:!1},{id:14,definicion:"Me",is_correct:!1}]}]})},k.onsuccess=function(){var a,c,d;return a=k.result,d=a.transaction(["preguntas_king"],"readwrite"),c=d.objectStore("preguntas_king"),k=c.get(1),k.onerror=function(a){return console.log("Error")},k.onsuccess=function(a){return console.log("Powerrr",k.result),b.resolve([k.result])}}):(a.all("preguntas_king",{dato:"ujno",mas:"otro"}).getList().then(function(a){return console.log("Este es el pedido de preguntas",a),b.resolve(a)},function(a){return console.log("Falló pedido de preguntas",a),b.reject(a)}),j=[{id:5,descripcion:"Otra pregunta",tipo_pregunta:"Test",duracion:20,categoria_id:1,added_by:1,preguntas_traducidas:[{id:1,enunciado:"<p>¿Quién es más rápido?</p>",ayuda:"Debes pensar en tu familia",pregunta_id:5,idioma_id:1,idioma:"Español",puntos:5,added_by:1,opciones:[{id:7,definicion:"Mi mamá.",is_correct:!1},{id:8,definicion:"Mi papá",is_correct:!0},{id:9,definicion:"Mi hermano",is_correct:!1},{id:10,definicion:"Yo",is_correct:!1}]},{id:2,enunciado:"Who is the faster one in the family?",ayuda:"You have to think in your family",pregunta_id:5,idioma_id:2,idioma:"English",puntos:5,added_by:1,opciones:[{id:11,definicion:"My mother",is_correct:!1},{id:12,definicion:"My father",is_correct:!0},{id:13,definicion:"My brother",is_correct:!1},{id:14,definicion:"Me",is_correct:!1}]}]}],b.resolve(j)),b.promise},savePregunta:function(a){var b;return b=c.defer(),k=h.open("wissenDB",2),k.onsuccess=function(){var b,c,d;return b=k.result,d=b.transaction(["preguntas_king"],"readwrite"),c=d.objectStore("preguntas_king"),console.log("objectStore",c),c.put(a)},b.promise}}}])}.call(this),function(){angular.module("WissenSystem").filter("porIdioma",[function(){return function(a,b){var c,d,e,f,g;if(a){for(e=[],b=parseFloat(b),f=0,g=a.length;g>f;f++)c=a[f],d=parseFloat(c.idioma_id),b===d&&e.push(c);return e}return!1}}]).filter("idiomas_del_sistema",[function(){return function(a,b){var c,d,e,f;if(a){for(d=[],e=0,f=a.length;f>e;e++)c=a[e],b?c.used_by_system||d.push(c):c.used_by_system&&d.push(c);return d}return!1}}]).filter("porIdiomasEdit",[function(){return function(a,b){var c,d,e,f,g,h,i,j;if(a&&a[0].uncodigo_id&&console.log(a,b),f=[],b&&a)for(g=0,i=b.length;i>g;g++)for(d=b[g],d=parseFloat(d),h=0,j=a.length;j>h;h++)c=a[h],e=parseFloat(c.idioma_id),d===e&&f.push(c);return f}}]).filter("catsByIdioma",[function(){return function(a,b){var c,d,e,f;for(d=[],e=0,f=a.length;f>e;e++)c=a[e],c.idioma_id===parseFloat(b)&&d.push(c);return d}}])}.call(this),function(){angular.module("WissenSystem").filter("categsInscritas",["$filter",function(a){return function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(b&&c){if(i=[],0===b.length||void 0===b.length)return[];if(1===b.length)for(j=b[0],k=0,n=c.length;n>k;k++)g=c[k],f=a("porIdioma")(g.categorias_traducidas,d),f.length>0&&(f=f[0]),f.algunos=!1,f.nivel_id=g.nivel_id,h=a("filter")(j.inscripciones,{categoria_id:g.id}),h.length>0?(f.incripcion_id=h.id,f.selected=!0):(f.incripcion_id=void 0,f.selected=!1),i.push(f);else if(b.length>1)for(l=0,o=c.length;o>l;l++){for(g=c[l],f=a("porIdioma")(g.categorias_traducidas,d),f.length>0&&(f=f[0]),f.nivel_id=g.nivel_id,f.incripcion_id=void 0,e=0,m=0,p=b.length;p>m;m++)j=b[m],h=a("filter")(j.inscripciones,{categoria_id:g.id}),h.length>0&&e++;0===e?(f.selected=!1,f.algunos=!1):e===b.length?(f.selected=!0,f.algunos=!1):(f.selected=!1,f.algunos=!0),i.push(f)}return i}return[]}}]).filter("categsInscritasDeUsuario",["$filter",function(a){return function(b,c,d){var e,f,g,h,i,j;if(b&&c){for(h=[],i=0,j=c.length;j>i;i++)f=c[i],e=a("porIdioma")(f.categorias_traducidas,parseFloat(d)),e.length>0&&(e=e[0],g=a("filter")(b.inscripciones,{categoria_id:f.id}),g.length>0&&(g=g[0],e.allowed_to_answer=g.allowed_to_answer,e.examenes=g.examenes,e.inscripcion_id=g.id,h.push(e)));return h}return[]}}])}.call(this),function(){angular.module("WissenSystem").filter("nombreEntidad",["$filter",function(a){return function(b,c,d){var e;return b&&c?(b=parseFloat(b),e=a("filter")(c,{id:b}),e.length>0?d?e[0].alias:e[0].nombre:b):b}}]).filter("nivelesTraducidos",["$filter",function(a){return function(b,c){var d,e,f,g,h;if(b&&c){for(c=parseFloat(c),f=[],g=0,h=b.length;h>g;g++)e=b[g],d=a("porIdioma")(e.niveles_traducidos,c),d.length>0&&(d[0].nivel_king_id=e.id,f.push(d[0]));return f}return b}}]).filter("categoriasTraducidas",["$filter",function(a){return function(b,c,d){var e,f,g,h,i;if(b&&c){for(c=parseFloat(c),g=[],h=0,i=b.length;i>h;h++)e=b[h],d?(d=parseFloat(d),e.nivel_id===d&&(f=a("porIdioma")(e.categorias_traducidas,c),f.length>0&&(f[0].categoria_king_id=e.id,g.push(f[0])))):(f=a("porIdioma")(e.categorias_traducidas,c),f.length>0&&g.push(f[0]));return g}return b}}]).filter("nombreCategoria",["$filter",function(a){return function(b,c,d,e){var f,g;return b=parseFloat(b),d=parseFloat(d),f=a("filter")(c,{id:b}),f.length>0?(f=f[0],g=a("porIdioma")(f.categorias_traducidas,d),g.length>0?(g=g[0],e?g.abrev:g.nombre):""):""}}])}.call(this),function(){angular.module("WissenSystem").filter("cantPregsEvaluacion",["$filter","Perfil",function(a,b){return function(c){var d,e,f,g,h;if(c){for(d=0,g=0,h=c.length;h>g;g++)f=c[g],f.tipo_pregunta?d++:(e=a("porIdioma")(f.contenidos_traducidos,b.idioma()),e.length>0&&(d+=e[0].preguntas_agrupadas.length));return d}return!1}}]).filter("noPregActual",["$filter","Perfil",function(a,b){return function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(c){for(d=0,l=0,p=c.length;p>l;l++)if(j=c[l],d++,j.tipo_pregunta){for(i=a("porIdioma")(j.preguntas_traducidas,b.idioma()),k=!1,m=0,q=i.length;q>m;m++)for(g=i[m],x=g.opciones,n=0,r=x.length;r>n;n++)e=x[n],e.respondida&&(k=!0);if(!k)return d}else for(h=a("porIdioma")(j.contenidos_traducidos,b.idioma()),o=0,s=h.length;s>o;o++)for(f=h[o],d++,y=f.preguntas_agrupadas,v=0,t=y.length;t>v;v++){for(g=y[v],k=!1,z=g.opciones,w=0,u=z.length;u>w;w++)e=z[w],e.respondida&&(k=!0);if(!k)return d}return d}return!1}}]).filter("preguntaActual",["$filter","Perfil",function(a,b){return function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(c){for(m=0,q=c.length;q>m;m++)if(j=c[m],j.tipo_pregunta){for(i=a("porIdioma")(j.preguntas_traducidas,b.idioma()),l=!1,n=0,r=i.length;r>n;n++)for(g=i[n],y=g.opciones,o=0,s=y.length;s>o;o++)e=y[o],e.respondida&&(l=!0);if(!l)return[j]}else for(h=a("porIdioma")(j.contenidos_traducidos,b.idioma()),p=0,t=h.length;t>p;p++)for(f=h[p],z=f.preguntas_agrupadas,w=0,u=z.length;u>w;w++){for(g=z[w],l=!1,A=g.opciones,x=0,v=A.length;v>x;x++)e=A[x],e.respondida&&(l=!0);if(!l)return[j]}return k=c[0],k.terminado=!0,k=[k]}return!1}}])}.call(this),function(){angular.module("WissenSystem").directive("updateTitle",["$rootScope","$timeout",function(a,b){return{link:function(c,d){var e;return e=function(a,c,e){var f;return f="MyVc",c.data&&c.data.pageTitle&&(f=c.data.pageTitle),e&&e.username&&(f=e.username+" - MyVc"),b(function(){return d.text(f)},0,!1)},a.$on("$stateChangeSuccess",e)}}}])}.call(this);